{"meta":{"version":1,"warehouse":"5.0.1"},"models":{"Asset":[{"_id":"themes/butterfly/source/css/index.styl","path":"css/index.styl","modified":0,"renderable":1},{"_id":"themes/butterfly/source/css/var.styl","path":"css/var.styl","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/404.jpg","path":"img/404.jpg","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/error-page.png","path":"img/error-page.png","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/favicon.ico","path":"img/favicon.ico","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/friend_404.gif","path":"img/friend_404.gif","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/main.js","path":"js/main.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/tw_cn.js","path":"js/tw_cn.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/img/butterfly-icon.png","path":"img/butterfly-icon.png","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/utils.js","path":"js/utils.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/search/algolia.js","path":"js/search/algolia.js","modified":0,"renderable":1},{"_id":"themes/butterfly/source/js/search/local-search.js","path":"js/search/local-search.js","modified":0,"renderable":1}],"Cache":[{"_id":"source/_posts/贝塞尔曲线.md","hash":"67156a30afea17ae3dc0dc17a9966e75c7f53213","modified":1762852749177},{"_id":"source/categories/index.md","hash":"f689c571f6eaacbb75579fecca01207a46f40e07","modified":1762852749226},{"_id":"source/_posts/贝塞尔曲线/b-curve-1-17103234093711.jpg","hash":"5db45066a765f531d199ea21a98e3e86569d29bd","modified":1762852749184},{"_id":"source/_posts/贝塞尔曲线/b-close-1.jpg","hash":"5d5d2175cfb198dea08ca600a97f32bf7a19207b","modified":1762852749181},{"_id":"source/_posts/贝塞尔曲线/b-curve-1-17103242022572.jpg","hash":"5db45066a765f531d199ea21a98e3e86569d29bd","modified":1762852749185},{"_id":"source/_posts/贝塞尔曲线/b-curve-3.jpg","hash":"8b80a71f71926fc2101372af06e8294cb9de0030","modified":1762852749187},{"_id":"source/_posts/贝塞尔曲线/b-curve-2-17091716014474-17103791115213.jpg","hash":"f9fb487b5d3aae5c7f71c658b15aa3fd5283f757","modified":1762852749186},{"_id":"source/_posts/贝塞尔曲线/b-curve-4.jpg","hash":"4ff804f167091f37c22dc95dfebec048613437eb","modified":1762852749187},{"_id":"source/_posts/贝塞尔曲线/b-elev-06.jpg","hash":"9afa7672a40ff4eac4348df4bbe7ed9d760cf38b","modified":1762852749188},{"_id":"source/_posts/贝塞尔曲线/b-elev-07.jpg","hash":"d43e943ce5cf42e947e781405a8e90704b86aa48","modified":1762852749189},{"_id":"source/_posts/贝塞尔曲线/b-elev-08.jpg","hash":"89677bdcdd8606a79644103759d6ad026b8e972a","modified":1762852749190},{"_id":"source/_posts/贝塞尔曲线/b-elev-29.jpg","hash":"0d41088491e0a6f51854816192045647b663064b","modified":1762852749193},{"_id":"source/_posts/贝塞尔曲线/b-elev-15.jpg","hash":"ce6781e14988d582fbeb0a642a13ed090017919a","modified":1762852749192},{"_id":"source/_posts/贝塞尔曲线/b-curve-1-17098603594523.jpg","hash":"5db45066a765f531d199ea21a98e3e86569d29bd","modified":1762852749182},{"_id":"source/_posts/贝塞尔曲线/b-high-der-diagram.jpg","hash":"fe90034e41a2bd2866fb11a799a64f72f10c23b6","modified":1762852749194},{"_id":"source/_posts/贝塞尔曲线/b-elev-10.jpg","hash":"1547c0c1eab97040919f746db221fedcc803189c","modified":1762852749191},{"_id":"source/_posts/贝塞尔曲线/b-hodo-3.jpg","hash":"c6a1f125b37c639a64f1186d8a43af9e3d93f379","modified":1762852749195},{"_id":"source/_posts/贝塞尔曲线/b-join-1.jpg","hash":"069b4c654a0a735840568d6de566504ab04ec669","modified":1762852749196},{"_id":"source/_posts/贝塞尔曲线/b-join-2.jpg","hash":"c89d45e05be2b7e07099afa39e82c2bba8a93367","modified":1762852749196},{"_id":"source/_posts/贝塞尔曲线/b-pou-1-17091716014476.jpg","hash":"47a5df20b7e0c8e34f362627fbc256c48aabcddf","modified":1762852749197},{"_id":"source/_posts/贝塞尔曲线/b-sub-chart.jpg","hash":"274700bb099261c67e0c81e0285bd23dea22fb47","modified":1762852749200},{"_id":"source/_posts/贝塞尔曲线/b-sub-left.jpg","hash":"048bc8617c38d2227a80cc9a6df80b3a834d1089","modified":1762852749201},{"_id":"source/_posts/贝塞尔曲线/b-sub-master.jpg","hash":"28090a6dbe734c504c0a4bccf908bd32925ffeeb","modified":1762852749202},{"_id":"source/_posts/贝塞尔曲线/b-sub-result.jpg","hash":"5531ebc5a3baac1bd51d2c284625671fd9b4ede8","modified":1762852749202},{"_id":"source/_posts/贝塞尔曲线/b-sub-right.jpg","hash":"34d9fa55dc492d627a059d310e55058ead83b411","modified":1762852749203},{"_id":"source/_posts/贝塞尔曲线/b-tangent.jpg","hash":"2309715ec2e4534fbb922a1ddf3083e4393b5f09","modified":1762852749205},{"_id":"source/_posts/贝塞尔曲线/b-variation-17103792438184.jpg","hash":"3f28070e3e42dac724e8162fde06727a8bf633e0","modified":1762852749206},{"_id":"source/_posts/贝塞尔曲线/bezier-P+v.jpg","hash":"5ec1fd0a8dd71109a617671d96507ce63ae1c44a","modified":1762852749207},{"_id":"source/_posts/贝塞尔曲线/b-tangent-curve.jpg","hash":"3f7ffe6358360890b640190b6b6609216373cfa5","modified":1762852749204},{"_id":"source/_posts/贝塞尔曲线/bezier-cut-corner.jpg","hash":"5aae98dfa78302b04d6da0f637165b743e9e7eb2","modified":1762852749207},{"_id":"source/_posts/贝塞尔曲线/bezier-move-ct-pt-1.jpg","hash":"baedbf85ef1588d8675e959d78424542364bef5c","modified":1762852749208},{"_id":"source/_posts/贝塞尔曲线/de-cast-compute.jpg","hash":"bf312fe4ed78be61b65b2de268e526157f0b1bd9","modified":1762852749209},{"_id":"source/_posts/贝塞尔曲线/de-cast-rec-comp.jpg","hash":"a876ce0165b3697863a1e2fc4e6eba57ab23a335","modified":1762852749211},{"_id":"source/_posts/贝塞尔曲线/de-casteljau.jpg","hash":"a37b62fd583707d087df0edf0b33aa12c9ee3041","modified":1762852749212},{"_id":"source/_posts/贝塞尔曲线/image-20230715134543049.png","hash":"1a21e645023194b2255d13843524e41c2c39fbef","modified":1762852749219},{"_id":"source/_posts/贝塞尔曲线/image-20230715134555599.png","hash":"c50aeb5ed1cba50a98bc841bdcd85c94196b2a03","modified":1762852749220},{"_id":"source/_posts/贝塞尔曲线/image-20230715134508818.png","hash":"87775511a5ddea6801e84ad463f92413ad9e2a28","modified":1762852749218},{"_id":"source/_posts/贝塞尔曲线/image-20230715142627416.png","hash":"7d848d37d7f55ff34aadf41427d1779ea1fe91f5","modified":1762852749224},{"_id":"source/_posts/贝塞尔曲线/image-20230715142535462.png","hash":"f56cd4ee431b87b15ece7be6e8b9121100fbc33d","modified":1762852749223},{"_id":"source/_posts/贝塞尔曲线/point-c.jpg","hash":"5f681c5d5b26ec2771d9f61133e1ceb9f0089db3","modified":1762852749225},{"_id":"source/_posts/贝塞尔曲线/join-rel.jpg","hash":"6e2bd00f4ab3753cfeb0b54a3944b3152c4f0193","modified":1762852749224},{"_id":"source/_posts/贝塞尔曲线/v2-770487eacf3b9d5973e2783b6d8698e5_r.jpg","hash":"71974202fc66cf5b9dfdd855094f586f1c82b59a","modified":1762852749226},{"_id":"source/_posts/贝塞尔曲线/de-cast-observation-crop.jpg","hash":"158270e6788fc6eb24009225a6ec37c70a833cd6","modified":1762852749210},{"_id":"source/_posts/贝塞尔曲线/image-20230715134422584.png","hash":"90e9a20767e9267bd52b37c1c5e6b9ec77662ac0","modified":1762852749216},{"_id":"source/_posts/贝塞尔曲线/image-20230715135427376.png","hash":"d86e3b992c5eb9cd27cf80700cf0454600ee16e6","modified":1762852749222},{"_id":"source/_posts/贝塞尔曲线/Bézier_2_big.gif","hash":"b0f55381880464de10250ad92b5cabd64a74bd14","modified":1762852749178},{"_id":"source/_posts/贝塞尔曲线/image-20230715134335693.png","hash":"fd53460f66b68d013f5f2d53c60841cee1ffa96e","modified":1762852749214},{"_id":"source/_posts/贝塞尔曲线/Bézier_3_big-168860760518218.gif","hash":"6982d3fb2de095a23884a28e1a33451d52909299","modified":1762852749180},{"_id":"themes/butterfly/.gitignore","hash":"1e843a7254515d97ddb1d1d32ae83ebfae937f54","modified":1762852749232},{"_id":"themes/butterfly/LICENSE","hash":"c8bc7df08db9dd3b39c2c2259a163a36cf2f6808","modified":1762852749232},{"_id":"themes/butterfly/plugins.yml","hash":"3dec580c9198ca28bc931d2d627abfb19ac070db","modified":1762852749309},{"_id":"themes/butterfly/_config.yml","hash":"5ffd7f95a5c3ad4f300647909121013bf0fe88d0","modified":1762852749235},{"_id":"themes/butterfly/README.md","hash":"4ff8ff47a38674ac55270b844171d7a0a6b52afd","modified":1762852749233},{"_id":"themes/butterfly/package.json","hash":"75c968e9986f4572c4eb36d299b8e33121709cf8","modified":1762852749309},{"_id":"themes/butterfly/README_CN.md","hash":"5595df16d0b28133a232cb5f45bbcf60798073e9","modified":1762852749234},{"_id":"themes/butterfly/.github/FUNDING.yml","hash":"859c2448942ab4fcf4a2fbdeff52dac8e68a9e96","modified":1762852749227},{"_id":"themes/butterfly/languages/default.yml","hash":"97e89708bea9740e7e156b53304d7f4697f6332d","modified":1762852749236},{"_id":"themes/butterfly/languages/zh-CN.yml","hash":"25e717994a3eab37ccb9cf3ae5fec5647b525ced","modified":1762852749238},{"_id":"themes/butterfly/languages/zh-HK.yml","hash":"e2958e5b72fd2cb33b6706bc1588de6b8d9dde8f","modified":1762852749239},{"_id":"themes/butterfly/languages/en.yml","hash":"6d2a5795862abc121a164e8519e7587bb57af7c7","modified":1762852749237},{"_id":"themes/butterfly/languages/ko.yml","hash":"4a959730509b211484b20d9fcabc80a9c7e8cc1f","modified":1762852749238},{"_id":"themes/butterfly/languages/ja.yml","hash":"d97b97ebb8a1c8754373b450d4e81341b5dcd208","modified":1762852749237},{"_id":"themes/butterfly/languages/zh-TW.yml","hash":"af38319aa58cab193f90ef8caecdb9a26cdd165a","modified":1762852749240},{"_id":"themes/butterfly/layout/category.pug","hash":"a7e9805a781e34e38d27462e6ce2a5821c34bb9f","modified":1762852749241},{"_id":"themes/butterfly/layout/post.pug","hash":"65c4a49c65c3fc4d9dc88b9791a75710c698c3a1","modified":1762852749307},{"_id":"themes/butterfly/layout/page.pug","hash":"7ce2a49c6c41847de4ccea377ade116339984434","modified":1762852749307},{"_id":"themes/butterfly/layout/index.pug","hash":"a93004cc8ec8050df603d32a6e6e02cd96fd9875","modified":1762852749306},{"_id":"themes/butterfly/layout/archive.pug","hash":"bc77220dfc269b8faad0930e1a4142ebf68165e5","modified":1762852749240},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/config.yml","hash":"63ad2249ad09fb3fe21bd5ff9adefb304a7ab24a","modified":1762852749229},{"_id":"themes/butterfly/layout/tag.pug","hash":"ca5333bd262cb58c195c844b593a0eed0c721766","modified":1762852749308},{"_id":"themes/butterfly/.github/workflows/publish.yml","hash":"e320b40c051bae1549156cd5ea4a51383cf78598","modified":1762852749230},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/bug_report.yml","hash":"10ce05c8dbde09f53bdabe40b5388de9ccc71a31","modified":1762852749228},{"_id":"themes/butterfly/.github/workflows/stale.yml","hash":"4040c76547e270aaf184e9b219a44ca41bbb1b9f","modified":1762852749231},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/feature_request.yml","hash":"6e0f9470b18bd37d4891282ac73d61676b040e8c","modified":1762852749229},{"_id":"themes/butterfly/scripts/events/404.js","hash":"039fc75f363d79669b0b2177d929cdff6f2ef7a4","modified":1762852749311},{"_id":"themes/butterfly/scripts/common/postDesc.js","hash":"ba98361b9d469076bfb045e5ff42eaf764a38fb1","modified":1762852749311},{"_id":"themes/butterfly/scripts/events/cdn.js","hash":"7864ba45716c51aef8d8b04fd4bc212e0008ce3b","modified":1762852749311},{"_id":"themes/butterfly/scripts/events/stylus.js","hash":"bac639c404588ea62e601ef0bcd368c3bd0119af","modified":1762852749313},{"_id":"themes/butterfly/scripts/events/welcome.js","hash":"f59e10305fef59ea3e62a7395106c0927582879d","modified":1762852749313},{"_id":"themes/butterfly/scripts/common/default_config.js","hash":"de1c2234f960445507b5b4cc4e60a0048dcdbc22","modified":1762852749310},{"_id":"themes/butterfly/scripts/tag/flink.js","hash":"25eefe10189caf3910a0e5d5b2f2043ae9255531","modified":1762852749319},{"_id":"themes/butterfly/scripts/events/init.js","hash":"350bd58ac7d53c133981c76aae034b50bf6b24fe","modified":1762852749312},{"_id":"themes/butterfly/scripts/tag/button.js","hash":"2f44e1b3ccd170b256eae178299d6fa933a8d490","modified":1762852749318},{"_id":"themes/butterfly/scripts/tag/gallery.js","hash":"fa3d0a64f7fce4aff7928d4ddd95548978ba001c","modified":1762852749320},{"_id":"themes/butterfly/scripts/tag/chartjs.js","hash":"195ba802d7e8406c155124a9c939a2318f82938b","modified":1762852749319},{"_id":"themes/butterfly/scripts/tag/hide.js","hash":"1ebe936e202c1baee8f6b7862a431e43db807229","modified":1762852749320},{"_id":"themes/butterfly/scripts/tag/mermaid.js","hash":"795b83d4664101a762222c80f01def86331b102e","modified":1762852749321},{"_id":"themes/butterfly/scripts/tag/label.js","hash":"cf0bc17d0180231167cc6aa8a00fc64f198cb9f9","modified":1762852749321},{"_id":"themes/butterfly/scripts/tag/note.js","hash":"e68d8d21f3a86e3646907a3685550ee20e8d4a9f","modified":1762852749322},{"_id":"themes/butterfly/scripts/tag/score.js","hash":"f2f8a789967cda9559778b1936233dfb46a1f3a3","modified":1762852749322},{"_id":"themes/butterfly/scripts/tag/series.js","hash":"40bc9a065e3a1423e0e66f4911e00713ca9f5e9e","modified":1762852749322},{"_id":"themes/butterfly/scripts/tag/timeline.js","hash":"176804f07567aa80f1ed95897a968a996b155dec","modified":1762852749324},{"_id":"themes/butterfly/scripts/tag/inlineImg.js","hash":"89c6c78d2db43b190055d5690741a79bab4f3e7e","modified":1762852749320},{"_id":"themes/butterfly/scripts/tag/tabs.js","hash":"3c486b149e28edd1a06843f05a5c355000991b82","modified":1762852749324},{"_id":"themes/butterfly/scripts/helpers/aside_archives.js","hash":"fcf14a7a2cd409f63d66a3c3421911ef3ce327bc","modified":1762852749315},{"_id":"themes/butterfly/scripts/filters/random_cover.js","hash":"20a6ebf63439501a4b3fc81e7a2a2ea5d103bace","modified":1762852749314},{"_id":"themes/butterfly/scripts/filters/post_lazyload.js","hash":"f96ccb349501dd2a268f1b64861600e3dc15e4e8","modified":1762852749314},{"_id":"themes/butterfly/scripts/helpers/getArchiveLength.js","hash":"bf77635e920eaf52bceebc95f87c7c87a7ca8038","modified":1762852749316},{"_id":"themes/butterfly/scripts/helpers/page.js","hash":"25f7a5ce29fdab3b71a78788416e19276b6e2ac7","modified":1762852749317},{"_id":"themes/butterfly/scripts/helpers/aside_categories.js","hash":"0cdf781a8c14d7b50d309e69f282ec7b178804bb","modified":1762852749315},{"_id":"themes/butterfly/scripts/helpers/inject_head_js.js","hash":"f94370706fe2c8b0597a81afe2f3e9c29e919d83","modified":1762852749317},{"_id":"themes/butterfly/layout/includes/footer.pug","hash":"da95d64f44e1e6b516d1f96f57b4b0a537c29c19","modified":1762852749242},{"_id":"themes/butterfly/scripts/helpers/series.js","hash":"45367c4ce827329867dbcc750ec125da9ccb2cfd","modified":1762852749318},{"_id":"themes/butterfly/scripts/helpers/related_post.js","hash":"950b7d0966429bf0f9e6c5e1161e50e545e320b4","modified":1762852749318},{"_id":"themes/butterfly/layout/includes/additional-js.pug","hash":"c3c38591f7c97a3dac7771e1316310ca9a98487c","modified":1762852749241},{"_id":"themes/butterfly/layout/includes/layout.pug","hash":"e5e6c05a621483b3542f2884e8ba45e84b1e973a","modified":1762852749253},{"_id":"themes/butterfly/layout/includes/rightside.pug","hash":"3617840416f26078117f760579fb544dce07e1bc","modified":1762852749263},{"_id":"themes/butterfly/layout/includes/pagination.pug","hash":"062137cb4d078b27680da1ae28d524a9c963eebc","modified":1762852749260},{"_id":"themes/butterfly/layout/includes/head.pug","hash":"1d11e334b22dbbedcb0f751f9ee9789d4416605e","modified":1762852749243},{"_id":"themes/butterfly/layout/includes/sidebar.pug","hash":"3e65b7bf6bccccbba7e15349f0a44f15c64c5b5e","modified":1762852749264},{"_id":"themes/butterfly/source/css/index.styl","hash":"b13d96924a5534bff91d75566b196ac87b4fac22","modified":1762852749357},{"_id":"themes/butterfly/source/img/404.jpg","hash":"fb4489bc1d30c93d28f7332158c1c6c1416148de","modified":1762852749359},{"_id":"themes/butterfly/source/css/var.styl","hash":"41e5eb8c62fdf6ba12c98d026d6f26f08a4380e2","modified":1762852749358},{"_id":"themes/butterfly/source/img/error-page.png","hash":"d2519710498a871ca3e913c57e2ba20a805b6430","modified":1762852749364},{"_id":"themes/butterfly/source/img/friend_404.gif","hash":"8d2d0ebef70a8eb07329f57e645889b0e420fa48","modified":1762852749366},{"_id":"themes/butterfly/source/js/tw_cn.js","hash":"0561cc5c3d252d9b9b0d04a553028e9450965b6b","modified":1762852749370},{"_id":"themes/butterfly/source/img/favicon.ico","hash":"455ac256580bf31a45813dbbdb87219bfc8bfb04","modified":1762852749365},{"_id":"themes/butterfly/source/js/utils.js","hash":"f32e69a6e624ab224729b446f096da96ec263934","modified":1762852749370},{"_id":"themes/butterfly/source/js/main.js","hash":"76c9e76f7e10971f7bf604c1d98c4512bff43a2e","modified":1762852749367},{"_id":"themes/butterfly/layout/includes/head/Open_Graph.pug","hash":"e93a36d3c29b5a02c7f26a23f96e1f84b063cbe8","modified":1762852749243},{"_id":"themes/butterfly/layout/includes/head/analytics.pug","hash":"c2156c77a011b20fafd34f03ca073397c21b099f","modified":1762852749244},{"_id":"themes/butterfly/layout/includes/head/config.pug","hash":"f1d3552f7cebe1e9e89804b0c0fed47d3f6969ca","modified":1762852749245},{"_id":"themes/butterfly/layout/includes/head/google_adsense.pug","hash":"f29123e603cbbcc6ce277d4e8f600ba67498077c","modified":1762852749247},{"_id":"themes/butterfly/layout/includes/head/pwa.pug","hash":"83ed05ef1e39f2ee70c3fba2cf96e488d8ffec66","modified":1762852749248},{"_id":"themes/butterfly/layout/includes/head/config_site.pug","hash":"56a3c32de1a15627ff38c67f1131cdd6ec5ac924","modified":1762852749246},{"_id":"themes/butterfly/layout/includes/head/preconnect.pug","hash":"1e1a69aa2cbda2e621c741b3802093244b3cc04e","modified":1762852749247},{"_id":"themes/butterfly/layout/includes/head/site_verification.pug","hash":"5168caadc4cf541f5d6676a9c5e8ae47a948f9ad","modified":1762852749249},{"_id":"themes/butterfly/layout/includes/header/index.pug","hash":"44331c9db74b281b5c5c41439d3407a9076df1a1","modified":1762852749250},{"_id":"themes/butterfly/layout/includes/head/structured_data.pug","hash":"49db40e9d3edcf6323e6fe7c074ab09e41453c82","modified":1762852749249},{"_id":"themes/butterfly/layout/includes/header/menu_item.pug","hash":"733184f88e3a586a5fcc9d193ad500556b6c8eed","modified":1762852749251},{"_id":"themes/butterfly/layout/includes/header/post-info.pug","hash":"7d799c4694adb6e265e3f4b975d7f7f6a7021a17","modified":1762852749252},{"_id":"themes/butterfly/layout/includes/header/nav.pug","hash":"f478a82ba4c15d4f6a5db38eca5c61f7054fa71d","modified":1762852749251},{"_id":"themes/butterfly/layout/includes/header/social.pug","hash":"e2d31e0f450ad42c47f7ee96375799342bf2f19b","modified":1762852749253},{"_id":"themes/butterfly/layout/includes/loading/fullpage-loading.pug","hash":"d4d266eced4b9167bed86bcc5addc327f78cbdcc","modified":1762852749254},{"_id":"themes/butterfly/layout/includes/loading/pace.pug","hash":"9d2d539555bab495959b9df734ed5c43a9f9e5a9","modified":1762852749255},{"_id":"themes/butterfly/layout/includes/mixins/article-sort.pug","hash":"ef7afe0df7a3746744ac8185da7163b7406120ca","modified":1762852749255},{"_id":"themes/butterfly/layout/includes/loading/index.pug","hash":"d76ce71ba106e350670c021a3dcae57547d01830","modified":1762852749254},{"_id":"themes/butterfly/layout/includes/mixins/indexPostUI.pug","hash":"f3389fa9ae4fa32e3c16573286583bc3023e57ad","modified":1762852749256},{"_id":"themes/butterfly/layout/includes/page/404.pug","hash":"15d32c511e4875066fcbe9cb84c3ada07b5a7c41","modified":1762852749257},{"_id":"themes/butterfly/layout/includes/page/categories.pug","hash":"5276a8d2835e05bd535fedc9f593a0ce8c3e8437","modified":1762852749257},{"_id":"themes/butterfly/layout/includes/page/flink.pug","hash":"6b0fa5f048aca8e9cbe56978301af918cf7ac34a","modified":1762852749258},{"_id":"themes/butterfly/layout/includes/page/tags.pug","hash":"79ad31eb72a9e14007770b18a426406a25315b38","modified":1762852749259},{"_id":"themes/butterfly/layout/includes/page/shuoshuo.pug","hash":"2cc8f09b56ade6c581398d977fe38c1ecd9ed024","modified":1762852749259},{"_id":"themes/butterfly/layout/includes/page/default-page.pug","hash":"efb40388e37cca0b5e7c3c66e811a42f8d32c910","modified":1762852749258},{"_id":"themes/butterfly/layout/includes/post/post-copyright.pug","hash":"b96c232e5178d927987791d9ae386dd83679535a","modified":1762852749261},{"_id":"themes/butterfly/layout/includes/post/outdate-notice.pug","hash":"b7ce9484bc5c97ea6154f0b78fb9b8951fafedbd","modified":1762852749260},{"_id":"themes/butterfly/layout/includes/post/reward.pug","hash":"db92f25ff3fd061882f81bf74ca560ff66983a0c","modified":1762852749262},{"_id":"themes/butterfly/layout/includes/third-party/effect.pug","hash":"43014bfc63583d3ee8808d526dd165848c0ed52f","modified":1762852749283},{"_id":"themes/butterfly/layout/includes/third-party/pjax.pug","hash":"dc2d36c6ccf5ad1b5f115c443772764f58a87fd6","modified":1762852749291},{"_id":"themes/butterfly/layout/includes/third-party/aplayer.pug","hash":"ed79fef5b5025415ea12eaed970f3fe7f6ef9596","modified":1762852749266},{"_id":"themes/butterfly/layout/includes/third-party/prismjs.pug","hash":"88f979a0b1a19eeb0db229247833bf9c6865c3b9","modified":1762852749292},{"_id":"themes/butterfly/layout/includes/third-party/subtitle.pug","hash":"236c3ce26dd76e80b04d457789475c42da5ac0c8","modified":1762852749300},{"_id":"themes/butterfly/layout/includes/widget/card_ad.pug","hash":"a8312b527493dabbadbb1280760168d3bc909a3b","modified":1762852749301},{"_id":"themes/butterfly/layout/includes/widget/card_announcement.pug","hash":"21e019bdc3b1e796bb00976bb29af2d51f873624","modified":1762852749301},{"_id":"themes/butterfly/layout/includes/widget/card_archives.pug","hash":"73d33b6930e7944187a4b3403daf25d27077a2dd","modified":1762852749302},{"_id":"themes/butterfly/layout/includes/third-party/umami_analytics.pug","hash":"c912959307b5e968df9b96fdef560ba8f3da19c5","modified":1762852749300},{"_id":"themes/butterfly/layout/includes/widget/card_bottom_self.pug","hash":"1dba77d250eeebfb6e293d504352c7e9ea31980b","modified":1762852749302},{"_id":"themes/butterfly/layout/includes/widget/card_categories.pug","hash":"66e383b4ef374951eb87dd1bf4cdb7a667193fb5","modified":1762852749303},{"_id":"themes/butterfly/layout/includes/widget/card_newest_comment.pug","hash":"d8753772889b5d0f4d15639ed6af5e91e53b1d03","modified":1762852749303},{"_id":"themes/butterfly/layout/includes/widget/card_recent_post.pug","hash":"bb842d2aa6469d65bf06af1372f0a19a9e4ef44c","modified":1762852749305},{"_id":"themes/butterfly/layout/includes/widget/card_tags.pug","hash":"f7e69cb0cb8dfe9445a15854604a6f9189338615","modified":1762852749305},{"_id":"themes/butterfly/layout/includes/widget/card_top_self.pug","hash":"7b5ae404a1205546b7de4be42291315cf918f2b3","modified":1762852749305},{"_id":"themes/butterfly/layout/includes/widget/card_post_toc.pug","hash":"1dd19a564320d248dbcee7f118a5b96c6466da65","modified":1762852749304},{"_id":"themes/butterfly/layout/includes/widget/card_webinfo.pug","hash":"fcddd80cdeb6aa81f342cd9f0102302f6ba087a8","modified":1762852749306},{"_id":"themes/butterfly/layout/includes/widget/index.pug","hash":"45f620cd87b9ef2aa9d1e024e697ed6b4eecff34","modified":1762852749306},{"_id":"themes/butterfly/layout/includes/widget/card_author.pug","hash":"1aba8aa7cd767dc96879d13a13b4c8ceb9023233","modified":1762852749302},{"_id":"themes/butterfly/source/css/_global/function.styl","hash":"9a7d1427cdf2f9fb7031eafcc651f63ac3eac7b0","modified":1762852749325},{"_id":"themes/butterfly/source/css/_highlight/highlight.styl","hash":"dce34eea0be6e45dc719c63ae340d8803be468d0","modified":1762852749327},{"_id":"themes/butterfly/layout/includes/widget/card_post_series.pug","hash":"e0bb72fa0ce15964b11b8fe421cae3432394e35f","modified":1762852749304},{"_id":"themes/butterfly/source/css/_global/index.styl","hash":"9426ab6c6fe84a76582dcb4e7762385c7c0a47f4","modified":1762852749326},{"_id":"themes/butterfly/source/css/_highlight/theme.styl","hash":"a51edfd3e499e7d38c32241c40e8e4d371efca73","modified":1762852749330},{"_id":"themes/butterfly/source/css/_layout/comments.styl","hash":"fbfce4d67cacd1df22fb73d89d008693f59d9d91","modified":1762852749332},{"_id":"themes/butterfly/source/css/_layout/aside.styl","hash":"1cb1c5fcdefc55aab674d7d84d057151f8f76577","modified":1762852749331},{"_id":"themes/butterfly/source/css/_layout/footer.styl","hash":"5692bcf8929f7ef12b10d860da6cb90ca55752c0","modified":1762852749333},{"_id":"themes/butterfly/source/css/_layout/chat.styl","hash":"4cc02bcbaa4a1933a82a9ea57a603fe2d059fc77","modified":1762852749332},{"_id":"themes/butterfly/source/css/_layout/post.styl","hash":"543eaf9c7df7e0db841e5946ee5f9082c3c46290","modified":1762852749335},{"_id":"themes/butterfly/source/css/_layout/loading.styl","hash":"f0b01bbf321c2c24fdccaee367dd9fd448031a72","modified":1762852749334},{"_id":"themes/butterfly/source/css/_layout/relatedposts.styl","hash":"ef8e8549fe7ad4b99793844a93b4a89f77f417d5","modified":1762852749335},{"_id":"themes/butterfly/source/css/_layout/pagination.styl","hash":"7d7554573c005399bc8c2264a85896d2d51be1e1","modified":1762852749334},{"_id":"themes/butterfly/source/css/_layout/reward.styl","hash":"dcf24780ec6f1a3bf4a277d79d6287b9e65dbbe4","modified":1762852749336},{"_id":"themes/butterfly/source/css/_layout/rightside.styl","hash":"d4e8a938ef2a1f4bf895d187e4fa529c7476e238","modified":1762852749336},{"_id":"themes/butterfly/source/css/_layout/head.styl","hash":"7536c44e78115559a996d0384adec38b78d8dc25","modified":1762852749333},{"_id":"themes/butterfly/source/css/_mode/darkmode.styl","hash":"446cb0cebe2e4d0bbf055a57caaed0125f4b78e7","modified":1762852749337},{"_id":"themes/butterfly/source/css/_layout/sidebar.styl","hash":"e22bc88ab369c362905b29514d585b1d6bbfc5f3","modified":1762852749337},{"_id":"themes/butterfly/source/css/_page/archives.styl","hash":"5abe5480d83ff8b452a780a484d50a44091475bf","modified":1762852749339},{"_id":"themes/butterfly/source/css/_layout/third-party.styl","hash":"0af7c8754f04bdd9a02a14d880774753bd2e35ee","modified":1762852749337},{"_id":"themes/butterfly/source/css/_page/categories.styl","hash":"c4cda7b0c99015df29ce00fdfddd2f7679653754","modified":1762852749340},{"_id":"themes/butterfly/source/css/_mode/readmode.styl","hash":"ad66212554468b7067590308ed4cf40524fea662","modified":1762852749338},{"_id":"themes/butterfly/source/css/_page/common.styl","hash":"1a1766f8ea6a6576ec6129887e55221f540b9358","modified":1762852749341},{"_id":"themes/butterfly/source/css/_page/shuoshuo.styl","hash":"a764c44ce1f17f966b2f439762f038570af00b1b","modified":1762852749343},{"_id":"themes/butterfly/source/css/_page/404.styl","hash":"205ccc7d0ec6ce1193b46bc0c9ce0385594581fb","modified":1762852749338},{"_id":"themes/butterfly/source/css/_page/flink.styl","hash":"1f8d715faf3b91b53426e38195c0920afb3bfa1c","modified":1762852749341},{"_id":"themes/butterfly/source/css/_page/homepage.styl","hash":"fc26e980fedde31644ebf878967f66ef9ba32be2","modified":1762852749342},{"_id":"themes/butterfly/source/css/_page/tags.styl","hash":"4681a9d93a20b8de9f58cdbc794702f76f35192b","modified":1762852749343},{"_id":"themes/butterfly/source/css/_search/algolia.styl","hash":"f6d0cfb510a0e351ec20b043d3d3784d0f6c96a4","modified":1762852749349},{"_id":"themes/butterfly/source/css/_tags/button.styl","hash":"f3fd3c43f16606a7b956fcb94b0d975b2d705fff","modified":1762852749351},{"_id":"themes/butterfly/source/css/_search/index.styl","hash":"5a8a181324a2f6b7d8240ea871971444403fa554","modified":1762852749350},{"_id":"themes/butterfly/source/css/_tags/gallery.styl","hash":"30d1f809efd252ed0233d96d4374efd2b01d2292","modified":1762852749352},{"_id":"themes/butterfly/source/css/_search/local-search.styl","hash":"d33d4af89231f4b0f1300bf2e9725344b4fab969","modified":1762852749350},{"_id":"themes/butterfly/source/css/_tags/hexo.styl","hash":"985b183db7b7bfd8f9bdb60494549fb7f850348b","modified":1762852749352},{"_id":"themes/butterfly/source/css/_tags/note.styl","hash":"db2e94a2dd24a2777c9a74b35f98c11d71488003","modified":1762852749354},{"_id":"themes/butterfly/source/css/_tags/inlineImg.styl","hash":"3be8d0a75e7cc96548667cae0cb6a474279bd0b5","modified":1762852749353},{"_id":"themes/butterfly/source/css/_tags/series.styl","hash":"0657169849bc4bf4d93b5492ade040c8f58c1901","modified":1762852749354},{"_id":"themes/butterfly/source/css/_tags/label.styl","hash":"e84f1de06b818557cc4c45f9958121952ae268b8","modified":1762852749353},{"_id":"themes/butterfly/source/css/_tags/hide.styl","hash":"77cdcf374761800e638d7d39205a0becb1052011","modified":1762852749352},{"_id":"themes/butterfly/source/css/_third-party/normalize.min.css","hash":"8549829fb7d3c21cd9e119884962e8c463a4a267","modified":1762852749357},{"_id":"themes/butterfly/source/css/_tags/tabs.styl","hash":"3a88eedcb694da79e92581ce50cb1a430b1fb615","modified":1762852749355},{"_id":"themes/butterfly/source/css/_tags/timeline.styl","hash":"e846ddaef494d46cdfa2379deacfe74fa1cc5264","modified":1762852749356},{"_id":"themes/butterfly/source/js/search/algolia.js","hash":"13f37791badfb942f639cc25092ee32d43de31bf","modified":1762852749368},{"_id":"themes/butterfly/layout/includes/third-party/abcjs/index.pug","hash":"f0a90d8e39915a74b16ef22e851f179415cd7eaa","modified":1762852749265},{"_id":"themes/butterfly/source/js/search/local-search.js","hash":"4adfe4087d8350a1188135a32a3bf76c6b305787","modified":1762852749369},{"_id":"themes/butterfly/layout/includes/third-party/abcjs/abcjs.pug","hash":"7df4d27cf9e576c6b9c1e4f76a100a41749ca8bb","modified":1762852749264},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/disqus.pug","hash":"d6fff5a7f84c8b09f282f9ddc0020a68a8aac9ea","modified":1762852749267},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/remark42.pug","hash":"716dc463fe4ef5112e7018ed60804125fdfa5cad","modified":1762852749269},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/twikoo.pug","hash":"be45b522286bbc64724341f23a5056ad24d3f796","modified":1762852749269},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/fb.pug","hash":"cbfbcf34a24d21ba2b21cf9eedb76f4c3c563c5a","modified":1762852749268},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/index.pug","hash":"846cabae287ae31b3bbfac3da022475713dd5ecc","modified":1762852749268},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/artalk.pug","hash":"b03ee8625149191f9d5d057bbc9824b68d8dd0c4","modified":1762852749266},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/waline.pug","hash":"fd2320ee25507bb8ef49f932c2d170586b44ea4d","modified":1762852749271},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/valine.pug","hash":"7884883ec15792f7e54daacb3c62b851dde2b66a","modified":1762852749270},{"_id":"themes/butterfly/layout/includes/third-party/chat/crisp.pug","hash":"24d094fd917947c0ca7492fa094328b1a183b873","modified":1762852749272},{"_id":"themes/butterfly/layout/includes/third-party/chat/index.pug","hash":"e8438941085def0591a72fc9b0d705dbf107f54f","modified":1762852749272},{"_id":"themes/butterfly/layout/includes/third-party/chat/chatra.pug","hash":"5b29badecbbe828112c001156023fc0566045cf6","modified":1762852749271},{"_id":"themes/butterfly/layout/includes/third-party/chat/tidio.pug","hash":"62466b251052cae609b6369d4cb4b6a85320757d","modified":1762852749273},{"_id":"themes/butterfly/layout/includes/third-party/comments/artalk.pug","hash":"9801f581cd1d2aaa3eed8739487b9b3ec395c354","modified":1762852749274},{"_id":"themes/butterfly/layout/includes/third-party/comments/disqusjs.pug","hash":"c81fa7d8a5cb96d1ae07bfa8c46b84a58161add1","modified":1762852749275},{"_id":"themes/butterfly/layout/includes/third-party/comments/gitalk.pug","hash":"58914c58a190e3bc0aa37cb581e77e442b563501","modified":1762852749277},{"_id":"themes/butterfly/layout/includes/third-party/comments/giscus.pug","hash":"592b2251db6c1abeb8b0eebe3b2e6d9aa0dec445","modified":1762852749276},{"_id":"themes/butterfly/layout/includes/third-party/comments/index.pug","hash":"332b532bafbaf369fde840883b77e5a23d050a39","modified":1762852749278},{"_id":"themes/butterfly/layout/includes/third-party/comments/facebook_comments.pug","hash":"8af585e6d6f73ee57114eefad574dc6e8ea9f570","modified":1762852749276},{"_id":"themes/butterfly/layout/includes/third-party/comments/livere.pug","hash":"9d84a681289175dec75a85f301d2fc9ce1b2bb7a","modified":1762852749280},{"_id":"themes/butterfly/layout/includes/third-party/comments/js.pug","hash":"3abbaaa4ea575c45b3cebffd40bad1acc6ffce84","modified":1762852749279},{"_id":"themes/butterfly/layout/includes/third-party/comments/disqus.pug","hash":"f2ea5249b3e6670f6c8c77868f4f42c502e43830","modified":1762852749274},{"_id":"themes/butterfly/layout/includes/third-party/comments/remark42.pug","hash":"ea9766439b6b1936306916a8b08d2681afbc8ea9","modified":1762852749280},{"_id":"themes/butterfly/layout/includes/third-party/comments/utterances.pug","hash":"30a7d157890de69deab28baa47fb7bb28b040efd","modified":1762852749281},{"_id":"themes/butterfly/layout/includes/third-party/comments/twikoo.pug","hash":"53d99831f29aeb2e336ed1407d79590041f77002","modified":1762852749281},{"_id":"themes/butterfly/layout/includes/third-party/comments/valine.pug","hash":"24f18b0c67803210d53abbf9c1d454c000b06eee","modified":1762852749282},{"_id":"themes/butterfly/layout/includes/third-party/math/index.pug","hash":"af66d13204030d47537b9e31a6173e63589ce7ff","modified":1762852749285},{"_id":"themes/butterfly/layout/includes/third-party/comments/waline.pug","hash":"e2bf15357485cd502414b3b20f5b1f762a2fd014","modified":1762852749283},{"_id":"themes/butterfly/layout/includes/third-party/math/katex.pug","hash":"b83db9fa64d42a0bfd97efb660e09be3f166a144","modified":1762852749285},{"_id":"themes/butterfly/layout/includes/third-party/math/mathjax.pug","hash":"ca54256d6dbb73c4d5a00852b4d673db969cd069","modified":1762853765235},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/common.pug","hash":"27fa75affebc6e84a487c62bceff783bde595256","modified":1762852749288},{"_id":"themes/butterfly/layout/includes/third-party/math/mermaid.pug","hash":"05c9c4705670497454bf9bd3ff6954c4fced158c","modified":1762852749287},{"_id":"themes/butterfly/layout/includes/third-party/math/chartjs.pug","hash":"732eb1118ea1a73aa5c164d639097c614f8e9953","modified":1762852749284},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/artalk.pug","hash":"187302dbc916852ff2fdf47061e272c061611dda","modified":1762852749287},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/github-issues.pug","hash":"72e2970b23570e308f8af5d8ba8e5e3321d01bbf","modified":1762852749289},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/index.pug","hash":"a7c07dbc1e970a5b247091458e1ee9b144a3366d","modified":1762852749289},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/disqus-comment.pug","hash":"fa4b4194749d05f7249f365f2b89c0281057ce54","modified":1762852749288},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/remark42.pug","hash":"34edfebf0cace0852806be774910ccb0e0914650","modified":1762852749290},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/twikoo-comment.pug","hash":"d2e12a9fc302a4efe52c90d44896fbd73e193a1f","modified":1762852749290},{"_id":"themes/butterfly/layout/includes/third-party/search/docsearch.pug","hash":"013756ff3363344987cc00fc9bd833baf193c341","modified":1762852749296},{"_id":"themes/butterfly/layout/includes/third-party/share/share-js.pug","hash":"efef352c1d122409575386bf3894dce8e87032e2","modified":1762852749299},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/waline.pug","hash":"ec6c685080634ac46ffbea1b8f10313388888f43","modified":1762852749291},{"_id":"themes/butterfly/layout/includes/third-party/share/addtoany.pug","hash":"5c944052280c5ed046d2cfeb54b0da8876af0ec6","modified":1762852749298},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/valine.pug","hash":"d376ec17fb19fcdcf0d2ad71330190146d3af879","modified":1762852749291},{"_id":"themes/butterfly/layout/includes/third-party/search/algolia.pug","hash":"c34c1b19b3cfe24ca11c5edfb34613507a9a00c7","modified":1762852749293},{"_id":"themes/butterfly/layout/includes/third-party/search/index.pug","hash":"f8557548d2ad8dd149c562193991c6c6cda02415","modified":1762852749297},{"_id":"themes/butterfly/layout/includes/third-party/search/local-search.pug","hash":"70364f4a9d9f13d713533a0fe0a9798707f1c1b3","modified":1762852749297},{"_id":"themes/butterfly/layout/includes/third-party/share/index.pug","hash":"e51e896ccb13900de38dc81cf44dc789e2418a12","modified":1762852749299},{"_id":"themes/butterfly/source/css/_highlight/highlight/diff.styl","hash":"9f02598b5e4296aec6470639d4bac4c9ac46392e","modified":1762852749327},{"_id":"themes/butterfly/source/css/_highlight/highlight/index.styl","hash":"ef52ebf1e8e751a412f9456fdaeee7d88afd9a72","modified":1762852749328},{"_id":"themes/butterfly/source/css/_highlight/prismjs/index.styl","hash":"1883c91d43bff10aae55122a21e0b064b6f5c9dd","modified":1762852749330},{"_id":"themes/butterfly/source/css/_highlight/prismjs/diff.styl","hash":"077ec530831be1d80e93da380406b9f5abd0918a","modified":1762852749329},{"_id":"themes/butterfly/source/css/_highlight/prismjs/line-number.styl","hash":"de4bb5fc2dfca368b35e4c1109c92f7abc9e2245","modified":1762852749330},{"_id":"themes/butterfly/source/img/butterfly-icon.png","hash":"f5dd732fed5c3bcd4aa76bac3441bac8485fb432","modified":1762852749362}],"Category":[],"Data":[],"Page":[{"layout":"page","title":"categories","date":"2025-11-10T14:32:06.000Z","tags":null,"_content":"","source":"categories/index.md","raw":"---\nlayout: page\ntitle: categories\ndate: 2025-11-10 22:32:06\ntags:\n---\n","updated":"2025-11-11T09:19:09.226Z","path":"categories/index.html","comments":1,"_id":"cmhud1bed0000b0mn4ejjd1c0","content":"","excerpt":"","more":""}],"Post":[{"layout":"post","title":"贝塞尔曲线","date":"2025-11-10T14:43:17.000Z","_content":"\n\n# Bezier曲线\n\n贝塞尔曲线于 1962 年，由法国工程师皮埃尔·贝济埃（Pierre Bézier）所广泛发表，他运用贝塞尔曲线来为汽车的主体进行设计,贝塞尔曲线最初由保尔·德·卡斯特里奥于1959年运用德卡斯特里奥算法开发，以稳定数值的方法求出贝塞尔曲线.\n\n**先从几个简单的例子开始：**\n\n## 一阶贝塞尔曲线\n\n<img src=\"v2-770487eacf3b9d5973e2783b6d8698e5_r.jpg\" alt=\"img\" style=\"zoom: 33%;\" />\n\n对于一阶贝塞尔曲线为我们可以看到是一条直线，通过几何知识，很容易根据t的值得出线段上那个点的坐标。\n\n给定点 $P_0$、$P_1$，线性贝塞尔曲线只是一条两点之间的直线。这条线由下式给出：\n\n$$\\mathbf{B}(t)=\\mathbf{P}_0+(\\mathbf{P}_1-\\mathbf{P}_0)t=(1-t)\\mathbf{P}_0+t\\mathbf{P}_1,t\\in[0,1]$$\n\n一阶曲线就是很好理解, 就是根据t来的线性插值。$P_0$表示的是一个向量 $[x ,y]$, 其中$x$和$y$是分别按照这个公式来计算的。\n\n## 二阶贝塞尔曲线\n\n<img src=\"image-20230715134335693.png\" alt=\"image-20230715134335693\" style=\"zoom: 50%;\" />\n\n<img src=\"image-20230715134422584.png\" alt=\"image-20230715134422584\" style=\"zoom: 50%;\" />\n\n在平面内任选 3 个不共线的点，依次用线段连接。在第一条线段上任选一个点 $D$。计算该点到线段起点的距离$AD$，与该线段总长$AB$的比例。\n\n<img src=\"image-20230715134508818.png\" alt=\"image-20230715134508818\" style=\"zoom: 50%;\" />\n\n根据上一步得到的比例，从第二条线段上找出对应的点 $E$，使得 $AD:AB = BE:BC$\n\n<img src=\"image-20230715134543049.png\" alt=\"image-20230715134543049\" style=\"zoom:50%;\" />\n\n<img src=\"image-20230715134555599.png\" alt=\"image-20230715134555599\" style=\"zoom:50%;\" />\n\n这时候$DE$又是一条直线了, 就可以按照一阶的贝塞尔方程来进行线性插值了：\n\n$$t= AD:AE$$\n\n这时候就可以推出公式了：\n\n![img](Bézier_2_big.gif)\n\n$$P_0=(1-t)P_0+tP_1$$\n\n$$P_1=(1-t)P_1+tP_2$$\n\n整理一下公式, 得到二阶贝塞尔公式：\n\n$$\\mathbf{B}(t) =(1-t)^{2}\\mathbf{P}_{0}+2t(1-t)\\mathbf{P}_{1}+t^{2}\\mathbf{P}_{2},t\\in[0,1]$$\n\n\n\n## 三阶贝塞尔曲线\n\n<img src=\"image-20230715135427376.png\" alt=\"image-20230715135427376\" style=\"zoom:50%;\" />\n\n四个点对应是三次的贝塞尔曲线. 分别在 $AB$、$BC$、$CD$ 之间采$EFG$点, $EFG$三个点对应着二阶贝塞尔, 在$EF$、$FG$之间采集$H$、$I$点来降阶为一阶贝塞尔曲线.\n\n公式：\n\n$$\\mathbf{B}(t)=\\mathbf{P}_0(1-t)^3+3\\mathbf{P}_1t(1-t)^2+3\\mathbf{P}_2t^2(1-t)+\\mathbf{P}_3t^3,t\\in[0,1]_0$$\n\n动画效果\n\n![img](Bézier_3_big-168860760518218.gif)\n\n\n\n## 贝塞尔曲线公式\n\n贝塞尔曲线是通过空间中的$n+1$个点$P_0, P_1, P_2, \\ldots, P_n$来定义的，这些点称为控制点。控制点决定了曲线的形状，贝塞尔曲线定义如下：\n\n$$\\mathbf{C}(u)=\\sum_{i=0}^nB_{n,i}(u)\\mathbf{P}_i$$\n\n其中系数定义如下：\n\n$$B_{n,i}(u)=\\frac{n!}{i!(n-i)!}u^{i}(1-u)^{n-i}$$\n\n贝塞尔曲线上对应于参数位置为$u$的点，是所有控制点的\"加权\"平均值，其中权重是系数$B_{n,i}(u)$，其中$u$的定义域为$[0,1]$。函数$B_{n,i}(u), 0 \\leq i \\leq n$被称为**贝塞尔基函数**或**伯恩斯坦多项式**。\n\n将控制点点$P_0P_1, P_2, \\ldots, P_n$按此顺序连接，我们得到了一个**控制多边形**，它帮助我们描述了曲线的大致形状。\n\n下图展示了由11个控制点定义的贝塞尔曲线，其中蓝色点是对应于$u=0.4$的曲线上的点。如图所示，曲线或多或少地跟随着多边形线。\n\n![img](b-curve-1-17103242022572.jpg)\n\n\n\n****\n\n**问题：当$u$的定义域非[0,1]时如何处理？**\n\n贝塞尔曲线不总是定义在$[0,1]$这一标准区间上，有时其定义域可能为$[a,b]$。在这种情况下，就需要进行变量的转换。我们需要做的是，将$u$从区间$[a,b]$映射到$[0,1]$，然后在基函数中使用转换后的$u$值。具体的转换方法如下：\n\n$$u'=\\frac{u-a}{b-a}$$\n\n将转换后的$u'$代入到基函数$B_{n,i}(u)$中，可以得到新的公式：\n\n$$B_{n,i}(u')=\\frac{n!}{i!(n-i)!}\\left(\\frac{u-a}{b-a}\\right)^i\\left(1-\\frac{u-a}{b-a}\\right)^{n-i}$$\n\n这一变换后的基函数定义了在区间$[a,b]$上的贝塞尔曲线\n\n\n\n## 贝塞尔曲线的特点和性质\n\n- **贝塞尔曲线由$n+1$个控制点定义，曲线的度数是$n$**：\n  在每个基函数中，$u$的指数是$i + (n - i) = n$。因此，曲线的度数是$n$\n\n- 曲线$C(u)$通过第一个控制点$P_0$和最后一个控制点$P_n$\n\n- **非负性**：所有基函数都是非负的。\n\n- **单位分割**：在任一特定的$u$值下，这些基函数值的总和为1。这保证了曲线上的任一点都是控制点加权平均的结果，且权重总和为1\n\n  \n\n  ![img](b-curve-2-17091716014474-17103791115213.jpg)![img](b-pou-1-17091716014476.jpg)\n\n  \n\n  在上面的左侧图片中，展示了一个基于五个控制点构成的贝塞尔曲线。而右侧的图则展示了作为$u$值函数的五个基函数。\n\n  这些图表揭示了当$u=0.5$时，这五个基函数的分布情况。图中最右侧的竖条图清晰地展现了如何将数值1等分为五部分，这就是所谓的**单位分割**。\n\n  所有基函数的取值范围从0到1，它们的总和恰好为1，因此，这些基函数在计算加权平均时充当了权重的角色。更简单地说，计算**C**($u$)时，实际上是将控制点$P_i$按照$B_{n,i}(u)$的权重进行加权汇总。\n\n  \n\n- **凸包性质**\n\n  贝塞尔曲线的一个显著特点是，它完全被其$n + 1$个控制点所形成的凸包所包围。所谓凸包，指的是能够包含一组点集所有点的最小凸形状。\n\n  在下面的示例中，11个控制点形成的凸包以灰色表示。值得注意的是，并不是所有控制点都位于凸包的边缘。比如，控制点3、4、5、6、8和9位于凸包内部。除了起点和终点，曲线始终位于这个凸包之内。\n\n  ![img](b-curve-1-17103234093711.jpg)\n\n- **变差减少性**\n\n  在平面上，这个性质意味着没有任何直线能与贝塞尔曲线相交的次数超过它与曲线的控制多边形相交的次数。\n\n  ![img](b-variation-17103792438184.jpg)\n\n  如上图所示，黄色直线与曲线相交3次，但与控制多边形相交了7次；\n  红色直线与曲线相交5次，与控制多边形也相交7次；\n  而青色直线与曲线及其控制多边形都只相交两次。\n  你可以尝试绘制其他直线以验证这一性质。\n\n  若曲线是空间中的曲线，则只需将“直线”改为“平面”。\n\n  这一性质的意义何在？它告诉我们，与控制多边形相比，贝塞尔曲线的复杂性（即转弯和扭曲的程度）会更低。换言之，控制多边形相较于它所定义的贝塞尔曲线，会有更频繁的转弯和扭曲，因为任意直线与控制多边形相交的次数总是多于与曲线相交的次数。\n\n- **仿射不变性**\n\n  对贝塞尔曲线进行仿射变换时，其变换结果能够通过控制点经过相同变换后的新位置来确定。这一特性极为有利。当我们需要对贝塞尔曲线执行几何或仿射变换操作时，直接对控制点施加变换即可。完成控制点的变换后，由这些调整后的控制点所定义的新贝塞尔曲线即为所求。因此，无需直接对曲线本身进行变换处理。\n\n- **递归性**\n\n  递归性指其系数满足下式：\n  $$B_{i,n}(t)=(1-t)B_{i,n-1}(t)+tB_{i-1,n-1}(t)【i=0,1,\\cdots,n】$$\n\n- **一阶导数性质**\n\n  <img src=\"image-20230715142535462.png\" alt=\"image-20230715142535462\" style=\"zoom:50%;\" />\n\n  假设上图中贝塞尔的 $t$ 是由左到右从 $0$ 到 $1$ 增加的，那么贝塞尔曲线在 $t=0$ 时的导数是和 $P_0P_1$的斜率（导数）是相同，$t=1$ 时的导数是和$P_3P_4$ 的斜率（导数）是相同的\n\n  <img src=\"image-20230715142627416.png\" alt=\"image-20230715142627416\" style=\"zoom:50%;\" />\n\n  这一点的性质可以用在贝塞尔曲线的拼接，只要保证三点一线中的中间点是两段贝塞尔曲线的连接点，就可以保证两端贝塞尔曲线的导数连续\n\n\n\n## 控制点的移动对曲线的影响\n\n当我们调整一个贝塞尔曲线的控制点位置时，曲线形状将发生变化。这引出一个问题：\n\t\t\t\t\t**控制点移动到新的位置时，贝塞尔曲线将如何变形？**\n\n假设控制点 $P_k$ 移动到 $P_k+\\mathbf{v}$ 的新位置，向量 $\\mathbf{v}$ 表示移动的方向和距离。如图所示：\n\n![img](bezier-P+v.jpg)\n\n原始贝塞尔曲线表示为： $$\\mathbf{C}(u)=\\sum_{i=0}^nB_{n,i}(u)\\mathbf{P}_i$$\n\n由于新的贝塞尔曲线是由 $P_0, P_1, ..., P_k+\\mathbf{v}, ..., P_n$定义的，新的贝塞尔曲线方程 $D(u)$ 可以写成：\n\n$$\\begin{aligned}\n\\mathbf{D}(u)&=\\sum_{i=0}^{k-1}B_{n,i}(u)\\mathbf{P}_{i}+B_{n,k}(u)(\\mathbf{P}_{k}+\\mathbf{v})+\\sum_{i=k+1}^{n}B_{n,i}(u)\\mathbf{P}_{i}  \\\\\n&=\\sum_{i=0}^{n}B_{n,i}(u)\\mathbf{P}_{i}+B_{n,k}(u)\\mathbf{v} \\\\\n&=\\mathbf{C}(u)+B_{n,k}(u)\\mathbf{v}\n\\end{aligned}$$\n\n在上式中，因为只有第 $k$ 项控制点使用了 $P_k+\\mathbf{v}$，所以我们得出新曲线是原始曲线与额外的项 $B_{n,k}(u)\\mathbf{v}$ 的组合。\n\n因此，新曲线上任一给定 $u$ 对应的点，可以通过将原始曲线上相同位置的点沿向量  $\\mathbf{v}$ 的方向平移 $|B_{n,k}(u)\\mathbf{v}|$ 的距离来获得。\n\n更具体地来说，对于任意给定的 *u* 值，原曲线上对应的点为 $C(u)$，新曲线上对应的点为 $D(u)$，且 $D(u) = C(u) + B_{n,k}(u)\\mathbf{v}$。\n\n以下图说明这一变化：\n                                           ![img](bezier-move-ct-pt-1.jpg)\n\n图中，黑色与红色曲线分别代表由9个控制点定义的同一8次贝塞尔曲线的原始和变形状态。黑色曲线为原始状态。若其中一个控制点沿蓝色向量移动到新位置，黑色曲线便转变为红色曲线。\n\n图中同时标出了$u=0.5$时两条曲线上的对应点。可以明显看出，$C(0.5)$ 沿相同方向移动至 $D(0.5)$。从 $C(0.5)$ 到 $D(0.5)$ 的距离等同于向量 \n\n​\t\t\t\t\t\t$$B_{8,3}(0.5)\\mathbf{v} = \\frac{8!}{(3!(8-3)!)}×0.5^3(1-0.5)^{8-3}\\mathbf{v} = 0.22\\mathbf{v}$$\n\n因此，**该距离约为原始控制点3和下图所示的新控制点3之间距离的22%**\n\n从这一分析中，我们可以得出另一个重要的结论：\n因为 $B_{n,k}(u)$ 在开区间 $(0,1)$ 内非零，因此 $B_{n,k}(u)\\mathbf{v}$ 在此区间内不是零向量。这意味着除了端点 $C(0)$ 和 $C(1)$ 外，所有原始曲线上的点都会被移动到新的位置上。由此可见：\n\n​\t\t\t\t\t**移动控制点将会全面改变贝塞尔曲线的形状。**\n\n\n\n## 计算贝塞尔曲线上一点：De Casteljau 算法\n\n**在构造 Bézier 曲线后，如何找到曲线上参数为 $u$ 处的点 $C(u)$？**\n\n一种简单的方法是将 $u$ 代入贝塞尔曲线的公式：\n\n$$\\mathbf{C}(u)=\\sum_{i=0}^nB_{n,i}(u)\\mathbf{P}_i$$\n\n其中系数定义如下：\n\n$$B_{n,i}(u)=\\frac{n!}{i!(n-i)!}u^{i}(1-u)^{n-i}$$\n\n计算每个基函数的值，并计算每个基函数及其对应控制点的乘积，最后将它们相加。虽然这样可以，但不是**数值稳定**的（即在计算伯恩斯坦多项式的过程中可能引入数值误差）。\n\n还记得本文开始几个小节关于一阶、二阶、三阶贝塞尔曲线的推导过程吗，这就是**De Casteljau 算法**：\n\n首先，我们以编号的形式记录下控制点，如 $P_0$ 记作 $00$，$P_1$ 记作 $01$，依此类推，直至 $P_n$ 的编号为 $0n$。第一个数字 $0$ 表示第0阶或第一次迭代。在接下来的迭代中，这些数字会变成$1、2、3$ 等。\n\n**De Casteljau 算法的核心在于找到线段 AB 上某个点 $C$，该点按 $u:1-u$ 的比例将线段 $AB$ 划分。从而确立点 $C$ 的具体位置。**\n\n![img](point-c.jpg)\n\n线段$AB$ 的向量可以表示为 $B - A$。由于 $u$ 是介于 $0$ 和$1$ 之间的比例，所以点 $C$ 的位置可以用 $u(B - A)$ 来描述。再加上 $A$ 点的坐标，我们可以得到 $C$ 的准确位置为 \n\n$$A + u(B - A) = (1 - u)A + uB$$\n\n因此，对于任何给定的 $u$ 值， 我们都能准确地定位在 $A$ 与 $B$ 之间的一点 $C$。\n\n**如何找到贝塞尔曲线上任意一处参数 $u$ 的点 $C(u)$：**\n\n首先将控制点依次连接，得到一个折线：即 $00-01-02-03...-0n$ 多段线，然后根据上述公式在每对相邻控制点之间找到新点 $1i$，这个新点将原线段 $0i-0(i+1)$ 按 $u:1-u$ 的比例分割。通过这种方式，我们可以得到 $n$ 个新点：$10, 11, 12, ..., 1(n-1)$，它们共同构成了一条新的折线。\n\n![img](de-casteljau.jpg)\n\n如上图所示，例如，当 $u = 0.4$ 时，通过插值可以得到点$10$位于起始控制点$00$和$01$之间， 其中$\\frac{00-10}{10-01}=\\frac{u}{1-u}$ 。($00$即点$0$，$00$中的第一个$0$表示$0$阶，第二个$0$表示第$0$个点。$01$即点$1$，$01$中的第一个$0$表示$0$阶，第二个$1$表示第$1$个点） \n\n第二次迭代：点$11$位于点$01$和$02$之间，$\\frac{01-11}{11-02}=\\frac{u}{1-u}$以此类推，可以计算出点$12、13、14$。这些新产生的点都以蓝色标记。\n\n每一次迭代，我们获得的\"新控制点\"的数量都比之前迭代的结果少1，直到最减少到唯一的点$n0$。这一点就是在给定 $u$ 值下，贝塞尔曲线上的对应点 $C(u)$。\n\n举例：在上图中，\n点$20$可以通过以 $u:1-u$ 的比例划分线段$10-11$得到，。\n点$21$通过边$11-12$划分得到\n点$22$通过边$12-13$划分得到\n点$23$通过边$13-14$划分得到。\n从而得到了由点$20,21,22,23$定义的三阶折线。\n在折线段$20-21-22-23$的两两点之间进行插值，将得到个新的折线段$30-31-32$。继续迭代，将得到点$40$和$41$， 组成新的折线段$40-41$。\n继续迭代，将得到点$50$，这就是曲线上的点 $C(0.4)$。\n\n**用一张图表示De Casteljau 算法的迭代过程：**\n\n![img](de-cast-compute.jpg)\n\n从初始列，即第 $0$ 列，我们通过两两点之间的插值可以计算出第$1$列的\"新点\"，从第$1$列我们得到第$2$列，依此类推。最终，在应用了 $n$ 次之后，我们将得到唯一的点 $n0$，这就是贝塞尔曲线上的点$C(u)$。\n\n### **递归关系：自顶向下的计算方法**\n\n上述计算可以递归地表达。初始时，令 $P_{0,j}$ 为 $P_j$，其中 $j = 0, 1, ..., n$。$P_{0,j}$ 表示第 0 列的第 $j$ 项。那么第 $i$ 列的第 $j$ 项的计算如下：\n\n$$\\left.\\mathbf{P}_{i,j}=(1-u)\\mathbf{P}_{i-1,j}+u\\mathbf{P}_{i-1,j+1}\\quad\\left\\{\\begin{array}{l}i=1,2,\\ldots,n\\\\j=0,1,\\ldots,n-i\\end{array}\\right.\\right.$$\n\n基于这个公式，可能会立即想到以下递归算法：\n\n$$function$$ $$deCasteljau(i,j)$$\n$$if i = 0 then$$\n\t$$return$$ $$P_{0,j}$$\n$$else$$\n\t$$return$$ $$(1-u)$$ * $$deCasteljau(i-1,j)$$+  $$u$$ * $$deCasteljau(i-1,j+1)$$\n\n这个算法看起来简单，但是它极其低效。原因如下。我们从调用 $deCasteljau(n,0)$ 开始，计算 $P_{n,0}$。$else$ 分支将这个调用会递归产生两个新的调用，即$deCasteljau(n-1,0)$ 用于计算 $P_{n-1,0}$ 和 $deCasteljau(n-1,1)$ 用于计算 $P_{n-1,1}$。\n\n![img](de-cast-rec-comp.jpg)\n\n对 $deCasteljau(n-1,0)$ 的调用。又会产生两个新的调用，$deCasteljau(n-2,0)$ 用于计算 $P_{n-2,0}$ 和 $deCasteljau(n-2,1)$ 用于计算 $P_{n-2,1}$。对 $deCasteljau(n-1,1)$ 的调用也会产生两个新的调用，$deCasteljau(n-2,1)$ 用于计算 $P_{n-2,1}$ 和 $deCasteljau(n-2,2)$ 用于计算 $P_{n-2,2}$。\n\n因此，$deCasteljau(n-2,1)$ 被调用了两次。依次类推，会发现计算 $P_{i,j}$ 的函数被重复调用了，这是对性能非常浪费的。\n\n\n\n### **三角形计算方案：自底向上的计算方法**\n\n以下面在由 8 个控制点 $00, 01, ..., 07$定义的 7 次贝塞尔曲线为例。给定一个在 $[0,1]$ 中的 $u$，我们如何计算这个贝塞尔曲线上对应的点呢？曲线上的点是由选定点形成的等边三角形的底边对面的顶点！\n\n![img](de-cast-observation-crop.jpg)\n\n例如，如果选定的控制点点是 02, 03, 04 和 05，那么对应于 $u$ 的这四个控制点定义的曲线上的点是 32。即蓝色的三角形的顶点。如果选定的控制点是 11, 12 和 13，则曲线上的点是 31。即黄色的三角形的顶点。如果选定的点是 30, 31, 32, 33 和 34，曲线上的点是 70。\n\n反之同理，70 是由控制点 60 和 61 定义的贝塞尔曲线上的点。它也可以是由 50, 51 和 52 控制点定义的曲线上的点，也可以是由 40, 41, 42 和 43 控制点定义的曲线上的点。\n\n如此我们就可以自底向上的计算每一项$P_{i,j}$，以蓝色三角形为例，先计算最左列的$P_{0,2},P_{0,3},P_{0,4},P_{0,5}$，再计算第二列的$P_{1,2},P_{1,3},P_{1,4},P_{0,5}$，再计算第三列的$P_{2,2},P_{2,3}$，再计算最终点$P_{3,2}$，这样可以避免自定向下计算带来的重复项计算的问题。\n\n\n\n## 贝塞尔曲线的导数\n\n### **贝塞尔曲线的导数仍然是贝塞尔曲线**\n\n要在贝塞尔曲线上的某点计算切向量和法向量，首先要计算在该点的一阶和二阶导数。\n\n由 $n + 1$ 个控制点 $P_0, P_1, ..., P_n$ 定义的贝塞尔曲线如下：\n\n$$\\mathbf{C}(u)=\\sum_{i=0}^nB_{n,i}(u)\\mathbf{P}_i$$\n\n其中 $B_{n,i}(u)$ 定义如下：\n\n$$B_{n,i}(u)=\\frac{n!}{i!(n-i)!}u^{i}(1-u)^{n-i}$$\n\n其中控制点$P_{i}$是常数且与变量 $u$ 相互独立，因此，计算贝塞尔曲线的导数 $C'(u)$可以简化为计算 $B_{n,i}(u)$ 的导数。\n\n通过一些代数操作，我们可以得到：\n\n$$\\frac{\\mathrm{d}}{\\mathrm{d}u}B_{n,i}(u)=B_{n,i}^{\\prime}(u)=n(B_{n-1,i-1}(u)-B_{n-1,i}(u))$$\n\n因此曲线的导数 $C'(u)$为：\n\n$$\\frac{\\mathrm{d}}{\\mathrm{d}u}\\mathbf{C}(u)=\\mathbf{C}'(u)=\\sum_{i=0}^{n-1}B_{n-1,i}(u)\\{n(\\mathbf{P}_{i+1}-\\mathbf{P}_i)\\}$$\n\n设 :\n\n$$Q_0 = n(P_1 - P_0)$$ \n$$Q_1 = n(P_2 - P_1)$$ \n$$Q_2 = n(P_3-P_2)$$\n$$Q_{n-1} = n(P_n - P_{n-1})$$\n\n上述方程简化为以下形式：\n\n$$\\mathbf{C}^{\\prime}(u)=\\sum_{i=0}^{n-1}B_{n-1,i}(u)\\mathbf{Q}_{i}$$\n\n**结论：可以看出贝塞尔曲线 的导数$C'(u)$是由 $n$ 个控制点 $n(P_1 - P_0)$, $n(P_2 - P_1)$, $n(P_3 - P_2)$, ..., $n(P_n - P_{n-1})$ 定义的 $n - 1$ 次贝塞尔曲线。**\n\n这个导数曲线通常被称为原贝塞尔曲线的**轨迹图**。\n\n注意，$P_{i+1} - P_i$ 是从 $P_i$ 到 $P_{i+1}$ 的方向向量，而 $n (P_{i+1} - P_i)$ 是该方向向量的 $n$ 倍长。下面左图显示了一个7次贝塞尔曲线，右图显示了其导数，是一个6次贝塞尔曲线。\n\n![img](b-curve-3.jpg)  ![img](b-hodo-3.jpg)\n\n\n\n### **贝塞尔曲线与其第一条和最后一条边相切**\n\n令$u = 0$和$u = 1$，可以得到：\n\n​                    $$C'(0) = n(P_1 - P_0)$$         $$C'(1) = n(P_n - P_{n-1})$$\n\n第一个公式意味着在$u = 0$时的切向量方向是$P_1 - P_0$乘以$n$。因此，指示方向的第一条边与贝塞尔曲线相切。\n第二个公式意味着在$u = 1$时的切向量方向是$P_n - P_{n-1}$乘以$n$。因此，指示方向的最后一条边与贝塞尔曲线相切。下图很好地展示了这个属性。\n\n![img](b-curve-1-17098603594523.jpg)  ![img](b-curve-4.jpg)\n\n\n\n### **用$C^1$连续性连接两个贝塞尔曲线**\n\n利用贝塞尔曲线与其第一条和最后一条边相切的这个特性，可以将两条或更多的贝塞尔曲线连接起来，组合成我们想要的形状。\n\n设第一条曲线$C(u)$由$m + 1$个控制点$P_0, P_1, P_2, ..., P_m$定义，\n设第二条曲线$D(u)$由$n + 1$个控制点$Q_0, Q_1, Q_2, ..., Q_n$定义，\n如果我们想要将这两条贝塞尔曲线连接起来，那么$P_m$必须等于$Q_0$，这保证了$C^0$级连续\n\n第一条曲线与其最后一条边相切，第二条曲线与其第一条边相切。因此，为了实现平滑过渡，$P_{m-1}$，$P_m = Q_0$和$Q_1$四个点必须在同一直线上，使得从$P_{m-1}$到$P_m$的方向与从$Q_0$到$Q_1$的方向相同，如下图所示：\n\n![img](join-rel.jpg)\n\n以这种方式连接两个贝塞尔曲线看起来很平滑，但它仍然是$C^0$连续，而不是$C^1$连续。但是，它满足$G^1$连续（具有相同的切向量方向，但切向量大小不相等）。\n为了保证$C^1$连续性，我们必须确保第一条曲线在$u = 1$处的切向量$C'(1)$，与第二条曲线在$u = 0$处的切向量$D'(0)$，是等的。也就是说，必须满足以下关系：\n\n$$\\mathbf{C}^{\\prime}(1)=m(\\mathbf{P}_m-\\mathbf{P}_{m-1})=\\mathbf{D}^{\\prime}(0)=n(\\mathbf{Q}_1-\\mathbf{Q}_0)$$\n\n这个关系说明要在连接点保证$C^1$连续性，第一条曲线的最后一条边的长度（即$|p_m - p_{m-1}|$）与第二条曲线的第一条边的长度（即$|q_1 - q_0|$）的比例必须是$n/m$。由于度数$m$和$n$是固定的，我们可以调整$p_{m-1}$或$q_1$在同一直线上的位置，使得上述关系得到满足。\n\n![img](b-join-1.jpg) ![img](b-join-2.jpg)\n\n上面左图中为两条贝塞尔曲线连接而成，其中**浅色的折线**定义了一条4次贝塞尔曲线，而**深色的折线**定义了一条5次贝塞尔曲线。\n由于第一条曲线的最后一段和第二条曲线的第一段不在同一直线上，所以这两条曲线并未平滑相接。\n上面右图展示了在连接点处与一条直线相切的两条贝塞尔曲线。然而，它们并不是$C^1$连续的。左边的曲线是4次的，而右边的曲线是7次的。\n但是，左曲线的最后一段与第二条曲线的第一段的比例看起来接近1，它们是$G^1$连续的而不是$C^1$连续的。为了实现$C^1$连续性，我们应该增加左曲线的最后段的长度（或者减少右曲线的第一段的长度），使其比例接近$7/4=1.75$，从而满足$C^1$连续\n\n\n\n### 构造闭合的贝塞尔曲线\n\n利用上面的这种切线性质，如果让第一个和最后一个控制点相同（即$P_0 = P_n$）并且$P_1, P_0$和$P_{n-1}$共线，那么生成的贝塞尔曲线将是一个封闭曲线，并且在连接点处是$G^1$连续的。\n\n如果要在$P_0$处达到$C^1$连续性，必须使 $P_1-P_0=P_n-P_{n-1}$（即曲线的第一段和最后一段有相同的长度并且$P_1, P_0 = P_n, P_{n-1}$共线）\n\n![img](b-close-1.jpg)\n\n\n\n### **导数与de Casteljau算法之间的关系**\n\n重新改写一下贝塞尔曲线的导数形式：\n\n$$\\begin{aligned}\n\\mathrm{C}^{\\prime}(u)&=\\sum_{i=0}^{n-1}B_{n-1,i}(u)\\{n(\\mathbf{P}_{i+1}-\\mathbf{P}_i)\\}  \\\\\n&=n\\left[\\left(\\sum_{i=0}^{n-1}B_{n,i}(u)\\mathbf{P}_{i+1}\\right)-\\left(\\sum_{i=0}^{n-1}B_{n,i}(u)\\mathbf{P}_{i}\\right)\\right]\n\\end{aligned}$$\n\n贝塞尔曲线的导数可以看作是两条$n-1$次贝塞尔曲线的差\n现在让这两条曲线分别为$C_1(u)$和$C_2(u)$：\n\n$$\\quad{C}_1(u)=\\sum\\limits_{i=0}^{n-1}B_{n,i}(u)\\mathbf{P}_{i+1}\\newline{C}_2(u)=\\sum\\limits_{i=0}^{n-1}B_{n,i}(u)\\mathbf{P}_i$$\n\n根据上面定义，可以知道第一条曲线$C_1(u)$由控制点$P_1, P_2, ..., P_n$定义，第二条曲线$C_2(u)$由控制点$P_0, P_1, ..., P_{n-1}$定义，因此，原曲线的导数定义为：\n\n$$\\mathbf{C}^{\\prime}(u)=n(\\mathbf{C}_1(u)-\\mathbf{C}_2(u))$$\n\n为了计算贝塞尔曲线的导数$C'(u)$，可以先使用de Casteljau算法计算$C_1(u)$和$C_2(u)$的值，然后，再计算它们的差，乘以n就得到了$C'(u)$。\n\n**计算$C_1(u)$和$C_2(u)$：**\n\n如下图，最左侧的列有所有给定的控制点，点$n0$代表原始贝塞尔曲线上的点$C(u)$，点$(n-1)0$和$(n-1)1$连成的线段是用来插值获取点$n0$的控制折线，即点$n0$位于$(n-1)0$和$(n-1)1$的线段上，并以$u:1-u$的比例将其分割。\n\n![img](b-tangent.jpg)\n\n由于曲线$C_1(u)$由控制点$01, 02, ..., 0n$定义，因此点$(n-1)1$是曲线$C_1(u)$上的点。同样地，由于$C_2(u)$由控制点$00, 01, ..., 0(n-1)$定义，因此点$(n-1)0$是曲线$C_2(u)$上的点，向量$C_1(u) - C_2(u)$表示从点 $(n-1)0$ 到点 $(n-1)1$ 的向量，而原贝塞尔曲线的导数$C'(u)$的是$n$倍的$C_1(u) - C_2(u)$。\n\n这说明，从 $(n-1)0$ 到 $(n-1)1$ 的线段与$C(u)$处的切线向量方向相同，它在$C(u)$处与曲线相切！\n\n**结论：de Casteljau算法迭代中的最后一条折线，实际上是一条线段，在$C(u)$处与贝塞尔曲线相切。**\n\n下图是一个例子，所示的点为$u = 0.5$处。显然，de Casteljau迭代过程中的最后一条折线段在$C(0.5)$处与曲线相切。\n\n![img](b-tangent-curve.jpg)\n\n\n\n### **计算贝塞尔的高阶导数**\n\n$C(u)$的一阶导数如下：\n\n$$\\mathbf{C}^{\\prime}(u)=\\sum_{i=0}^{n-1}B_{n-1,i}(u)\\mathbf{Q}_i$$\n\n将导数公式应用于上述贝塞尔曲线，得到以下结果，给出了原始贝塞尔曲线的二阶导数：\n\n$$\\begin{aligned}\n\\mathbf{C}^{\\prime\\prime}&=\\sum_{i=0}^{n-2}B_{n-2,i}(u)\\{(n-1)(\\mathbf{Q}_{i+1}-\\mathbf{Q}_i)\\}\\\\\n&=\\sum_{i=0}^{n-2}B_{n-2,i}(u)\\{n(n-1)(\\mathbf{P}_{i+2}-2\\mathbf{P}_{i+1}+\\mathbf{P}_i)\\}\n\\end{aligned}$$\n\n为了简洁地表达高阶导数，可以使用有限差分的方式。定义$D_{i}^0$为控制点$P_i$本身，其中$0 \\leq i \\leq n$。定义第一层差分$D_{i}^1$为前一层的差分，如下：\n\n$$\\begin{aligned}\n\\mathbf{D}_{0}^{1}&=\\text{ D}_1^0-\\mathbf{D}_0^0=\\mathbf{P}_1-\\mathbf{P}_0  \\\\\n\\mathrm{D}_{1}^{1}&=\\text{ D}_2^0-\\mathbf{D}_1^0=\\mathbf{P}_2-\\mathbf{P}_1  \\\\\n&\\vdots \\\\\n\\mathbf{D}_{n-2}^{1}&=\\text{ D}_{n-1}^0-\\mathbf{D}_{n-2}^0=\\mathbf{P}_{n-1}-\\mathbf{P}_{n-2}  \\\\\n\\mathbf{D}_{n-1}^{1}&=\\text{ D}_n^0-\\mathbf{D}_{n-1}^0=\\mathbf{P}_n-\\mathbf{P}_{n-1} \n\\end{aligned}$$\n\n第一层差分只有$n$个点，比给定的控制点少一个，简写一下，第一层的差分如下所示：\n\n$$\\mathbf{D}_i^1=\\mathbf{D}_{i+1}^0-\\mathbf{D}_i^0\\quad0\\leq i\\leq n-1$$\n\n第二层差分被定义为第一层点的差分：\n\n$$\\mathbf{D}_i^2=\\mathbf{D}_{i+1}^1-\\mathbf{D}_i^1\\quad0\\le i\\le n-2$$\n\n这个第二层差分有$n-1$个点。重复这个过程，我们可以定义第$k$层差分如下。第$k$层差分有$n-k+1$个点。\n\n$$\\mathrm D_i^k=\\mathrm D_{i+1}^{k-1}-\\mathrm D_i^{k-1}\\quad0\\leq i\\leq n-k$$\n\n有了这些定义，可以简洁地表达更高阶的导数。首先，让我们使用$D_{i}^1$重新写下$C'(u)$：\n\n$$\\begin{aligned}\n\\mathbf{C}^{\\prime}(u)&=n\\sum_{i=0}^{n-1}B_{n-1,i}(u)(\\mathbf{P}_{i+1}-\\mathbf{P}_{i})  \\\\\n&=n\\sum_{i=0}^{n-1}B_{n-1,i}(u)(\\mathbf{D}_{i+1}^0-\\mathbf{D}_i^0) \\\\\n&=n\\sum_{i=0}^{n-1}B_{n-1,i}(u)\\mathbf{D}_i^1\n\\end{aligned}$$\n\n将导数应用于$C'(u)$来计算$C''(u)$，得到了一个使用$D_{i}^2$表示$C''(u)$的公式：\n\n$$\\begin{aligned}\n\\mathbf{C}''(u)&=n(n-1)\\sum_{i=0}^{n-2}B_{n-2,i}(u)(\\mathbf{D}_{i+1}^1-\\mathbf{D}_i^1)\\\\\n&=n(n-1)\\sum_{i=0}^{n-2}B_{n-2,i}(u)\\mathbf{D}_i^2\n\\end{aligned}$$\n\n对$C''(u)$做同样的处理，我们得到了一个使用$D_{i}^3$表示$C'''(u)$的公式：\n\n$$\\begin{aligned}\n\\mathbf{C}^{\\prime\\prime\\prime}(u)&=n(n-1)(n-2)\\sum_{i=0}^{n-3}B_{n-3,i}(u)(\\mathbf{D}_{i+1}^2-\\mathbf{D}_i^2)\\\\\n&=n(n-1)(n-2)\\sum_{i=0}^{n-3}B_{n-3,i}(u)\\mathbf{D}_i^3\n\\end{aligned}$$\n\n继续这个过程，我们可以计算出第$k$阶导数$C^{(k)}(u)$使用$D_{i}^k$的表示形式：\n\n$$\\begin{aligned}\n\\mathbf{C}^{[k]}(u)&=n(n-1)(n-2)\\cdots(n-k+1)\\sum_{i=0}^{n-k}B_{n-k,i}(u)(\\mathbf{D}_{i+1}^{k-1}-\\mathbf{D}_{i}^{k-1})\\\\\n&=n(n-1)(n-2)\\cdots(n-k+1)\\sum_{i=0}^{n-k}B_{n-k,i}(u)\\mathbf{D}_{i}^{k}\n\\end{aligned}$$\n\n因此，要在特定的$u$处计算$C(u)$的第$k$阶导数，我们首先计算$D_{i}^k$的值，然后应用de Casteljau算法计算由$D_{i}^k$定义的贝塞尔曲线上对应于$u$的点。\n\n如下图所示，我们已有第0列所有$D_{i}^0$的值（即控制点本身），然后使用两两差分来计算第1列的$D_{i}^1$的值。重复这个过程直到我们达到如下所示的第$k$列：\n\n![img](b-high-der-diagram.jpg)\n\n\n\n最后，使用de Casteljau算法计算出第$k$列点的$B_{n-k,i}(u)$的值，与$D_{i}^k$相乘后累加，再将结果乘以$n(n-1)(n-2)...(n-k+1)$，就得到了$C^{(k)}(u)$的值！\n\n\n\n## 贝塞尔曲线的拆分\n\n**曲线拆分**的过程是将一个贝塞尔曲线在特定点$C(u)$处一分为二，每一部分仍然是贝塞尔曲线。分割后的每段曲线都需要一套新的控制点来描述其形状，原有的控制点将不再适用。此外，由于原始贝塞尔曲线的阶次是$n$，被切割成两部分后，每个部分都是原贝塞尔曲线的子集，因此得到的新贝塞尔曲线的阶次也必须是$n$。\n\n假设我们$n + 1$个控制点$P_0, P_1, P_2, ..., P_n$，参数 $0\\leq u\\leq1$，目标是找到两组新的$n+1$个控制点$Q_0, Q_1, Q_2, ..., Q_n$和$R_0, R_1, R_2, ..., R_n$。\n\n这两组控制点各自定义的贝塞尔曲线分别对应原始曲线在$[0,u]$和$[u,1]$区间的部分。\n\n虽然正确性证明有点繁琐，但实际上算法非常简单。事实上，de Casteljau 的算法用于计算曲线上点 $C(u)$ 时已经提供了所有必要的信息。在下面的左图中，展示了用 de Casteljau 算法计算 $C(u)$ 的所有中间步骤，右图显示了在点 $C(u)$ 处曲线拆分后的形状及相应的控制折线。\n\n![img](b-sub-master.jpg) ![img](b-sub-result.jpg)\n\n仔细比较这两幅图，左图中，**左半段**贝塞尔曲线的控制点由$P_{00}=P_0, P_{10},P_{20},P_{30},P_{40},P_{50}$和$P_{60} = C(u)$组成\n**右半段**贝塞尔曲线的控制点由点$P_{60}=C(u),P_{51},P_{42},P_{33},P_{24},P_{15}$和$P_{06} = P_6$组成。\n下图展示了这些点：\n\n![img](b-sub-left.jpg)![img](b-sub-right.jpg)\n\n回想一下de Casteljau算法的三角形计算方案：对于给定的$u$，计算$C(u)$需要$n$次迭代，在计算过程中，可以收集每列的第一个点和最后一个点，并且最终，第一个点（或最后一个点）的集合对应于原始曲线在$[0,u]$（或$[u,1]$）上定义的片段。\n\n因此，在下面的三角形方案中，箭头指向的顶边(红色：$00,10,20,30,40,50,60$)和箭头相反方向的底边(蓝色：$60,51,42,33,24,15,06$)分别对应位第一段曲线和第二段曲线段的控制点。有了控制点，也就可以得出拆分后的两段贝塞尔曲线（可以重新计算获得）\n\n![img](b-sub-chart.jpg)\n\n注意：点$50$和$51$定义的线段在点$60$处与曲线相切（见上图），即左曲线的最后一段（即线段$50-60$）与左曲线相切，右曲线的第一段（即线段$60-51$）与右曲线相切。\n\n**曲线拆分为何至关重要？**\n曲线拆分的应用范围广泛。例如，它可以被用来找出两个贝塞尔曲线的交汇点、对贝塞尔曲线进行渲染，以及简化曲线设计过程。设想我们设计了一条曲线，却发现它并不完全符合我们的预期。在这种情形下，我们可能会考虑在某些特定的点上将曲线分割为两个部分：一个部分达到了我们的满意度，而另一部分则没有。接下来，我们可以忽略掉那部分我们已经满意的，将注意力集中在仍需改进的部分上。\n\n\n\n## 贝塞尔曲线的升阶\n\n不改变贝塞尔曲线的形状，同时增加贝塞尔曲线的度数（即阶数/次数），称为**贝塞尔曲线的升阶**。\n\n假设我们有一个由 $n+1$个控制点$P_0, P_1, P_2, ..., P_n$定义的$n$阶贝塞尔曲线，我们希望将这个曲线的度数提升到$n + 1$而不改变其形状。由于$n + 1$阶贝塞尔曲线需要由$n + 2$个控制点定义，因此，我们需要找到一个新的控制点集，显然，$P_0$ 和 $P_n$ 必须在新控制点集中，因为贝塞尔曲线会通过首尾控制点，曲线升阶不改变曲线的形状。因此，我们需要$n$个新的控制点，假设新的控制点集为 $Q_0, Q_1, Q_2, ..., Q_{n+1}$，根据上述要求有，$Q_0 = P_0$ 和 $Q_{n+1} = P_n$。其他控制点的计算方式如下：\n\n$$\\mathbf{Q}_i=\\frac{i}{n+1}\\mathbf{P}_{i-1}+\\left(1-\\frac{i}{n+1}\\right)\\mathbf{P}_i\\quad1\\le i\\le n$$\n\n以下是从$Q_1$到$Q_n$每个控制点的公式：\n\n$$\\begin{aligned}\n\\mathbf{Q}_1&=\\frac{1}{n+1}\\mathbf{P}_0+\\left(1-\\frac{1}{n+1}\\right)\\mathbf{P}_1\\\\\n\\mathbf{Q}_2&=\\frac{2}{n+1}\\mathbf{P}_1+\\left(1-\\frac{2}{n+1}\\right)\\mathbf{P}_2\\\\\n\\mathbf{Q}_3&=\\frac{3}{n+1}\\mathbf{P}_2+\\left(1-\\frac{3}{n+1}\\right)\\mathbf{P}_3\\\\\n&\\vdots\\\\\n\\mathbf{Q}_{n-1}&=\\frac{n-1}{n+1}\\mathbf{P}_{n-2}+\\left(1-\\frac{n-1}{n+1}\\right)\\mathbf{P}_{n-1}\\\\\n\\mathbf{Q}_n&=\\frac{n}{n+1}\\mathbf{P}_{n-1}+\\left(1-\\frac{n}{n+1}\\right)\\mathbf{P}_n\n\\end{aligned}$$\n\n原始多段线的每一段上正好会有一个新的控制点。即：线段$P_{i-1}P_i$ 包含新控制点$Q_i$。\n\n在de Casteljau算法中，线段$AB$上一点$C$，将$AB$按比例 $u:1-u$ 分割，可以写作 $C = (1 - u)A + uB$。在上式中，$Q_i$将线段$P_{i-1}P_i$  按比例 $1-\\frac{i}{n+1}:\\frac{i}{n+1}$ 分割。这个比例不是一个常数，而是随着 i 的值变化的，但与de Casteljau算法很相似\n\n获得了新的控制点集后，原控制点集就可以弃用。由于原始控制多段线的每一段都包含一个新控制点，用新控制点集合替换旧控制点集合的过程可以看作是在原始控制点处切掉角。\n\n见下图，图中显示了一个4度贝塞尔曲线，控制点以红色矩形显示，控制多段线以虚线显示。将其度数增加到5后，新的控制多段线以实线段显示。显然，所有角都被切掉了。下表给出了原始控制多段线上每一段的比例。\n\n| i    | 1 - i/(n+1) | i/(n+1) |\n| ---- | ----------- | ------- |\n| 1    | 0.8         | 0.2     |\n| 2    | 0.6         | 0.4     |\n| 3    | 0.4         | 0.6     |\n| 4    | 0.2         | 0.8     |\n\n![img](bezier-cut-corner.jpg)\n\n随着曲线度数的增加，控制点的数量也会增加。并且，新的控制多边形会逐渐向曲线靠拢。在下面的图形中，我们从一个度数为6、控制点为7个的贝塞尔曲线开始，然后，其度数增加到7、8、10、15和29。从图中可以看出，随着度数的增加，曲线的形状没有改变，控制多边形越来越接近曲线。最终，随着度数不断增加到无限，控制多边形将趋向于曲线，曲线则相当于控制多边形的一个极限位置。\n\n![img](b-elev-06.jpg)![img](b-elev-07.jpg)![img](b-elev-08.jpg)![img](b-elev-10.jpg)![img](b-elev-15.jpg)![img](b-elev-29.jpg)\n\n\n\n## 总结\n\n总的来说，要定义一个$n$阶的贝塞尔曲线，我们需要在空间中选择$n+1$个控制点，这些点大致描述了所需曲线的形状。\n\n然后，如果它不符合我们的期望，我们可以移动控制点。随着一个或多个控制点的移动，贝塞尔曲线的形状相应地发生变化。但是，曲线始终位于由控制点定义的凸包内（**凸包性质**），并且生成的曲线形状比控制多边形简单（**变差减少性质**）。\n\n除此之外，贝塞尔曲线还具有**非负性**、**单位分割**、**仿射不变性**、**递归性**等性质。贝塞尔曲线不具备**局部修改性**，移动控制点将会全面改变贝塞尔曲线的形状，这也是其逐渐被**样条曲线**和**Nurbs曲线**取代的原因。\n\n详细介绍了**De Casteljau算法**，用于计算任意参数位置时，对应的贝塞尔曲线上一点，这是一种**自底向上**的**三角形计算方案**，能够避免**自顶向下**计算方案递归调用时带来的不必要的性能开销。\n\n还介绍了**贝塞尔曲线导数**的性质，如何将两个**贝塞尔曲线连接***在一起并保证连接点处$C^1$连续，如何构造**闭合的贝塞尔曲线**以及计算**高阶贝塞尔导数**。\n\n最后还介绍了贝塞尔曲线的**拆分**和**升阶**方法，这个早期在工程中也是具有很大的应用。\n\n\n\n## 文献引用\n\n- Gerald Farin, *Curves and Surfaces for CAGD: A Practical Guide*, fourth edition, Academic Press, 1997.\n- Josef Hoschek and Dieter Lasser, *Fundamentals of Computer Aided Geometric Design*, translated from the German 1989 edition by Larry L. Schumaker, A K Peters, 1993.\n- Les Piegl and Wayne Tiller, *The NURBS Book*, second edition, Springer-Verlag, 1997.\n- David F. Rogers and J. Alan Adams, *Mathematical Elements for Computer Graphics*, second edition, McGraw-Hill, 1990.\n\n---\n\n后续，将会继续介绍**B样条曲线**和**Nurbs曲线**，这两种类型的曲线会逐渐取代贝塞尔成为工程中的主流曲线定义方式。**To be continued....**","source":"_posts/贝塞尔曲线.md","raw":"---\nlayout: post\ntitle: 贝塞尔曲线\ndate: 2025-11-10 22:43:17\ntags:\n---\n\n\n# Bezier曲线\n\n贝塞尔曲线于 1962 年，由法国工程师皮埃尔·贝济埃（Pierre Bézier）所广泛发表，他运用贝塞尔曲线来为汽车的主体进行设计,贝塞尔曲线最初由保尔·德·卡斯特里奥于1959年运用德卡斯特里奥算法开发，以稳定数值的方法求出贝塞尔曲线.\n\n**先从几个简单的例子开始：**\n\n## 一阶贝塞尔曲线\n\n<img src=\"v2-770487eacf3b9d5973e2783b6d8698e5_r.jpg\" alt=\"img\" style=\"zoom: 33%;\" />\n\n对于一阶贝塞尔曲线为我们可以看到是一条直线，通过几何知识，很容易根据t的值得出线段上那个点的坐标。\n\n给定点 $P_0$、$P_1$，线性贝塞尔曲线只是一条两点之间的直线。这条线由下式给出：\n\n$$\\mathbf{B}(t)=\\mathbf{P}_0+(\\mathbf{P}_1-\\mathbf{P}_0)t=(1-t)\\mathbf{P}_0+t\\mathbf{P}_1,t\\in[0,1]$$\n\n一阶曲线就是很好理解, 就是根据t来的线性插值。$P_0$表示的是一个向量 $[x ,y]$, 其中$x$和$y$是分别按照这个公式来计算的。\n\n## 二阶贝塞尔曲线\n\n<img src=\"image-20230715134335693.png\" alt=\"image-20230715134335693\" style=\"zoom: 50%;\" />\n\n<img src=\"image-20230715134422584.png\" alt=\"image-20230715134422584\" style=\"zoom: 50%;\" />\n\n在平面内任选 3 个不共线的点，依次用线段连接。在第一条线段上任选一个点 $D$。计算该点到线段起点的距离$AD$，与该线段总长$AB$的比例。\n\n<img src=\"image-20230715134508818.png\" alt=\"image-20230715134508818\" style=\"zoom: 50%;\" />\n\n根据上一步得到的比例，从第二条线段上找出对应的点 $E$，使得 $AD:AB = BE:BC$\n\n<img src=\"image-20230715134543049.png\" alt=\"image-20230715134543049\" style=\"zoom:50%;\" />\n\n<img src=\"image-20230715134555599.png\" alt=\"image-20230715134555599\" style=\"zoom:50%;\" />\n\n这时候$DE$又是一条直线了, 就可以按照一阶的贝塞尔方程来进行线性插值了：\n\n$$t= AD:AE$$\n\n这时候就可以推出公式了：\n\n![img](Bézier_2_big.gif)\n\n$$P_0=(1-t)P_0+tP_1$$\n\n$$P_1=(1-t)P_1+tP_2$$\n\n整理一下公式, 得到二阶贝塞尔公式：\n\n$$\\mathbf{B}(t) =(1-t)^{2}\\mathbf{P}_{0}+2t(1-t)\\mathbf{P}_{1}+t^{2}\\mathbf{P}_{2},t\\in[0,1]$$\n\n\n\n## 三阶贝塞尔曲线\n\n<img src=\"image-20230715135427376.png\" alt=\"image-20230715135427376\" style=\"zoom:50%;\" />\n\n四个点对应是三次的贝塞尔曲线. 分别在 $AB$、$BC$、$CD$ 之间采$EFG$点, $EFG$三个点对应着二阶贝塞尔, 在$EF$、$FG$之间采集$H$、$I$点来降阶为一阶贝塞尔曲线.\n\n公式：\n\n$$\\mathbf{B}(t)=\\mathbf{P}_0(1-t)^3+3\\mathbf{P}_1t(1-t)^2+3\\mathbf{P}_2t^2(1-t)+\\mathbf{P}_3t^3,t\\in[0,1]_0$$\n\n动画效果\n\n![img](Bézier_3_big-168860760518218.gif)\n\n\n\n## 贝塞尔曲线公式\n\n贝塞尔曲线是通过空间中的$n+1$个点$P_0, P_1, P_2, \\ldots, P_n$来定义的，这些点称为控制点。控制点决定了曲线的形状，贝塞尔曲线定义如下：\n\n$$\\mathbf{C}(u)=\\sum_{i=0}^nB_{n,i}(u)\\mathbf{P}_i$$\n\n其中系数定义如下：\n\n$$B_{n,i}(u)=\\frac{n!}{i!(n-i)!}u^{i}(1-u)^{n-i}$$\n\n贝塞尔曲线上对应于参数位置为$u$的点，是所有控制点的\"加权\"平均值，其中权重是系数$B_{n,i}(u)$，其中$u$的定义域为$[0,1]$。函数$B_{n,i}(u), 0 \\leq i \\leq n$被称为**贝塞尔基函数**或**伯恩斯坦多项式**。\n\n将控制点点$P_0P_1, P_2, \\ldots, P_n$按此顺序连接，我们得到了一个**控制多边形**，它帮助我们描述了曲线的大致形状。\n\n下图展示了由11个控制点定义的贝塞尔曲线，其中蓝色点是对应于$u=0.4$的曲线上的点。如图所示，曲线或多或少地跟随着多边形线。\n\n![img](b-curve-1-17103242022572.jpg)\n\n\n\n****\n\n**问题：当$u$的定义域非[0,1]时如何处理？**\n\n贝塞尔曲线不总是定义在$[0,1]$这一标准区间上，有时其定义域可能为$[a,b]$。在这种情况下，就需要进行变量的转换。我们需要做的是，将$u$从区间$[a,b]$映射到$[0,1]$，然后在基函数中使用转换后的$u$值。具体的转换方法如下：\n\n$$u'=\\frac{u-a}{b-a}$$\n\n将转换后的$u'$代入到基函数$B_{n,i}(u)$中，可以得到新的公式：\n\n$$B_{n,i}(u')=\\frac{n!}{i!(n-i)!}\\left(\\frac{u-a}{b-a}\\right)^i\\left(1-\\frac{u-a}{b-a}\\right)^{n-i}$$\n\n这一变换后的基函数定义了在区间$[a,b]$上的贝塞尔曲线\n\n\n\n## 贝塞尔曲线的特点和性质\n\n- **贝塞尔曲线由$n+1$个控制点定义，曲线的度数是$n$**：\n  在每个基函数中，$u$的指数是$i + (n - i) = n$。因此，曲线的度数是$n$\n\n- 曲线$C(u)$通过第一个控制点$P_0$和最后一个控制点$P_n$\n\n- **非负性**：所有基函数都是非负的。\n\n- **单位分割**：在任一特定的$u$值下，这些基函数值的总和为1。这保证了曲线上的任一点都是控制点加权平均的结果，且权重总和为1\n\n  \n\n  ![img](b-curve-2-17091716014474-17103791115213.jpg)![img](b-pou-1-17091716014476.jpg)\n\n  \n\n  在上面的左侧图片中，展示了一个基于五个控制点构成的贝塞尔曲线。而右侧的图则展示了作为$u$值函数的五个基函数。\n\n  这些图表揭示了当$u=0.5$时，这五个基函数的分布情况。图中最右侧的竖条图清晰地展现了如何将数值1等分为五部分，这就是所谓的**单位分割**。\n\n  所有基函数的取值范围从0到1，它们的总和恰好为1，因此，这些基函数在计算加权平均时充当了权重的角色。更简单地说，计算**C**($u$)时，实际上是将控制点$P_i$按照$B_{n,i}(u)$的权重进行加权汇总。\n\n  \n\n- **凸包性质**\n\n  贝塞尔曲线的一个显著特点是，它完全被其$n + 1$个控制点所形成的凸包所包围。所谓凸包，指的是能够包含一组点集所有点的最小凸形状。\n\n  在下面的示例中，11个控制点形成的凸包以灰色表示。值得注意的是，并不是所有控制点都位于凸包的边缘。比如，控制点3、4、5、6、8和9位于凸包内部。除了起点和终点，曲线始终位于这个凸包之内。\n\n  ![img](b-curve-1-17103234093711.jpg)\n\n- **变差减少性**\n\n  在平面上，这个性质意味着没有任何直线能与贝塞尔曲线相交的次数超过它与曲线的控制多边形相交的次数。\n\n  ![img](b-variation-17103792438184.jpg)\n\n  如上图所示，黄色直线与曲线相交3次，但与控制多边形相交了7次；\n  红色直线与曲线相交5次，与控制多边形也相交7次；\n  而青色直线与曲线及其控制多边形都只相交两次。\n  你可以尝试绘制其他直线以验证这一性质。\n\n  若曲线是空间中的曲线，则只需将“直线”改为“平面”。\n\n  这一性质的意义何在？它告诉我们，与控制多边形相比，贝塞尔曲线的复杂性（即转弯和扭曲的程度）会更低。换言之，控制多边形相较于它所定义的贝塞尔曲线，会有更频繁的转弯和扭曲，因为任意直线与控制多边形相交的次数总是多于与曲线相交的次数。\n\n- **仿射不变性**\n\n  对贝塞尔曲线进行仿射变换时，其变换结果能够通过控制点经过相同变换后的新位置来确定。这一特性极为有利。当我们需要对贝塞尔曲线执行几何或仿射变换操作时，直接对控制点施加变换即可。完成控制点的变换后，由这些调整后的控制点所定义的新贝塞尔曲线即为所求。因此，无需直接对曲线本身进行变换处理。\n\n- **递归性**\n\n  递归性指其系数满足下式：\n  $$B_{i,n}(t)=(1-t)B_{i,n-1}(t)+tB_{i-1,n-1}(t)【i=0,1,\\cdots,n】$$\n\n- **一阶导数性质**\n\n  <img src=\"image-20230715142535462.png\" alt=\"image-20230715142535462\" style=\"zoom:50%;\" />\n\n  假设上图中贝塞尔的 $t$ 是由左到右从 $0$ 到 $1$ 增加的，那么贝塞尔曲线在 $t=0$ 时的导数是和 $P_0P_1$的斜率（导数）是相同，$t=1$ 时的导数是和$P_3P_4$ 的斜率（导数）是相同的\n\n  <img src=\"image-20230715142627416.png\" alt=\"image-20230715142627416\" style=\"zoom:50%;\" />\n\n  这一点的性质可以用在贝塞尔曲线的拼接，只要保证三点一线中的中间点是两段贝塞尔曲线的连接点，就可以保证两端贝塞尔曲线的导数连续\n\n\n\n## 控制点的移动对曲线的影响\n\n当我们调整一个贝塞尔曲线的控制点位置时，曲线形状将发生变化。这引出一个问题：\n\t\t\t\t\t**控制点移动到新的位置时，贝塞尔曲线将如何变形？**\n\n假设控制点 $P_k$ 移动到 $P_k+\\mathbf{v}$ 的新位置，向量 $\\mathbf{v}$ 表示移动的方向和距离。如图所示：\n\n![img](bezier-P+v.jpg)\n\n原始贝塞尔曲线表示为： $$\\mathbf{C}(u)=\\sum_{i=0}^nB_{n,i}(u)\\mathbf{P}_i$$\n\n由于新的贝塞尔曲线是由 $P_0, P_1, ..., P_k+\\mathbf{v}, ..., P_n$定义的，新的贝塞尔曲线方程 $D(u)$ 可以写成：\n\n$$\\begin{aligned}\n\\mathbf{D}(u)&=\\sum_{i=0}^{k-1}B_{n,i}(u)\\mathbf{P}_{i}+B_{n,k}(u)(\\mathbf{P}_{k}+\\mathbf{v})+\\sum_{i=k+1}^{n}B_{n,i}(u)\\mathbf{P}_{i}  \\\\\n&=\\sum_{i=0}^{n}B_{n,i}(u)\\mathbf{P}_{i}+B_{n,k}(u)\\mathbf{v} \\\\\n&=\\mathbf{C}(u)+B_{n,k}(u)\\mathbf{v}\n\\end{aligned}$$\n\n在上式中，因为只有第 $k$ 项控制点使用了 $P_k+\\mathbf{v}$，所以我们得出新曲线是原始曲线与额外的项 $B_{n,k}(u)\\mathbf{v}$ 的组合。\n\n因此，新曲线上任一给定 $u$ 对应的点，可以通过将原始曲线上相同位置的点沿向量  $\\mathbf{v}$ 的方向平移 $|B_{n,k}(u)\\mathbf{v}|$ 的距离来获得。\n\n更具体地来说，对于任意给定的 *u* 值，原曲线上对应的点为 $C(u)$，新曲线上对应的点为 $D(u)$，且 $D(u) = C(u) + B_{n,k}(u)\\mathbf{v}$。\n\n以下图说明这一变化：\n                                           ![img](bezier-move-ct-pt-1.jpg)\n\n图中，黑色与红色曲线分别代表由9个控制点定义的同一8次贝塞尔曲线的原始和变形状态。黑色曲线为原始状态。若其中一个控制点沿蓝色向量移动到新位置，黑色曲线便转变为红色曲线。\n\n图中同时标出了$u=0.5$时两条曲线上的对应点。可以明显看出，$C(0.5)$ 沿相同方向移动至 $D(0.5)$。从 $C(0.5)$ 到 $D(0.5)$ 的距离等同于向量 \n\n​\t\t\t\t\t\t$$B_{8,3}(0.5)\\mathbf{v} = \\frac{8!}{(3!(8-3)!)}×0.5^3(1-0.5)^{8-3}\\mathbf{v} = 0.22\\mathbf{v}$$\n\n因此，**该距离约为原始控制点3和下图所示的新控制点3之间距离的22%**\n\n从这一分析中，我们可以得出另一个重要的结论：\n因为 $B_{n,k}(u)$ 在开区间 $(0,1)$ 内非零，因此 $B_{n,k}(u)\\mathbf{v}$ 在此区间内不是零向量。这意味着除了端点 $C(0)$ 和 $C(1)$ 外，所有原始曲线上的点都会被移动到新的位置上。由此可见：\n\n​\t\t\t\t\t**移动控制点将会全面改变贝塞尔曲线的形状。**\n\n\n\n## 计算贝塞尔曲线上一点：De Casteljau 算法\n\n**在构造 Bézier 曲线后，如何找到曲线上参数为 $u$ 处的点 $C(u)$？**\n\n一种简单的方法是将 $u$ 代入贝塞尔曲线的公式：\n\n$$\\mathbf{C}(u)=\\sum_{i=0}^nB_{n,i}(u)\\mathbf{P}_i$$\n\n其中系数定义如下：\n\n$$B_{n,i}(u)=\\frac{n!}{i!(n-i)!}u^{i}(1-u)^{n-i}$$\n\n计算每个基函数的值，并计算每个基函数及其对应控制点的乘积，最后将它们相加。虽然这样可以，但不是**数值稳定**的（即在计算伯恩斯坦多项式的过程中可能引入数值误差）。\n\n还记得本文开始几个小节关于一阶、二阶、三阶贝塞尔曲线的推导过程吗，这就是**De Casteljau 算法**：\n\n首先，我们以编号的形式记录下控制点，如 $P_0$ 记作 $00$，$P_1$ 记作 $01$，依此类推，直至 $P_n$ 的编号为 $0n$。第一个数字 $0$ 表示第0阶或第一次迭代。在接下来的迭代中，这些数字会变成$1、2、3$ 等。\n\n**De Casteljau 算法的核心在于找到线段 AB 上某个点 $C$，该点按 $u:1-u$ 的比例将线段 $AB$ 划分。从而确立点 $C$ 的具体位置。**\n\n![img](point-c.jpg)\n\n线段$AB$ 的向量可以表示为 $B - A$。由于 $u$ 是介于 $0$ 和$1$ 之间的比例，所以点 $C$ 的位置可以用 $u(B - A)$ 来描述。再加上 $A$ 点的坐标，我们可以得到 $C$ 的准确位置为 \n\n$$A + u(B - A) = (1 - u)A + uB$$\n\n因此，对于任何给定的 $u$ 值， 我们都能准确地定位在 $A$ 与 $B$ 之间的一点 $C$。\n\n**如何找到贝塞尔曲线上任意一处参数 $u$ 的点 $C(u)$：**\n\n首先将控制点依次连接，得到一个折线：即 $00-01-02-03...-0n$ 多段线，然后根据上述公式在每对相邻控制点之间找到新点 $1i$，这个新点将原线段 $0i-0(i+1)$ 按 $u:1-u$ 的比例分割。通过这种方式，我们可以得到 $n$ 个新点：$10, 11, 12, ..., 1(n-1)$，它们共同构成了一条新的折线。\n\n![img](de-casteljau.jpg)\n\n如上图所示，例如，当 $u = 0.4$ 时，通过插值可以得到点$10$位于起始控制点$00$和$01$之间， 其中$\\frac{00-10}{10-01}=\\frac{u}{1-u}$ 。($00$即点$0$，$00$中的第一个$0$表示$0$阶，第二个$0$表示第$0$个点。$01$即点$1$，$01$中的第一个$0$表示$0$阶，第二个$1$表示第$1$个点） \n\n第二次迭代：点$11$位于点$01$和$02$之间，$\\frac{01-11}{11-02}=\\frac{u}{1-u}$以此类推，可以计算出点$12、13、14$。这些新产生的点都以蓝色标记。\n\n每一次迭代，我们获得的\"新控制点\"的数量都比之前迭代的结果少1，直到最减少到唯一的点$n0$。这一点就是在给定 $u$ 值下，贝塞尔曲线上的对应点 $C(u)$。\n\n举例：在上图中，\n点$20$可以通过以 $u:1-u$ 的比例划分线段$10-11$得到，。\n点$21$通过边$11-12$划分得到\n点$22$通过边$12-13$划分得到\n点$23$通过边$13-14$划分得到。\n从而得到了由点$20,21,22,23$定义的三阶折线。\n在折线段$20-21-22-23$的两两点之间进行插值，将得到个新的折线段$30-31-32$。继续迭代，将得到点$40$和$41$， 组成新的折线段$40-41$。\n继续迭代，将得到点$50$，这就是曲线上的点 $C(0.4)$。\n\n**用一张图表示De Casteljau 算法的迭代过程：**\n\n![img](de-cast-compute.jpg)\n\n从初始列，即第 $0$ 列，我们通过两两点之间的插值可以计算出第$1$列的\"新点\"，从第$1$列我们得到第$2$列，依此类推。最终，在应用了 $n$ 次之后，我们将得到唯一的点 $n0$，这就是贝塞尔曲线上的点$C(u)$。\n\n### **递归关系：自顶向下的计算方法**\n\n上述计算可以递归地表达。初始时，令 $P_{0,j}$ 为 $P_j$，其中 $j = 0, 1, ..., n$。$P_{0,j}$ 表示第 0 列的第 $j$ 项。那么第 $i$ 列的第 $j$ 项的计算如下：\n\n$$\\left.\\mathbf{P}_{i,j}=(1-u)\\mathbf{P}_{i-1,j}+u\\mathbf{P}_{i-1,j+1}\\quad\\left\\{\\begin{array}{l}i=1,2,\\ldots,n\\\\j=0,1,\\ldots,n-i\\end{array}\\right.\\right.$$\n\n基于这个公式，可能会立即想到以下递归算法：\n\n$$function$$ $$deCasteljau(i,j)$$\n$$if i = 0 then$$\n\t$$return$$ $$P_{0,j}$$\n$$else$$\n\t$$return$$ $$(1-u)$$ * $$deCasteljau(i-1,j)$$+  $$u$$ * $$deCasteljau(i-1,j+1)$$\n\n这个算法看起来简单，但是它极其低效。原因如下。我们从调用 $deCasteljau(n,0)$ 开始，计算 $P_{n,0}$。$else$ 分支将这个调用会递归产生两个新的调用，即$deCasteljau(n-1,0)$ 用于计算 $P_{n-1,0}$ 和 $deCasteljau(n-1,1)$ 用于计算 $P_{n-1,1}$。\n\n![img](de-cast-rec-comp.jpg)\n\n对 $deCasteljau(n-1,0)$ 的调用。又会产生两个新的调用，$deCasteljau(n-2,0)$ 用于计算 $P_{n-2,0}$ 和 $deCasteljau(n-2,1)$ 用于计算 $P_{n-2,1}$。对 $deCasteljau(n-1,1)$ 的调用也会产生两个新的调用，$deCasteljau(n-2,1)$ 用于计算 $P_{n-2,1}$ 和 $deCasteljau(n-2,2)$ 用于计算 $P_{n-2,2}$。\n\n因此，$deCasteljau(n-2,1)$ 被调用了两次。依次类推，会发现计算 $P_{i,j}$ 的函数被重复调用了，这是对性能非常浪费的。\n\n\n\n### **三角形计算方案：自底向上的计算方法**\n\n以下面在由 8 个控制点 $00, 01, ..., 07$定义的 7 次贝塞尔曲线为例。给定一个在 $[0,1]$ 中的 $u$，我们如何计算这个贝塞尔曲线上对应的点呢？曲线上的点是由选定点形成的等边三角形的底边对面的顶点！\n\n![img](de-cast-observation-crop.jpg)\n\n例如，如果选定的控制点点是 02, 03, 04 和 05，那么对应于 $u$ 的这四个控制点定义的曲线上的点是 32。即蓝色的三角形的顶点。如果选定的控制点是 11, 12 和 13，则曲线上的点是 31。即黄色的三角形的顶点。如果选定的点是 30, 31, 32, 33 和 34，曲线上的点是 70。\n\n反之同理，70 是由控制点 60 和 61 定义的贝塞尔曲线上的点。它也可以是由 50, 51 和 52 控制点定义的曲线上的点，也可以是由 40, 41, 42 和 43 控制点定义的曲线上的点。\n\n如此我们就可以自底向上的计算每一项$P_{i,j}$，以蓝色三角形为例，先计算最左列的$P_{0,2},P_{0,3},P_{0,4},P_{0,5}$，再计算第二列的$P_{1,2},P_{1,3},P_{1,4},P_{0,5}$，再计算第三列的$P_{2,2},P_{2,3}$，再计算最终点$P_{3,2}$，这样可以避免自定向下计算带来的重复项计算的问题。\n\n\n\n## 贝塞尔曲线的导数\n\n### **贝塞尔曲线的导数仍然是贝塞尔曲线**\n\n要在贝塞尔曲线上的某点计算切向量和法向量，首先要计算在该点的一阶和二阶导数。\n\n由 $n + 1$ 个控制点 $P_0, P_1, ..., P_n$ 定义的贝塞尔曲线如下：\n\n$$\\mathbf{C}(u)=\\sum_{i=0}^nB_{n,i}(u)\\mathbf{P}_i$$\n\n其中 $B_{n,i}(u)$ 定义如下：\n\n$$B_{n,i}(u)=\\frac{n!}{i!(n-i)!}u^{i}(1-u)^{n-i}$$\n\n其中控制点$P_{i}$是常数且与变量 $u$ 相互独立，因此，计算贝塞尔曲线的导数 $C'(u)$可以简化为计算 $B_{n,i}(u)$ 的导数。\n\n通过一些代数操作，我们可以得到：\n\n$$\\frac{\\mathrm{d}}{\\mathrm{d}u}B_{n,i}(u)=B_{n,i}^{\\prime}(u)=n(B_{n-1,i-1}(u)-B_{n-1,i}(u))$$\n\n因此曲线的导数 $C'(u)$为：\n\n$$\\frac{\\mathrm{d}}{\\mathrm{d}u}\\mathbf{C}(u)=\\mathbf{C}'(u)=\\sum_{i=0}^{n-1}B_{n-1,i}(u)\\{n(\\mathbf{P}_{i+1}-\\mathbf{P}_i)\\}$$\n\n设 :\n\n$$Q_0 = n(P_1 - P_0)$$ \n$$Q_1 = n(P_2 - P_1)$$ \n$$Q_2 = n(P_3-P_2)$$\n$$Q_{n-1} = n(P_n - P_{n-1})$$\n\n上述方程简化为以下形式：\n\n$$\\mathbf{C}^{\\prime}(u)=\\sum_{i=0}^{n-1}B_{n-1,i}(u)\\mathbf{Q}_{i}$$\n\n**结论：可以看出贝塞尔曲线 的导数$C'(u)$是由 $n$ 个控制点 $n(P_1 - P_0)$, $n(P_2 - P_1)$, $n(P_3 - P_2)$, ..., $n(P_n - P_{n-1})$ 定义的 $n - 1$ 次贝塞尔曲线。**\n\n这个导数曲线通常被称为原贝塞尔曲线的**轨迹图**。\n\n注意，$P_{i+1} - P_i$ 是从 $P_i$ 到 $P_{i+1}$ 的方向向量，而 $n (P_{i+1} - P_i)$ 是该方向向量的 $n$ 倍长。下面左图显示了一个7次贝塞尔曲线，右图显示了其导数，是一个6次贝塞尔曲线。\n\n![img](b-curve-3.jpg)  ![img](b-hodo-3.jpg)\n\n\n\n### **贝塞尔曲线与其第一条和最后一条边相切**\n\n令$u = 0$和$u = 1$，可以得到：\n\n​                    $$C'(0) = n(P_1 - P_0)$$         $$C'(1) = n(P_n - P_{n-1})$$\n\n第一个公式意味着在$u = 0$时的切向量方向是$P_1 - P_0$乘以$n$。因此，指示方向的第一条边与贝塞尔曲线相切。\n第二个公式意味着在$u = 1$时的切向量方向是$P_n - P_{n-1}$乘以$n$。因此，指示方向的最后一条边与贝塞尔曲线相切。下图很好地展示了这个属性。\n\n![img](b-curve-1-17098603594523.jpg)  ![img](b-curve-4.jpg)\n\n\n\n### **用$C^1$连续性连接两个贝塞尔曲线**\n\n利用贝塞尔曲线与其第一条和最后一条边相切的这个特性，可以将两条或更多的贝塞尔曲线连接起来，组合成我们想要的形状。\n\n设第一条曲线$C(u)$由$m + 1$个控制点$P_0, P_1, P_2, ..., P_m$定义，\n设第二条曲线$D(u)$由$n + 1$个控制点$Q_0, Q_1, Q_2, ..., Q_n$定义，\n如果我们想要将这两条贝塞尔曲线连接起来，那么$P_m$必须等于$Q_0$，这保证了$C^0$级连续\n\n第一条曲线与其最后一条边相切，第二条曲线与其第一条边相切。因此，为了实现平滑过渡，$P_{m-1}$，$P_m = Q_0$和$Q_1$四个点必须在同一直线上，使得从$P_{m-1}$到$P_m$的方向与从$Q_0$到$Q_1$的方向相同，如下图所示：\n\n![img](join-rel.jpg)\n\n以这种方式连接两个贝塞尔曲线看起来很平滑，但它仍然是$C^0$连续，而不是$C^1$连续。但是，它满足$G^1$连续（具有相同的切向量方向，但切向量大小不相等）。\n为了保证$C^1$连续性，我们必须确保第一条曲线在$u = 1$处的切向量$C'(1)$，与第二条曲线在$u = 0$处的切向量$D'(0)$，是等的。也就是说，必须满足以下关系：\n\n$$\\mathbf{C}^{\\prime}(1)=m(\\mathbf{P}_m-\\mathbf{P}_{m-1})=\\mathbf{D}^{\\prime}(0)=n(\\mathbf{Q}_1-\\mathbf{Q}_0)$$\n\n这个关系说明要在连接点保证$C^1$连续性，第一条曲线的最后一条边的长度（即$|p_m - p_{m-1}|$）与第二条曲线的第一条边的长度（即$|q_1 - q_0|$）的比例必须是$n/m$。由于度数$m$和$n$是固定的，我们可以调整$p_{m-1}$或$q_1$在同一直线上的位置，使得上述关系得到满足。\n\n![img](b-join-1.jpg) ![img](b-join-2.jpg)\n\n上面左图中为两条贝塞尔曲线连接而成，其中**浅色的折线**定义了一条4次贝塞尔曲线，而**深色的折线**定义了一条5次贝塞尔曲线。\n由于第一条曲线的最后一段和第二条曲线的第一段不在同一直线上，所以这两条曲线并未平滑相接。\n上面右图展示了在连接点处与一条直线相切的两条贝塞尔曲线。然而，它们并不是$C^1$连续的。左边的曲线是4次的，而右边的曲线是7次的。\n但是，左曲线的最后一段与第二条曲线的第一段的比例看起来接近1，它们是$G^1$连续的而不是$C^1$连续的。为了实现$C^1$连续性，我们应该增加左曲线的最后段的长度（或者减少右曲线的第一段的长度），使其比例接近$7/4=1.75$，从而满足$C^1$连续\n\n\n\n### 构造闭合的贝塞尔曲线\n\n利用上面的这种切线性质，如果让第一个和最后一个控制点相同（即$P_0 = P_n$）并且$P_1, P_0$和$P_{n-1}$共线，那么生成的贝塞尔曲线将是一个封闭曲线，并且在连接点处是$G^1$连续的。\n\n如果要在$P_0$处达到$C^1$连续性，必须使 $P_1-P_0=P_n-P_{n-1}$（即曲线的第一段和最后一段有相同的长度并且$P_1, P_0 = P_n, P_{n-1}$共线）\n\n![img](b-close-1.jpg)\n\n\n\n### **导数与de Casteljau算法之间的关系**\n\n重新改写一下贝塞尔曲线的导数形式：\n\n$$\\begin{aligned}\n\\mathrm{C}^{\\prime}(u)&=\\sum_{i=0}^{n-1}B_{n-1,i}(u)\\{n(\\mathbf{P}_{i+1}-\\mathbf{P}_i)\\}  \\\\\n&=n\\left[\\left(\\sum_{i=0}^{n-1}B_{n,i}(u)\\mathbf{P}_{i+1}\\right)-\\left(\\sum_{i=0}^{n-1}B_{n,i}(u)\\mathbf{P}_{i}\\right)\\right]\n\\end{aligned}$$\n\n贝塞尔曲线的导数可以看作是两条$n-1$次贝塞尔曲线的差\n现在让这两条曲线分别为$C_1(u)$和$C_2(u)$：\n\n$$\\quad{C}_1(u)=\\sum\\limits_{i=0}^{n-1}B_{n,i}(u)\\mathbf{P}_{i+1}\\newline{C}_2(u)=\\sum\\limits_{i=0}^{n-1}B_{n,i}(u)\\mathbf{P}_i$$\n\n根据上面定义，可以知道第一条曲线$C_1(u)$由控制点$P_1, P_2, ..., P_n$定义，第二条曲线$C_2(u)$由控制点$P_0, P_1, ..., P_{n-1}$定义，因此，原曲线的导数定义为：\n\n$$\\mathbf{C}^{\\prime}(u)=n(\\mathbf{C}_1(u)-\\mathbf{C}_2(u))$$\n\n为了计算贝塞尔曲线的导数$C'(u)$，可以先使用de Casteljau算法计算$C_1(u)$和$C_2(u)$的值，然后，再计算它们的差，乘以n就得到了$C'(u)$。\n\n**计算$C_1(u)$和$C_2(u)$：**\n\n如下图，最左侧的列有所有给定的控制点，点$n0$代表原始贝塞尔曲线上的点$C(u)$，点$(n-1)0$和$(n-1)1$连成的线段是用来插值获取点$n0$的控制折线，即点$n0$位于$(n-1)0$和$(n-1)1$的线段上，并以$u:1-u$的比例将其分割。\n\n![img](b-tangent.jpg)\n\n由于曲线$C_1(u)$由控制点$01, 02, ..., 0n$定义，因此点$(n-1)1$是曲线$C_1(u)$上的点。同样地，由于$C_2(u)$由控制点$00, 01, ..., 0(n-1)$定义，因此点$(n-1)0$是曲线$C_2(u)$上的点，向量$C_1(u) - C_2(u)$表示从点 $(n-1)0$ 到点 $(n-1)1$ 的向量，而原贝塞尔曲线的导数$C'(u)$的是$n$倍的$C_1(u) - C_2(u)$。\n\n这说明，从 $(n-1)0$ 到 $(n-1)1$ 的线段与$C(u)$处的切线向量方向相同，它在$C(u)$处与曲线相切！\n\n**结论：de Casteljau算法迭代中的最后一条折线，实际上是一条线段，在$C(u)$处与贝塞尔曲线相切。**\n\n下图是一个例子，所示的点为$u = 0.5$处。显然，de Casteljau迭代过程中的最后一条折线段在$C(0.5)$处与曲线相切。\n\n![img](b-tangent-curve.jpg)\n\n\n\n### **计算贝塞尔的高阶导数**\n\n$C(u)$的一阶导数如下：\n\n$$\\mathbf{C}^{\\prime}(u)=\\sum_{i=0}^{n-1}B_{n-1,i}(u)\\mathbf{Q}_i$$\n\n将导数公式应用于上述贝塞尔曲线，得到以下结果，给出了原始贝塞尔曲线的二阶导数：\n\n$$\\begin{aligned}\n\\mathbf{C}^{\\prime\\prime}&=\\sum_{i=0}^{n-2}B_{n-2,i}(u)\\{(n-1)(\\mathbf{Q}_{i+1}-\\mathbf{Q}_i)\\}\\\\\n&=\\sum_{i=0}^{n-2}B_{n-2,i}(u)\\{n(n-1)(\\mathbf{P}_{i+2}-2\\mathbf{P}_{i+1}+\\mathbf{P}_i)\\}\n\\end{aligned}$$\n\n为了简洁地表达高阶导数，可以使用有限差分的方式。定义$D_{i}^0$为控制点$P_i$本身，其中$0 \\leq i \\leq n$。定义第一层差分$D_{i}^1$为前一层的差分，如下：\n\n$$\\begin{aligned}\n\\mathbf{D}_{0}^{1}&=\\text{ D}_1^0-\\mathbf{D}_0^0=\\mathbf{P}_1-\\mathbf{P}_0  \\\\\n\\mathrm{D}_{1}^{1}&=\\text{ D}_2^0-\\mathbf{D}_1^0=\\mathbf{P}_2-\\mathbf{P}_1  \\\\\n&\\vdots \\\\\n\\mathbf{D}_{n-2}^{1}&=\\text{ D}_{n-1}^0-\\mathbf{D}_{n-2}^0=\\mathbf{P}_{n-1}-\\mathbf{P}_{n-2}  \\\\\n\\mathbf{D}_{n-1}^{1}&=\\text{ D}_n^0-\\mathbf{D}_{n-1}^0=\\mathbf{P}_n-\\mathbf{P}_{n-1} \n\\end{aligned}$$\n\n第一层差分只有$n$个点，比给定的控制点少一个，简写一下，第一层的差分如下所示：\n\n$$\\mathbf{D}_i^1=\\mathbf{D}_{i+1}^0-\\mathbf{D}_i^0\\quad0\\leq i\\leq n-1$$\n\n第二层差分被定义为第一层点的差分：\n\n$$\\mathbf{D}_i^2=\\mathbf{D}_{i+1}^1-\\mathbf{D}_i^1\\quad0\\le i\\le n-2$$\n\n这个第二层差分有$n-1$个点。重复这个过程，我们可以定义第$k$层差分如下。第$k$层差分有$n-k+1$个点。\n\n$$\\mathrm D_i^k=\\mathrm D_{i+1}^{k-1}-\\mathrm D_i^{k-1}\\quad0\\leq i\\leq n-k$$\n\n有了这些定义，可以简洁地表达更高阶的导数。首先，让我们使用$D_{i}^1$重新写下$C'(u)$：\n\n$$\\begin{aligned}\n\\mathbf{C}^{\\prime}(u)&=n\\sum_{i=0}^{n-1}B_{n-1,i}(u)(\\mathbf{P}_{i+1}-\\mathbf{P}_{i})  \\\\\n&=n\\sum_{i=0}^{n-1}B_{n-1,i}(u)(\\mathbf{D}_{i+1}^0-\\mathbf{D}_i^0) \\\\\n&=n\\sum_{i=0}^{n-1}B_{n-1,i}(u)\\mathbf{D}_i^1\n\\end{aligned}$$\n\n将导数应用于$C'(u)$来计算$C''(u)$，得到了一个使用$D_{i}^2$表示$C''(u)$的公式：\n\n$$\\begin{aligned}\n\\mathbf{C}''(u)&=n(n-1)\\sum_{i=0}^{n-2}B_{n-2,i}(u)(\\mathbf{D}_{i+1}^1-\\mathbf{D}_i^1)\\\\\n&=n(n-1)\\sum_{i=0}^{n-2}B_{n-2,i}(u)\\mathbf{D}_i^2\n\\end{aligned}$$\n\n对$C''(u)$做同样的处理，我们得到了一个使用$D_{i}^3$表示$C'''(u)$的公式：\n\n$$\\begin{aligned}\n\\mathbf{C}^{\\prime\\prime\\prime}(u)&=n(n-1)(n-2)\\sum_{i=0}^{n-3}B_{n-3,i}(u)(\\mathbf{D}_{i+1}^2-\\mathbf{D}_i^2)\\\\\n&=n(n-1)(n-2)\\sum_{i=0}^{n-3}B_{n-3,i}(u)\\mathbf{D}_i^3\n\\end{aligned}$$\n\n继续这个过程，我们可以计算出第$k$阶导数$C^{(k)}(u)$使用$D_{i}^k$的表示形式：\n\n$$\\begin{aligned}\n\\mathbf{C}^{[k]}(u)&=n(n-1)(n-2)\\cdots(n-k+1)\\sum_{i=0}^{n-k}B_{n-k,i}(u)(\\mathbf{D}_{i+1}^{k-1}-\\mathbf{D}_{i}^{k-1})\\\\\n&=n(n-1)(n-2)\\cdots(n-k+1)\\sum_{i=0}^{n-k}B_{n-k,i}(u)\\mathbf{D}_{i}^{k}\n\\end{aligned}$$\n\n因此，要在特定的$u$处计算$C(u)$的第$k$阶导数，我们首先计算$D_{i}^k$的值，然后应用de Casteljau算法计算由$D_{i}^k$定义的贝塞尔曲线上对应于$u$的点。\n\n如下图所示，我们已有第0列所有$D_{i}^0$的值（即控制点本身），然后使用两两差分来计算第1列的$D_{i}^1$的值。重复这个过程直到我们达到如下所示的第$k$列：\n\n![img](b-high-der-diagram.jpg)\n\n\n\n最后，使用de Casteljau算法计算出第$k$列点的$B_{n-k,i}(u)$的值，与$D_{i}^k$相乘后累加，再将结果乘以$n(n-1)(n-2)...(n-k+1)$，就得到了$C^{(k)}(u)$的值！\n\n\n\n## 贝塞尔曲线的拆分\n\n**曲线拆分**的过程是将一个贝塞尔曲线在特定点$C(u)$处一分为二，每一部分仍然是贝塞尔曲线。分割后的每段曲线都需要一套新的控制点来描述其形状，原有的控制点将不再适用。此外，由于原始贝塞尔曲线的阶次是$n$，被切割成两部分后，每个部分都是原贝塞尔曲线的子集，因此得到的新贝塞尔曲线的阶次也必须是$n$。\n\n假设我们$n + 1$个控制点$P_0, P_1, P_2, ..., P_n$，参数 $0\\leq u\\leq1$，目标是找到两组新的$n+1$个控制点$Q_0, Q_1, Q_2, ..., Q_n$和$R_0, R_1, R_2, ..., R_n$。\n\n这两组控制点各自定义的贝塞尔曲线分别对应原始曲线在$[0,u]$和$[u,1]$区间的部分。\n\n虽然正确性证明有点繁琐，但实际上算法非常简单。事实上，de Casteljau 的算法用于计算曲线上点 $C(u)$ 时已经提供了所有必要的信息。在下面的左图中，展示了用 de Casteljau 算法计算 $C(u)$ 的所有中间步骤，右图显示了在点 $C(u)$ 处曲线拆分后的形状及相应的控制折线。\n\n![img](b-sub-master.jpg) ![img](b-sub-result.jpg)\n\n仔细比较这两幅图，左图中，**左半段**贝塞尔曲线的控制点由$P_{00}=P_0, P_{10},P_{20},P_{30},P_{40},P_{50}$和$P_{60} = C(u)$组成\n**右半段**贝塞尔曲线的控制点由点$P_{60}=C(u),P_{51},P_{42},P_{33},P_{24},P_{15}$和$P_{06} = P_6$组成。\n下图展示了这些点：\n\n![img](b-sub-left.jpg)![img](b-sub-right.jpg)\n\n回想一下de Casteljau算法的三角形计算方案：对于给定的$u$，计算$C(u)$需要$n$次迭代，在计算过程中，可以收集每列的第一个点和最后一个点，并且最终，第一个点（或最后一个点）的集合对应于原始曲线在$[0,u]$（或$[u,1]$）上定义的片段。\n\n因此，在下面的三角形方案中，箭头指向的顶边(红色：$00,10,20,30,40,50,60$)和箭头相反方向的底边(蓝色：$60,51,42,33,24,15,06$)分别对应位第一段曲线和第二段曲线段的控制点。有了控制点，也就可以得出拆分后的两段贝塞尔曲线（可以重新计算获得）\n\n![img](b-sub-chart.jpg)\n\n注意：点$50$和$51$定义的线段在点$60$处与曲线相切（见上图），即左曲线的最后一段（即线段$50-60$）与左曲线相切，右曲线的第一段（即线段$60-51$）与右曲线相切。\n\n**曲线拆分为何至关重要？**\n曲线拆分的应用范围广泛。例如，它可以被用来找出两个贝塞尔曲线的交汇点、对贝塞尔曲线进行渲染，以及简化曲线设计过程。设想我们设计了一条曲线，却发现它并不完全符合我们的预期。在这种情形下，我们可能会考虑在某些特定的点上将曲线分割为两个部分：一个部分达到了我们的满意度，而另一部分则没有。接下来，我们可以忽略掉那部分我们已经满意的，将注意力集中在仍需改进的部分上。\n\n\n\n## 贝塞尔曲线的升阶\n\n不改变贝塞尔曲线的形状，同时增加贝塞尔曲线的度数（即阶数/次数），称为**贝塞尔曲线的升阶**。\n\n假设我们有一个由 $n+1$个控制点$P_0, P_1, P_2, ..., P_n$定义的$n$阶贝塞尔曲线，我们希望将这个曲线的度数提升到$n + 1$而不改变其形状。由于$n + 1$阶贝塞尔曲线需要由$n + 2$个控制点定义，因此，我们需要找到一个新的控制点集，显然，$P_0$ 和 $P_n$ 必须在新控制点集中，因为贝塞尔曲线会通过首尾控制点，曲线升阶不改变曲线的形状。因此，我们需要$n$个新的控制点，假设新的控制点集为 $Q_0, Q_1, Q_2, ..., Q_{n+1}$，根据上述要求有，$Q_0 = P_0$ 和 $Q_{n+1} = P_n$。其他控制点的计算方式如下：\n\n$$\\mathbf{Q}_i=\\frac{i}{n+1}\\mathbf{P}_{i-1}+\\left(1-\\frac{i}{n+1}\\right)\\mathbf{P}_i\\quad1\\le i\\le n$$\n\n以下是从$Q_1$到$Q_n$每个控制点的公式：\n\n$$\\begin{aligned}\n\\mathbf{Q}_1&=\\frac{1}{n+1}\\mathbf{P}_0+\\left(1-\\frac{1}{n+1}\\right)\\mathbf{P}_1\\\\\n\\mathbf{Q}_2&=\\frac{2}{n+1}\\mathbf{P}_1+\\left(1-\\frac{2}{n+1}\\right)\\mathbf{P}_2\\\\\n\\mathbf{Q}_3&=\\frac{3}{n+1}\\mathbf{P}_2+\\left(1-\\frac{3}{n+1}\\right)\\mathbf{P}_3\\\\\n&\\vdots\\\\\n\\mathbf{Q}_{n-1}&=\\frac{n-1}{n+1}\\mathbf{P}_{n-2}+\\left(1-\\frac{n-1}{n+1}\\right)\\mathbf{P}_{n-1}\\\\\n\\mathbf{Q}_n&=\\frac{n}{n+1}\\mathbf{P}_{n-1}+\\left(1-\\frac{n}{n+1}\\right)\\mathbf{P}_n\n\\end{aligned}$$\n\n原始多段线的每一段上正好会有一个新的控制点。即：线段$P_{i-1}P_i$ 包含新控制点$Q_i$。\n\n在de Casteljau算法中，线段$AB$上一点$C$，将$AB$按比例 $u:1-u$ 分割，可以写作 $C = (1 - u)A + uB$。在上式中，$Q_i$将线段$P_{i-1}P_i$  按比例 $1-\\frac{i}{n+1}:\\frac{i}{n+1}$ 分割。这个比例不是一个常数，而是随着 i 的值变化的，但与de Casteljau算法很相似\n\n获得了新的控制点集后，原控制点集就可以弃用。由于原始控制多段线的每一段都包含一个新控制点，用新控制点集合替换旧控制点集合的过程可以看作是在原始控制点处切掉角。\n\n见下图，图中显示了一个4度贝塞尔曲线，控制点以红色矩形显示，控制多段线以虚线显示。将其度数增加到5后，新的控制多段线以实线段显示。显然，所有角都被切掉了。下表给出了原始控制多段线上每一段的比例。\n\n| i    | 1 - i/(n+1) | i/(n+1) |\n| ---- | ----------- | ------- |\n| 1    | 0.8         | 0.2     |\n| 2    | 0.6         | 0.4     |\n| 3    | 0.4         | 0.6     |\n| 4    | 0.2         | 0.8     |\n\n![img](bezier-cut-corner.jpg)\n\n随着曲线度数的增加，控制点的数量也会增加。并且，新的控制多边形会逐渐向曲线靠拢。在下面的图形中，我们从一个度数为6、控制点为7个的贝塞尔曲线开始，然后，其度数增加到7、8、10、15和29。从图中可以看出，随着度数的增加，曲线的形状没有改变，控制多边形越来越接近曲线。最终，随着度数不断增加到无限，控制多边形将趋向于曲线，曲线则相当于控制多边形的一个极限位置。\n\n![img](b-elev-06.jpg)![img](b-elev-07.jpg)![img](b-elev-08.jpg)![img](b-elev-10.jpg)![img](b-elev-15.jpg)![img](b-elev-29.jpg)\n\n\n\n## 总结\n\n总的来说，要定义一个$n$阶的贝塞尔曲线，我们需要在空间中选择$n+1$个控制点，这些点大致描述了所需曲线的形状。\n\n然后，如果它不符合我们的期望，我们可以移动控制点。随着一个或多个控制点的移动，贝塞尔曲线的形状相应地发生变化。但是，曲线始终位于由控制点定义的凸包内（**凸包性质**），并且生成的曲线形状比控制多边形简单（**变差减少性质**）。\n\n除此之外，贝塞尔曲线还具有**非负性**、**单位分割**、**仿射不变性**、**递归性**等性质。贝塞尔曲线不具备**局部修改性**，移动控制点将会全面改变贝塞尔曲线的形状，这也是其逐渐被**样条曲线**和**Nurbs曲线**取代的原因。\n\n详细介绍了**De Casteljau算法**，用于计算任意参数位置时，对应的贝塞尔曲线上一点，这是一种**自底向上**的**三角形计算方案**，能够避免**自顶向下**计算方案递归调用时带来的不必要的性能开销。\n\n还介绍了**贝塞尔曲线导数**的性质，如何将两个**贝塞尔曲线连接***在一起并保证连接点处$C^1$连续，如何构造**闭合的贝塞尔曲线**以及计算**高阶贝塞尔导数**。\n\n最后还介绍了贝塞尔曲线的**拆分**和**升阶**方法，这个早期在工程中也是具有很大的应用。\n\n\n\n## 文献引用\n\n- Gerald Farin, *Curves and Surfaces for CAGD: A Practical Guide*, fourth edition, Academic Press, 1997.\n- Josef Hoschek and Dieter Lasser, *Fundamentals of Computer Aided Geometric Design*, translated from the German 1989 edition by Larry L. Schumaker, A K Peters, 1993.\n- Les Piegl and Wayne Tiller, *The NURBS Book*, second edition, Springer-Verlag, 1997.\n- David F. Rogers and J. Alan Adams, *Mathematical Elements for Computer Graphics*, second edition, McGraw-Hill, 1990.\n\n---\n\n后续，将会继续介绍**B样条曲线**和**Nurbs曲线**，这两种类型的曲线会逐渐取代贝塞尔成为工程中的主流曲线定义方式。**To be continued....**","slug":"贝塞尔曲线","published":1,"updated":"2025-11-11T09:31:41.903Z","_id":"cmhud1bef0001b0mndclw5b68","comments":1,"photos":[],"content":"<h1 id=\"Bezier曲线\"><a href=\"#Bezier曲线\" class=\"headerlink\" title=\"Bezier曲线\"></a>Bezier曲线</h1><p>贝塞尔曲线于 1962 年，由法国工程师皮埃尔·贝济埃（Pierre Bézier）所广泛发表，他运用贝塞尔曲线来为汽车的主体进行设计,贝塞尔曲线最初由保尔·德·卡斯特里奥于1959年运用德卡斯特里奥算法开发，以稳定数值的方法求出贝塞尔曲线.</p>\n<p><strong>先从几个简单的例子开始：</strong></p>\n<h2 id=\"一阶贝塞尔曲线\"><a href=\"#一阶贝塞尔曲线\" class=\"headerlink\" title=\"一阶贝塞尔曲线\"></a>一阶贝塞尔曲线</h2><img src=\"v2-770487eacf3b9d5973e2783b6d8698e5_r.jpg\" alt=\"img\" style=\"zoom: 33%;\" />\n\n<p>对于一阶贝塞尔曲线为我们可以看到是一条直线，通过几何知识，很容易根据t的值得出线段上那个点的坐标。</p>\n<p>给定点 $P_0$、$P_1$，线性贝塞尔曲线只是一条两点之间的直线。这条线由下式给出：</p>\n<p>$$\\mathbf{B}(t)&#x3D;\\mathbf{P}_0+(\\mathbf{P}_1-\\mathbf{P}_0)t&#x3D;(1-t)\\mathbf{P}_0+t\\mathbf{P}_1,t\\in[0,1]$$</p>\n<p>一阶曲线就是很好理解, 就是根据t来的线性插值。$P_0$表示的是一个向量 $[x ,y]$, 其中$x$和$y$是分别按照这个公式来计算的。</p>\n<h2 id=\"二阶贝塞尔曲线\"><a href=\"#二阶贝塞尔曲线\" class=\"headerlink\" title=\"二阶贝塞尔曲线\"></a>二阶贝塞尔曲线</h2><img src=\"image-20230715134335693.png\" alt=\"image-20230715134335693\" style=\"zoom: 50%;\" />\n\n<img src=\"image-20230715134422584.png\" alt=\"image-20230715134422584\" style=\"zoom: 50%;\" />\n\n<p>在平面内任选 3 个不共线的点，依次用线段连接。在第一条线段上任选一个点 $D$。计算该点到线段起点的距离$AD$，与该线段总长$AB$的比例。</p>\n<img src=\"image-20230715134508818.png\" alt=\"image-20230715134508818\" style=\"zoom: 50%;\" />\n\n<p>根据上一步得到的比例，从第二条线段上找出对应的点 $E$，使得 $AD:AB &#x3D; BE:BC$</p>\n<img src=\"image-20230715134543049.png\" alt=\"image-20230715134543049\" style=\"zoom:50%;\" />\n\n<img src=\"image-20230715134555599.png\" alt=\"image-20230715134555599\" style=\"zoom:50%;\" />\n\n<p>这时候$DE$又是一条直线了, 就可以按照一阶的贝塞尔方程来进行线性插值了：</p>\n<p>$$t&#x3D; AD:AE$$</p>\n<p>这时候就可以推出公式了：</p>\n<p><img src=\"B%C3%A9zier_2_big.gif\" alt=\"img\"></p>\n<p>$$P_0&#x3D;(1-t)P_0+tP_1$$</p>\n<p>$$P_1&#x3D;(1-t)P_1+tP_2$$</p>\n<p>整理一下公式, 得到二阶贝塞尔公式：</p>\n<p>$$\\mathbf{B}(t) &#x3D;(1-t)^{2}\\mathbf{P}<em>{0}+2t(1-t)\\mathbf{P}</em>{1}+t^{2}\\mathbf{P}_{2},t\\in[0,1]$$</p>\n<h2 id=\"三阶贝塞尔曲线\"><a href=\"#三阶贝塞尔曲线\" class=\"headerlink\" title=\"三阶贝塞尔曲线\"></a>三阶贝塞尔曲线</h2><img src=\"image-20230715135427376.png\" alt=\"image-20230715135427376\" style=\"zoom:50%;\" />\n\n<p>四个点对应是三次的贝塞尔曲线. 分别在 $AB$、$BC$、$CD$ 之间采$EFG$点, $EFG$三个点对应着二阶贝塞尔, 在$EF$、$FG$之间采集$H$、$I$点来降阶为一阶贝塞尔曲线.</p>\n<p>公式：</p>\n<p>$$\\mathbf{B}(t)&#x3D;\\mathbf{P}_0(1-t)^3+3\\mathbf{P}_1t(1-t)^2+3\\mathbf{P}_2t^2(1-t)+\\mathbf{P}_3t^3,t\\in[0,1]_0$$</p>\n<p>动画效果</p>\n<p><img src=\"B%C3%A9zier_3_big-168860760518218.gif\" alt=\"img\"></p>\n<h2 id=\"贝塞尔曲线公式\"><a href=\"#贝塞尔曲线公式\" class=\"headerlink\" title=\"贝塞尔曲线公式\"></a>贝塞尔曲线公式</h2><p>贝塞尔曲线是通过空间中的$n+1$个点$P_0, P_1, P_2, \\ldots, P_n$来定义的，这些点称为控制点。控制点决定了曲线的形状，贝塞尔曲线定义如下：</p>\n<p>$$\\mathbf{C}(u)&#x3D;\\sum_{i&#x3D;0}^nB_{n,i}(u)\\mathbf{P}_i$$</p>\n<p>其中系数定义如下：</p>\n<p>$$B_{n,i}(u)&#x3D;\\frac{n!}{i!(n-i)!}u^{i}(1-u)^{n-i}$$</p>\n<p>贝塞尔曲线上对应于参数位置为$u$的点，是所有控制点的”加权”平均值，其中权重是系数$B_{n,i}(u)$，其中$u$的定义域为$[0,1]$。函数$B_{n,i}(u), 0 \\leq i \\leq n$被称为<strong>贝塞尔基函数</strong>或<strong>伯恩斯坦多项式</strong>。</p>\n<p>将控制点点$P_0P_1, P_2, \\ldots, P_n$按此顺序连接，我们得到了一个<strong>控制多边形</strong>，它帮助我们描述了曲线的大致形状。</p>\n<p>下图展示了由11个控制点定义的贝塞尔曲线，其中蓝色点是对应于$u&#x3D;0.4$的曲线上的点。如图所示，曲线或多或少地跟随着多边形线。</p>\n<p><img src=\"b-curve-1-17103242022572.jpg\" alt=\"img\"></p>\n<hr>\n<p><strong>问题：当$u$的定义域非[0,1]时如何处理？</strong></p>\n<p>贝塞尔曲线不总是定义在$[0,1]$这一标准区间上，有时其定义域可能为$[a,b]$。在这种情况下，就需要进行变量的转换。我们需要做的是，将$u$从区间$[a,b]$映射到$[0,1]$，然后在基函数中使用转换后的$u$值。具体的转换方法如下：</p>\n<p>$$u’&#x3D;\\frac{u-a}{b-a}$$</p>\n<p>将转换后的$u’$代入到基函数$B_{n,i}(u)$中，可以得到新的公式：</p>\n<p>$$B_{n,i}(u’)&#x3D;\\frac{n!}{i!(n-i)!}\\left(\\frac{u-a}{b-a}\\right)^i\\left(1-\\frac{u-a}{b-a}\\right)^{n-i}$$</p>\n<p>这一变换后的基函数定义了在区间$[a,b]$上的贝塞尔曲线</p>\n<h2 id=\"贝塞尔曲线的特点和性质\"><a href=\"#贝塞尔曲线的特点和性质\" class=\"headerlink\" title=\"贝塞尔曲线的特点和性质\"></a>贝塞尔曲线的特点和性质</h2><ul>\n<li><p><strong>贝塞尔曲线由$n+1$个控制点定义，曲线的度数是$n$</strong>：<br>在每个基函数中，$u$的指数是$i + (n - i) &#x3D; n$。因此，曲线的度数是$n$</p>\n</li>\n<li><p>曲线$C(u)$通过第一个控制点$P_0$和最后一个控制点$P_n$</p>\n</li>\n<li><p><strong>非负性</strong>：所有基函数都是非负的。</p>\n</li>\n<li><p><strong>单位分割</strong>：在任一特定的$u$值下，这些基函数值的总和为1。这保证了曲线上的任一点都是控制点加权平均的结果，且权重总和为1</p>\n<p><img src=\"b-curve-2-17091716014474-17103791115213.jpg\" alt=\"img\"><img src=\"b-pou-1-17091716014476.jpg\" alt=\"img\"></p>\n<p>在上面的左侧图片中，展示了一个基于五个控制点构成的贝塞尔曲线。而右侧的图则展示了作为$u$值函数的五个基函数。</p>\n<p>这些图表揭示了当$u&#x3D;0.5$时，这五个基函数的分布情况。图中最右侧的竖条图清晰地展现了如何将数值1等分为五部分，这就是所谓的<strong>单位分割</strong>。</p>\n<p>所有基函数的取值范围从0到1，它们的总和恰好为1，因此，这些基函数在计算加权平均时充当了权重的角色。更简单地说，计算<strong>C</strong>($u$)时，实际上是将控制点$P_i$按照$B_{n,i}(u)$的权重进行加权汇总。</p>\n</li>\n<li><p><strong>凸包性质</strong></p>\n<p>贝塞尔曲线的一个显著特点是，它完全被其$n + 1$个控制点所形成的凸包所包围。所谓凸包，指的是能够包含一组点集所有点的最小凸形状。</p>\n<p>在下面的示例中，11个控制点形成的凸包以灰色表示。值得注意的是，并不是所有控制点都位于凸包的边缘。比如，控制点3、4、5、6、8和9位于凸包内部。除了起点和终点，曲线始终位于这个凸包之内。</p>\n<p><img src=\"b-curve-1-17103234093711.jpg\" alt=\"img\"></p>\n</li>\n<li><p><strong>变差减少性</strong></p>\n<p>在平面上，这个性质意味着没有任何直线能与贝塞尔曲线相交的次数超过它与曲线的控制多边形相交的次数。</p>\n<p><img src=\"b-variation-17103792438184.jpg\" alt=\"img\"></p>\n<p>如上图所示，黄色直线与曲线相交3次，但与控制多边形相交了7次；<br>红色直线与曲线相交5次，与控制多边形也相交7次；<br>而青色直线与曲线及其控制多边形都只相交两次。<br>你可以尝试绘制其他直线以验证这一性质。</p>\n<p>若曲线是空间中的曲线，则只需将“直线”改为“平面”。</p>\n<p>这一性质的意义何在？它告诉我们，与控制多边形相比，贝塞尔曲线的复杂性（即转弯和扭曲的程度）会更低。换言之，控制多边形相较于它所定义的贝塞尔曲线，会有更频繁的转弯和扭曲，因为任意直线与控制多边形相交的次数总是多于与曲线相交的次数。</p>\n</li>\n<li><p><strong>仿射不变性</strong></p>\n<p>对贝塞尔曲线进行仿射变换时，其变换结果能够通过控制点经过相同变换后的新位置来确定。这一特性极为有利。当我们需要对贝塞尔曲线执行几何或仿射变换操作时，直接对控制点施加变换即可。完成控制点的变换后，由这些调整后的控制点所定义的新贝塞尔曲线即为所求。因此，无需直接对曲线本身进行变换处理。</p>\n</li>\n<li><p><strong>递归性</strong></p>\n<p>递归性指其系数满足下式：<br>$$B_{i,n}(t)&#x3D;(1-t)B_{i,n-1}(t)+tB_{i-1,n-1}(t)【i&#x3D;0,1,\\cdots,n】$$</p>\n</li>\n<li><p><strong>一阶导数性质</strong></p>\n<img src=\"image-20230715142535462.png\" alt=\"image-20230715142535462\" style=\"zoom:50%;\" />\n\n<p>假设上图中贝塞尔的 $t$ 是由左到右从 $0$ 到 $1$ 增加的，那么贝塞尔曲线在 $t&#x3D;0$ 时的导数是和 $P_0P_1$的斜率（导数）是相同，$t&#x3D;1$ 时的导数是和$P_3P_4$ 的斜率（导数）是相同的</p>\n<img src=\"image-20230715142627416.png\" alt=\"image-20230715142627416\" style=\"zoom:50%;\" />\n\n<p>这一点的性质可以用在贝塞尔曲线的拼接，只要保证三点一线中的中间点是两段贝塞尔曲线的连接点，就可以保证两端贝塞尔曲线的导数连续</p>\n</li>\n</ul>\n<h2 id=\"控制点的移动对曲线的影响\"><a href=\"#控制点的移动对曲线的影响\" class=\"headerlink\" title=\"控制点的移动对曲线的影响\"></a>控制点的移动对曲线的影响</h2><p>当我们调整一个贝塞尔曲线的控制点位置时，曲线形状将发生变化。这引出一个问题：<br>\t\t\t\t\t<strong>控制点移动到新的位置时，贝塞尔曲线将如何变形？</strong></p>\n<p>假设控制点 $P_k$ 移动到 $P_k+\\mathbf{v}$ 的新位置，向量 $\\mathbf{v}$ 表示移动的方向和距离。如图所示：</p>\n<p><img src=\"bezier-P+v.jpg\" alt=\"img\"></p>\n<p>原始贝塞尔曲线表示为： $$\\mathbf{C}(u)&#x3D;\\sum_{i&#x3D;0}^nB_{n,i}(u)\\mathbf{P}_i$$</p>\n<p>由于新的贝塞尔曲线是由 $P_0, P_1, …, P_k+\\mathbf{v}, …, P_n$定义的，新的贝塞尔曲线方程 $D(u)$ 可以写成：</p>\n<p>$$\\begin{aligned}<br>\\mathbf{D}(u)&amp;&#x3D;\\sum_{i&#x3D;0}^{k-1}B_{n,i}(u)\\mathbf{P}<em>{i}+B</em>{n,k}(u)(\\mathbf{P}<em>{k}+\\mathbf{v})+\\sum</em>{i&#x3D;k+1}^{n}B_{n,i}(u)\\mathbf{P}<em>{i}  \\<br>&amp;&#x3D;\\sum</em>{i&#x3D;0}^{n}B_{n,i}(u)\\mathbf{P}<em>{i}+B</em>{n,k}(u)\\mathbf{v} \\<br>&amp;&#x3D;\\mathbf{C}(u)+B_{n,k}(u)\\mathbf{v}<br>\\end{aligned}$$</p>\n<p>在上式中，因为只有第 $k$ 项控制点使用了 $P_k+\\mathbf{v}$，所以我们得出新曲线是原始曲线与额外的项 $B_{n,k}(u)\\mathbf{v}$ 的组合。</p>\n<p>因此，新曲线上任一给定 $u$ 对应的点，可以通过将原始曲线上相同位置的点沿向量  $\\mathbf{v}$ 的方向平移 $|B_{n,k}(u)\\mathbf{v}|$ 的距离来获得。</p>\n<p>更具体地来说，对于任意给定的 <em>u</em> 值，原曲线上对应的点为 $C(u)$，新曲线上对应的点为 $D(u)$，且 $D(u) &#x3D; C(u) + B_{n,k}(u)\\mathbf{v}$。</p>\n<p>以下图说明这一变化：<br>                                           <img src=\"bezier-move-ct-pt-1.jpg\" alt=\"img\"></p>\n<p>图中，黑色与红色曲线分别代表由9个控制点定义的同一8次贝塞尔曲线的原始和变形状态。黑色曲线为原始状态。若其中一个控制点沿蓝色向量移动到新位置，黑色曲线便转变为红色曲线。</p>\n<p>图中同时标出了$u&#x3D;0.5$时两条曲线上的对应点。可以明显看出，$C(0.5)$ 沿相同方向移动至 $D(0.5)$。从 $C(0.5)$ 到 $D(0.5)$ 的距离等同于向量 </p>\n<p>​\t\t\t\t\t\t$$B_{8,3}(0.5)\\mathbf{v} &#x3D; \\frac{8!}{(3!(8-3)!)}×0.5^3(1-0.5)^{8-3}\\mathbf{v} &#x3D; 0.22\\mathbf{v}$$</p>\n<p>因此，<strong>该距离约为原始控制点3和下图所示的新控制点3之间距离的22%</strong></p>\n<p>从这一分析中，我们可以得出另一个重要的结论：<br>因为 $B_{n,k}(u)$ 在开区间 $(0,1)$ 内非零，因此 $B_{n,k}(u)\\mathbf{v}$ 在此区间内不是零向量。这意味着除了端点 $C(0)$ 和 $C(1)$ 外，所有原始曲线上的点都会被移动到新的位置上。由此可见：</p>\n<p>​\t\t\t\t\t<strong>移动控制点将会全面改变贝塞尔曲线的形状。</strong></p>\n<h2 id=\"计算贝塞尔曲线上一点：De-Casteljau-算法\"><a href=\"#计算贝塞尔曲线上一点：De-Casteljau-算法\" class=\"headerlink\" title=\"计算贝塞尔曲线上一点：De Casteljau 算法\"></a>计算贝塞尔曲线上一点：De Casteljau 算法</h2><p><strong>在构造 Bézier 曲线后，如何找到曲线上参数为 $u$ 处的点 $C(u)$？</strong></p>\n<p>一种简单的方法是将 $u$ 代入贝塞尔曲线的公式：</p>\n<p>$$\\mathbf{C}(u)&#x3D;\\sum_{i&#x3D;0}^nB_{n,i}(u)\\mathbf{P}_i$$</p>\n<p>其中系数定义如下：</p>\n<p>$$B_{n,i}(u)&#x3D;\\frac{n!}{i!(n-i)!}u^{i}(1-u)^{n-i}$$</p>\n<p>计算每个基函数的值，并计算每个基函数及其对应控制点的乘积，最后将它们相加。虽然这样可以，但不是<strong>数值稳定</strong>的（即在计算伯恩斯坦多项式的过程中可能引入数值误差）。</p>\n<p>还记得本文开始几个小节关于一阶、二阶、三阶贝塞尔曲线的推导过程吗，这就是<strong>De Casteljau 算法</strong>：</p>\n<p>首先，我们以编号的形式记录下控制点，如 $P_0$ 记作 $00$，$P_1$ 记作 $01$，依此类推，直至 $P_n$ 的编号为 $0n$。第一个数字 $0$ 表示第0阶或第一次迭代。在接下来的迭代中，这些数字会变成$1、2、3$ 等。</p>\n<p><strong>De Casteljau 算法的核心在于找到线段 AB 上某个点 $C$，该点按 $u:1-u$ 的比例将线段 $AB$ 划分。从而确立点 $C$ 的具体位置。</strong></p>\n<p><img src=\"point-c.jpg\" alt=\"img\"></p>\n<p>线段$AB$ 的向量可以表示为 $B - A$。由于 $u$ 是介于 $0$ 和$1$ 之间的比例，所以点 $C$ 的位置可以用 $u(B - A)$ 来描述。再加上 $A$ 点的坐标，我们可以得到 $C$ 的准确位置为 </p>\n<p>$$A + u(B - A) &#x3D; (1 - u)A + uB$$</p>\n<p>因此，对于任何给定的 $u$ 值， 我们都能准确地定位在 $A$ 与 $B$ 之间的一点 $C$。</p>\n<p><strong>如何找到贝塞尔曲线上任意一处参数 $u$ 的点 $C(u)$：</strong></p>\n<p>首先将控制点依次连接，得到一个折线：即 $00-01-02-03…-0n$ 多段线，然后根据上述公式在每对相邻控制点之间找到新点 $1i$，这个新点将原线段 $0i-0(i+1)$ 按 $u:1-u$ 的比例分割。通过这种方式，我们可以得到 $n$ 个新点：$10, 11, 12, …, 1(n-1)$，它们共同构成了一条新的折线。</p>\n<p><img src=\"de-casteljau.jpg\" alt=\"img\"></p>\n<p>如上图所示，例如，当 $u &#x3D; 0.4$ 时，通过插值可以得到点$10$位于起始控制点$00$和$01$之间， 其中$\\frac{00-10}{10-01}&#x3D;\\frac{u}{1-u}$ 。($00$即点$0$，$00$中的第一个$0$表示$0$阶，第二个$0$表示第$0$个点。$01$即点$1$，$01$中的第一个$0$表示$0$阶，第二个$1$表示第$1$个点） </p>\n<p>第二次迭代：点$11$位于点$01$和$02$之间，$\\frac{01-11}{11-02}&#x3D;\\frac{u}{1-u}$以此类推，可以计算出点$12、13、14$。这些新产生的点都以蓝色标记。</p>\n<p>每一次迭代，我们获得的”新控制点”的数量都比之前迭代的结果少1，直到最减少到唯一的点$n0$。这一点就是在给定 $u$ 值下，贝塞尔曲线上的对应点 $C(u)$。</p>\n<p>举例：在上图中，<br>点$20$可以通过以 $u:1-u$ 的比例划分线段$10-11$得到，。<br>点$21$通过边$11-12$划分得到<br>点$22$通过边$12-13$划分得到<br>点$23$通过边$13-14$划分得到。<br>从而得到了由点$20,21,22,23$定义的三阶折线。<br>在折线段$20-21-22-23$的两两点之间进行插值，将得到个新的折线段$30-31-32$。继续迭代，将得到点$40$和$41$， 组成新的折线段$40-41$。<br>继续迭代，将得到点$50$，这就是曲线上的点 $C(0.4)$。</p>\n<p><strong>用一张图表示De Casteljau 算法的迭代过程：</strong></p>\n<p><img src=\"de-cast-compute.jpg\" alt=\"img\"></p>\n<p>从初始列，即第 $0$ 列，我们通过两两点之间的插值可以计算出第$1$列的”新点”，从第$1$列我们得到第$2$列，依此类推。最终，在应用了 $n$ 次之后，我们将得到唯一的点 $n0$，这就是贝塞尔曲线上的点$C(u)$。</p>\n<h3 id=\"递归关系：自顶向下的计算方法\"><a href=\"#递归关系：自顶向下的计算方法\" class=\"headerlink\" title=\"递归关系：自顶向下的计算方法\"></a><strong>递归关系：自顶向下的计算方法</strong></h3><p>上述计算可以递归地表达。初始时，令 $P_{0,j}$ 为 $P_j$，其中 $j &#x3D; 0, 1, …, n$。$P_{0,j}$ 表示第 0 列的第 $j$ 项。那么第 $i$ 列的第 $j$ 项的计算如下：</p>\n<p>$$\\left.\\mathbf{P}<em>{i,j}&#x3D;(1-u)\\mathbf{P}</em>{i-1,j}+u\\mathbf{P}_{i-1,j+1}\\quad\\left{\\begin{array}{l}i&#x3D;1,2,\\ldots,n\\j&#x3D;0,1,\\ldots,n-i\\end{array}\\right.\\right.$$</p>\n<p>基于这个公式，可能会立即想到以下递归算法：</p>\n<p>$$function$$ $$deCasteljau(i,j)$$<br>$$if i &#x3D; 0 then$$<br>\t$$return$$ $$P_{0,j}$$<br>$$else$$<br>\t$$return$$ $$(1-u)$$ * $$deCasteljau(i-1,j)$$+  $$u$$ * $$deCasteljau(i-1,j+1)$$</p>\n<p>这个算法看起来简单，但是它极其低效。原因如下。我们从调用 $deCasteljau(n,0)$ 开始，计算 $P_{n,0}$。$else$ 分支将这个调用会递归产生两个新的调用，即$deCasteljau(n-1,0)$ 用于计算 $P_{n-1,0}$ 和 $deCasteljau(n-1,1)$ 用于计算 $P_{n-1,1}$。</p>\n<p><img src=\"de-cast-rec-comp.jpg\" alt=\"img\"></p>\n<p>对 $deCasteljau(n-1,0)$ 的调用。又会产生两个新的调用，$deCasteljau(n-2,0)$ 用于计算 $P_{n-2,0}$ 和 $deCasteljau(n-2,1)$ 用于计算 $P_{n-2,1}$。对 $deCasteljau(n-1,1)$ 的调用也会产生两个新的调用，$deCasteljau(n-2,1)$ 用于计算 $P_{n-2,1}$ 和 $deCasteljau(n-2,2)$ 用于计算 $P_{n-2,2}$。</p>\n<p>因此，$deCasteljau(n-2,1)$ 被调用了两次。依次类推，会发现计算 $P_{i,j}$ 的函数被重复调用了，这是对性能非常浪费的。</p>\n<h3 id=\"三角形计算方案：自底向上的计算方法\"><a href=\"#三角形计算方案：自底向上的计算方法\" class=\"headerlink\" title=\"三角形计算方案：自底向上的计算方法\"></a><strong>三角形计算方案：自底向上的计算方法</strong></h3><p>以下面在由 8 个控制点 $00, 01, …, 07$定义的 7 次贝塞尔曲线为例。给定一个在 $[0,1]$ 中的 $u$，我们如何计算这个贝塞尔曲线上对应的点呢？曲线上的点是由选定点形成的等边三角形的底边对面的顶点！</p>\n<p><img src=\"de-cast-observation-crop.jpg\" alt=\"img\"></p>\n<p>例如，如果选定的控制点点是 02, 03, 04 和 05，那么对应于 $u$ 的这四个控制点定义的曲线上的点是 32。即蓝色的三角形的顶点。如果选定的控制点是 11, 12 和 13，则曲线上的点是 31。即黄色的三角形的顶点。如果选定的点是 30, 31, 32, 33 和 34，曲线上的点是 70。</p>\n<p>反之同理，70 是由控制点 60 和 61 定义的贝塞尔曲线上的点。它也可以是由 50, 51 和 52 控制点定义的曲线上的点，也可以是由 40, 41, 42 和 43 控制点定义的曲线上的点。</p>\n<p>如此我们就可以自底向上的计算每一项$P_{i,j}$，以蓝色三角形为例，先计算最左列的$P_{0,2},P_{0,3},P_{0,4},P_{0,5}$，再计算第二列的$P_{1,2},P_{1,3},P_{1,4},P_{0,5}$，再计算第三列的$P_{2,2},P_{2,3}$，再计算最终点$P_{3,2}$，这样可以避免自定向下计算带来的重复项计算的问题。</p>\n<h2 id=\"贝塞尔曲线的导数\"><a href=\"#贝塞尔曲线的导数\" class=\"headerlink\" title=\"贝塞尔曲线的导数\"></a>贝塞尔曲线的导数</h2><h3 id=\"贝塞尔曲线的导数仍然是贝塞尔曲线\"><a href=\"#贝塞尔曲线的导数仍然是贝塞尔曲线\" class=\"headerlink\" title=\"贝塞尔曲线的导数仍然是贝塞尔曲线\"></a><strong>贝塞尔曲线的导数仍然是贝塞尔曲线</strong></h3><p>要在贝塞尔曲线上的某点计算切向量和法向量，首先要计算在该点的一阶和二阶导数。</p>\n<p>由 $n + 1$ 个控制点 $P_0, P_1, …, P_n$ 定义的贝塞尔曲线如下：</p>\n<p>$$\\mathbf{C}(u)&#x3D;\\sum_{i&#x3D;0}^nB_{n,i}(u)\\mathbf{P}_i$$</p>\n<p>其中 $B_{n,i}(u)$ 定义如下：</p>\n<p>$$B_{n,i}(u)&#x3D;\\frac{n!}{i!(n-i)!}u^{i}(1-u)^{n-i}$$</p>\n<p>其中控制点$P_{i}$是常数且与变量 $u$ 相互独立，因此，计算贝塞尔曲线的导数 $C’(u)$可以简化为计算 $B_{n,i}(u)$ 的导数。</p>\n<p>通过一些代数操作，我们可以得到：</p>\n<p>$$\\frac{\\mathrm{d}}{\\mathrm{d}u}B_{n,i}(u)&#x3D;B_{n,i}^{\\prime}(u)&#x3D;n(B_{n-1,i-1}(u)-B_{n-1,i}(u))$$</p>\n<p>因此曲线的导数 $C’(u)$为：</p>\n<p>$$\\frac{\\mathrm{d}}{\\mathrm{d}u}\\mathbf{C}(u)&#x3D;\\mathbf{C}’(u)&#x3D;\\sum_{i&#x3D;0}^{n-1}B_{n-1,i}(u){n(\\mathbf{P}_{i+1}-\\mathbf{P}_i)}$$</p>\n<p>设 :</p>\n<p>$$Q_0 &#x3D; n(P_1 - P_0)$$<br>$$Q_1 &#x3D; n(P_2 - P_1)$$<br>$$Q_2 &#x3D; n(P_3-P_2)$$<br>$$Q_{n-1} &#x3D; n(P_n - P_{n-1})$$</p>\n<p>上述方程简化为以下形式：</p>\n<p>$$\\mathbf{C}^{\\prime}(u)&#x3D;\\sum_{i&#x3D;0}^{n-1}B_{n-1,i}(u)\\mathbf{Q}_{i}$$</p>\n<p><strong>结论：可以看出贝塞尔曲线 的导数$C’(u)$是由 $n$ 个控制点 $n(P_1 - P_0)$, $n(P_2 - P_1)$, $n(P_3 - P_2)$, …, $n(P_n - P_{n-1})$ 定义的 $n - 1$ 次贝塞尔曲线。</strong></p>\n<p>这个导数曲线通常被称为原贝塞尔曲线的<strong>轨迹图</strong>。</p>\n<p>注意，$P_{i+1} - P_i$ 是从 $P_i$ 到 $P_{i+1}$ 的方向向量，而 $n (P_{i+1} - P_i)$ 是该方向向量的 $n$ 倍长。下面左图显示了一个7次贝塞尔曲线，右图显示了其导数，是一个6次贝塞尔曲线。</p>\n<p><img src=\"b-curve-3.jpg\" alt=\"img\">  <img src=\"b-hodo-3.jpg\" alt=\"img\"></p>\n<h3 id=\"贝塞尔曲线与其第一条和最后一条边相切\"><a href=\"#贝塞尔曲线与其第一条和最后一条边相切\" class=\"headerlink\" title=\"贝塞尔曲线与其第一条和最后一条边相切\"></a><strong>贝塞尔曲线与其第一条和最后一条边相切</strong></h3><p>令$u &#x3D; 0$和$u &#x3D; 1$，可以得到：</p>\n<p>​                    $$C’(0) &#x3D; n(P_1 - P_0)$$         $$C’(1) &#x3D; n(P_n - P_{n-1})$$</p>\n<p>第一个公式意味着在$u &#x3D; 0$时的切向量方向是$P_1 - P_0$乘以$n$。因此，指示方向的第一条边与贝塞尔曲线相切。<br>第二个公式意味着在$u &#x3D; 1$时的切向量方向是$P_n - P_{n-1}$乘以$n$。因此，指示方向的最后一条边与贝塞尔曲线相切。下图很好地展示了这个属性。</p>\n<p><img src=\"b-curve-1-17098603594523.jpg\" alt=\"img\">  <img src=\"b-curve-4.jpg\" alt=\"img\"></p>\n<h3 id=\"用-C-1-连续性连接两个贝塞尔曲线\"><a href=\"#用-C-1-连续性连接两个贝塞尔曲线\" class=\"headerlink\" title=\"用$C^1$连续性连接两个贝塞尔曲线\"></a><strong>用$C^1$连续性连接两个贝塞尔曲线</strong></h3><p>利用贝塞尔曲线与其第一条和最后一条边相切的这个特性，可以将两条或更多的贝塞尔曲线连接起来，组合成我们想要的形状。</p>\n<p>设第一条曲线$C(u)$由$m + 1$个控制点$P_0, P_1, P_2, …, P_m$定义，<br>设第二条曲线$D(u)$由$n + 1$个控制点$Q_0, Q_1, Q_2, …, Q_n$定义，<br>如果我们想要将这两条贝塞尔曲线连接起来，那么$P_m$必须等于$Q_0$，这保证了$C^0$级连续</p>\n<p>第一条曲线与其最后一条边相切，第二条曲线与其第一条边相切。因此，为了实现平滑过渡，$P_{m-1}$，$P_m &#x3D; Q_0$和$Q_1$四个点必须在同一直线上，使得从$P_{m-1}$到$P_m$的方向与从$Q_0$到$Q_1$的方向相同，如下图所示：</p>\n<p><img src=\"join-rel.jpg\" alt=\"img\"></p>\n<p>以这种方式连接两个贝塞尔曲线看起来很平滑，但它仍然是$C^0$连续，而不是$C^1$连续。但是，它满足$G^1$连续（具有相同的切向量方向，但切向量大小不相等）。<br>为了保证$C^1$连续性，我们必须确保第一条曲线在$u &#x3D; 1$处的切向量$C’(1)$，与第二条曲线在$u &#x3D; 0$处的切向量$D’(0)$，是等的。也就是说，必须满足以下关系：</p>\n<p>$$\\mathbf{C}^{\\prime}(1)&#x3D;m(\\mathbf{P}<em>m-\\mathbf{P}</em>{m-1})&#x3D;\\mathbf{D}^{\\prime}(0)&#x3D;n(\\mathbf{Q}_1-\\mathbf{Q}_0)$$</p>\n<p>这个关系说明要在连接点保证$C^1$连续性，第一条曲线的最后一条边的长度（即$|p_m - p_{m-1}|$）与第二条曲线的第一条边的长度（即$|q_1 - q_0|$）的比例必须是$n&#x2F;m$。由于度数$m$和$n$是固定的，我们可以调整$p_{m-1}$或$q_1$在同一直线上的位置，使得上述关系得到满足。</p>\n<p><img src=\"b-join-1.jpg\" alt=\"img\"> <img src=\"b-join-2.jpg\" alt=\"img\"></p>\n<p>上面左图中为两条贝塞尔曲线连接而成，其中<strong>浅色的折线</strong>定义了一条4次贝塞尔曲线，而<strong>深色的折线</strong>定义了一条5次贝塞尔曲线。<br>由于第一条曲线的最后一段和第二条曲线的第一段不在同一直线上，所以这两条曲线并未平滑相接。<br>上面右图展示了在连接点处与一条直线相切的两条贝塞尔曲线。然而，它们并不是$C^1$连续的。左边的曲线是4次的，而右边的曲线是7次的。<br>但是，左曲线的最后一段与第二条曲线的第一段的比例看起来接近1，它们是$G^1$连续的而不是$C^1$连续的。为了实现$C^1$连续性，我们应该增加左曲线的最后段的长度（或者减少右曲线的第一段的长度），使其比例接近$7&#x2F;4&#x3D;1.75$，从而满足$C^1$连续</p>\n<h3 id=\"构造闭合的贝塞尔曲线\"><a href=\"#构造闭合的贝塞尔曲线\" class=\"headerlink\" title=\"构造闭合的贝塞尔曲线\"></a>构造闭合的贝塞尔曲线</h3><p>利用上面的这种切线性质，如果让第一个和最后一个控制点相同（即$P_0 &#x3D; P_n$）并且$P_1, P_0$和$P_{n-1}$共线，那么生成的贝塞尔曲线将是一个封闭曲线，并且在连接点处是$G^1$连续的。</p>\n<p>如果要在$P_0$处达到$C^1$连续性，必须使 $P_1-P_0&#x3D;P_n-P_{n-1}$（即曲线的第一段和最后一段有相同的长度并且$P_1, P_0 &#x3D; P_n, P_{n-1}$共线）</p>\n<p><img src=\"b-close-1.jpg\" alt=\"img\"></p>\n<h3 id=\"导数与de-Casteljau算法之间的关系\"><a href=\"#导数与de-Casteljau算法之间的关系\" class=\"headerlink\" title=\"导数与de Casteljau算法之间的关系\"></a><strong>导数与de Casteljau算法之间的关系</strong></h3><p>重新改写一下贝塞尔曲线的导数形式：</p>\n<p>$$\\begin{aligned}<br>\\mathrm{C}^{\\prime}(u)&amp;&#x3D;\\sum_{i&#x3D;0}^{n-1}B_{n-1,i}(u){n(\\mathbf{P}<em>{i+1}-\\mathbf{P}<em>i)}  \\<br>&amp;&#x3D;n\\left[\\left(\\sum</em>{i&#x3D;0}^{n-1}B</em>{n,i}(u)\\mathbf{P}<em>{i+1}\\right)-\\left(\\sum</em>{i&#x3D;0}^{n-1}B_{n,i}(u)\\mathbf{P}_{i}\\right)\\right]<br>\\end{aligned}$$</p>\n<p>贝塞尔曲线的导数可以看作是两条$n-1$次贝塞尔曲线的差<br>现在让这两条曲线分别为$C_1(u)$和$C_2(u)$：</p>\n<p>$$\\quad{C}<em>1(u)&#x3D;\\sum\\limits</em>{i&#x3D;0}^{n-1}B_{n,i}(u)\\mathbf{P}<em>{i+1}\\newline{C}<em>2(u)&#x3D;\\sum\\limits</em>{i&#x3D;0}^{n-1}B</em>{n,i}(u)\\mathbf{P}_i$$</p>\n<p>根据上面定义，可以知道第一条曲线$C_1(u)$由控制点$P_1, P_2, …, P_n$定义，第二条曲线$C_2(u)$由控制点$P_0, P_1, …, P_{n-1}$定义，因此，原曲线的导数定义为：</p>\n<p>$$\\mathbf{C}^{\\prime}(u)&#x3D;n(\\mathbf{C}_1(u)-\\mathbf{C}_2(u))$$</p>\n<p>为了计算贝塞尔曲线的导数$C’(u)$，可以先使用de Casteljau算法计算$C_1(u)$和$C_2(u)$的值，然后，再计算它们的差，乘以n就得到了$C’(u)$。</p>\n<p><strong>计算$C_1(u)$和$C_2(u)$：</strong></p>\n<p>如下图，最左侧的列有所有给定的控制点，点$n0$代表原始贝塞尔曲线上的点$C(u)$，点$(n-1)0$和$(n-1)1$连成的线段是用来插值获取点$n0$的控制折线，即点$n0$位于$(n-1)0$和$(n-1)1$的线段上，并以$u:1-u$的比例将其分割。</p>\n<p><img src=\"b-tangent.jpg\" alt=\"img\"></p>\n<p>由于曲线$C_1(u)$由控制点$01, 02, …, 0n$定义，因此点$(n-1)1$是曲线$C_1(u)$上的点。同样地，由于$C_2(u)$由控制点$00, 01, …, 0(n-1)$定义，因此点$(n-1)0$是曲线$C_2(u)$上的点，向量$C_1(u) - C_2(u)$表示从点 $(n-1)0$ 到点 $(n-1)1$ 的向量，而原贝塞尔曲线的导数$C’(u)$的是$n$倍的$C_1(u) - C_2(u)$。</p>\n<p>这说明，从 $(n-1)0$ 到 $(n-1)1$ 的线段与$C(u)$处的切线向量方向相同，它在$C(u)$处与曲线相切！</p>\n<p><strong>结论：de Casteljau算法迭代中的最后一条折线，实际上是一条线段，在$C(u)$处与贝塞尔曲线相切。</strong></p>\n<p>下图是一个例子，所示的点为$u &#x3D; 0.5$处。显然，de Casteljau迭代过程中的最后一条折线段在$C(0.5)$处与曲线相切。</p>\n<p><img src=\"b-tangent-curve.jpg\" alt=\"img\"></p>\n<h3 id=\"计算贝塞尔的高阶导数\"><a href=\"#计算贝塞尔的高阶导数\" class=\"headerlink\" title=\"计算贝塞尔的高阶导数\"></a><strong>计算贝塞尔的高阶导数</strong></h3><p>$C(u)$的一阶导数如下：</p>\n<p>$$\\mathbf{C}^{\\prime}(u)&#x3D;\\sum_{i&#x3D;0}^{n-1}B_{n-1,i}(u)\\mathbf{Q}_i$$</p>\n<p>将导数公式应用于上述贝塞尔曲线，得到以下结果，给出了原始贝塞尔曲线的二阶导数：</p>\n<p>$$\\begin{aligned}<br>\\mathbf{C}^{\\prime\\prime}&amp;&#x3D;\\sum_{i&#x3D;0}^{n-2}B_{n-2,i}(u){(n-1)(\\mathbf{Q}<em>{i+1}-\\mathbf{Q}<em>i)}\\<br>&amp;&#x3D;\\sum</em>{i&#x3D;0}^{n-2}B</em>{n-2,i}(u){n(n-1)(\\mathbf{P}<em>{i+2}-2\\mathbf{P}</em>{i+1}+\\mathbf{P}_i)}<br>\\end{aligned}$$</p>\n<p>为了简洁地表达高阶导数，可以使用有限差分的方式。定义$D_{i}^0$为控制点$P_i$本身，其中$0 \\leq i \\leq n$。定义第一层差分$D_{i}^1$为前一层的差分，如下：</p>\n<p>$$\\begin{aligned}<br>\\mathbf{D}_{0}^{1}&amp;&#x3D;\\text{ D}_1^0-\\mathbf{D}<em>0^0&#x3D;\\mathbf{P}<em>1-\\mathbf{P}<em>0  \\<br>\\mathrm{D}</em>{1}^{1}&amp;&#x3D;\\text{ D}<em>2^0-\\mathbf{D}<em>1^0&#x3D;\\mathbf{P}<em>2-\\mathbf{P}<em>1  \\<br>&amp;\\vdots \\<br>\\mathbf{D}</em>{n-2}^{1}&amp;&#x3D;\\text{ D}</em>{n-1}^0-\\mathbf{D}</em>{n-2}^0&#x3D;\\mathbf{P}</em>{n-1}-\\mathbf{P}</em>{n-2}  \\<br>\\mathbf{D}</em>{n-1}^{1}&amp;&#x3D;\\text{ D}<em>n^0-\\mathbf{D}</em>{n-1}^0&#x3D;\\mathbf{P}<em>n-\\mathbf{P}</em>{n-1}<br>\\end{aligned}$$</p>\n<p>第一层差分只有$n$个点，比给定的控制点少一个，简写一下，第一层的差分如下所示：</p>\n<p>$$\\mathbf{D}<em>i^1&#x3D;\\mathbf{D}</em>{i+1}^0-\\mathbf{D}_i^0\\quad0\\leq i\\leq n-1$$</p>\n<p>第二层差分被定义为第一层点的差分：</p>\n<p>$$\\mathbf{D}<em>i^2&#x3D;\\mathbf{D}</em>{i+1}^1-\\mathbf{D}_i^1\\quad0\\le i\\le n-2$$</p>\n<p>这个第二层差分有$n-1$个点。重复这个过程，我们可以定义第$k$层差分如下。第$k$层差分有$n-k+1$个点。</p>\n<p>$$\\mathrm D_i^k&#x3D;\\mathrm D_{i+1}^{k-1}-\\mathrm D_i^{k-1}\\quad0\\leq i\\leq n-k$$</p>\n<p>有了这些定义，可以简洁地表达更高阶的导数。首先，让我们使用$D_{i}^1$重新写下$C’(u)$：</p>\n<p>$$\\begin{aligned}<br>\\mathbf{C}^{\\prime}(u)&amp;&#x3D;n\\sum_{i&#x3D;0}^{n-1}B_{n-1,i}(u)(\\mathbf{P}<em>{i+1}-\\mathbf{P}</em>{i})  \\<br>&amp;&#x3D;n\\sum_{i&#x3D;0}^{n-1}B_{n-1,i}(u)(\\mathbf{D}<em>{i+1}^0-\\mathbf{D}<em>i^0) \\<br>&amp;&#x3D;n\\sum</em>{i&#x3D;0}^{n-1}B</em>{n-1,i}(u)\\mathbf{D}_i^1<br>\\end{aligned}$$</p>\n<p>将导数应用于$C’(u)$来计算$C’’(u)$，得到了一个使用$D_{i}^2$表示$C’’(u)$的公式：</p>\n<p>$$\\begin{aligned}<br>\\mathbf{C}’’(u)&amp;&#x3D;n(n-1)\\sum_{i&#x3D;0}^{n-2}B_{n-2,i}(u)(\\mathbf{D}<em>{i+1}^1-\\mathbf{D}<em>i^1)\\<br>&amp;&#x3D;n(n-1)\\sum</em>{i&#x3D;0}^{n-2}B</em>{n-2,i}(u)\\mathbf{D}_i^2<br>\\end{aligned}$$</p>\n<p>对$C’’(u)$做同样的处理，我们得到了一个使用$D_{i}^3$表示$C’’’(u)$的公式：</p>\n<p>$$\\begin{aligned}<br>\\mathbf{C}^{\\prime\\prime\\prime}(u)&amp;&#x3D;n(n-1)(n-2)\\sum_{i&#x3D;0}^{n-3}B_{n-3,i}(u)(\\mathbf{D}<em>{i+1}^2-\\mathbf{D}<em>i^2)\\<br>&amp;&#x3D;n(n-1)(n-2)\\sum</em>{i&#x3D;0}^{n-3}B</em>{n-3,i}(u)\\mathbf{D}_i^3<br>\\end{aligned}$$</p>\n<p>继续这个过程，我们可以计算出第$k$阶导数$C^{(k)}(u)$使用$D_{i}^k$的表示形式：</p>\n<p>$$\\begin{aligned}<br>\\mathbf{C}^{[k]}(u)&amp;&#x3D;n(n-1)(n-2)\\cdots(n-k+1)\\sum_{i&#x3D;0}^{n-k}B_{n-k,i}(u)(\\mathbf{D}<em>{i+1}^{k-1}-\\mathbf{D}</em>{i}^{k-1})\\<br>&amp;&#x3D;n(n-1)(n-2)\\cdots(n-k+1)\\sum_{i&#x3D;0}^{n-k}B_{n-k,i}(u)\\mathbf{D}_{i}^{k}<br>\\end{aligned}$$</p>\n<p>因此，要在特定的$u$处计算$C(u)$的第$k$阶导数，我们首先计算$D_{i}^k$的值，然后应用de Casteljau算法计算由$D_{i}^k$定义的贝塞尔曲线上对应于$u$的点。</p>\n<p>如下图所示，我们已有第0列所有$D_{i}^0$的值（即控制点本身），然后使用两两差分来计算第1列的$D_{i}^1$的值。重复这个过程直到我们达到如下所示的第$k$列：</p>\n<p><img src=\"b-high-der-diagram.jpg\" alt=\"img\"></p>\n<p>最后，使用de Casteljau算法计算出第$k$列点的$B_{n-k,i}(u)$的值，与$D_{i}^k$相乘后累加，再将结果乘以$n(n-1)(n-2)…(n-k+1)$，就得到了$C^{(k)}(u)$的值！</p>\n<h2 id=\"贝塞尔曲线的拆分\"><a href=\"#贝塞尔曲线的拆分\" class=\"headerlink\" title=\"贝塞尔曲线的拆分\"></a>贝塞尔曲线的拆分</h2><p><strong>曲线拆分</strong>的过程是将一个贝塞尔曲线在特定点$C(u)$处一分为二，每一部分仍然是贝塞尔曲线。分割后的每段曲线都需要一套新的控制点来描述其形状，原有的控制点将不再适用。此外，由于原始贝塞尔曲线的阶次是$n$，被切割成两部分后，每个部分都是原贝塞尔曲线的子集，因此得到的新贝塞尔曲线的阶次也必须是$n$。</p>\n<p>假设我们$n + 1$个控制点$P_0, P_1, P_2, …, P_n$，参数 $0\\leq u\\leq1$，目标是找到两组新的$n+1$个控制点$Q_0, Q_1, Q_2, …, Q_n$和$R_0, R_1, R_2, …, R_n$。</p>\n<p>这两组控制点各自定义的贝塞尔曲线分别对应原始曲线在$[0,u]$和$[u,1]$区间的部分。</p>\n<p>虽然正确性证明有点繁琐，但实际上算法非常简单。事实上，de Casteljau 的算法用于计算曲线上点 $C(u)$ 时已经提供了所有必要的信息。在下面的左图中，展示了用 de Casteljau 算法计算 $C(u)$ 的所有中间步骤，右图显示了在点 $C(u)$ 处曲线拆分后的形状及相应的控制折线。</p>\n<p><img src=\"b-sub-master.jpg\" alt=\"img\"> <img src=\"b-sub-result.jpg\" alt=\"img\"></p>\n<p>仔细比较这两幅图，左图中，<strong>左半段</strong>贝塞尔曲线的控制点由$P_{00}&#x3D;P_0, P_{10},P_{20},P_{30},P_{40},P_{50}$和$P_{60} &#x3D; C(u)$组成<br><strong>右半段</strong>贝塞尔曲线的控制点由点$P_{60}&#x3D;C(u),P_{51},P_{42},P_{33},P_{24},P_{15}$和$P_{06} &#x3D; P_6$组成。<br>下图展示了这些点：</p>\n<p><img src=\"b-sub-left.jpg\" alt=\"img\"><img src=\"b-sub-right.jpg\" alt=\"img\"></p>\n<p>回想一下de Casteljau算法的三角形计算方案：对于给定的$u$，计算$C(u)$需要$n$次迭代，在计算过程中，可以收集每列的第一个点和最后一个点，并且最终，第一个点（或最后一个点）的集合对应于原始曲线在$[0,u]$（或$[u,1]$）上定义的片段。</p>\n<p>因此，在下面的三角形方案中，箭头指向的顶边(红色：$00,10,20,30,40,50,60$)和箭头相反方向的底边(蓝色：$60,51,42,33,24,15,06$)分别对应位第一段曲线和第二段曲线段的控制点。有了控制点，也就可以得出拆分后的两段贝塞尔曲线（可以重新计算获得）</p>\n<p><img src=\"b-sub-chart.jpg\" alt=\"img\"></p>\n<p>注意：点$50$和$51$定义的线段在点$60$处与曲线相切（见上图），即左曲线的最后一段（即线段$50-60$）与左曲线相切，右曲线的第一段（即线段$60-51$）与右曲线相切。</p>\n<p><strong>曲线拆分为何至关重要？</strong><br>曲线拆分的应用范围广泛。例如，它可以被用来找出两个贝塞尔曲线的交汇点、对贝塞尔曲线进行渲染，以及简化曲线设计过程。设想我们设计了一条曲线，却发现它并不完全符合我们的预期。在这种情形下，我们可能会考虑在某些特定的点上将曲线分割为两个部分：一个部分达到了我们的满意度，而另一部分则没有。接下来，我们可以忽略掉那部分我们已经满意的，将注意力集中在仍需改进的部分上。</p>\n<h2 id=\"贝塞尔曲线的升阶\"><a href=\"#贝塞尔曲线的升阶\" class=\"headerlink\" title=\"贝塞尔曲线的升阶\"></a>贝塞尔曲线的升阶</h2><p>不改变贝塞尔曲线的形状，同时增加贝塞尔曲线的度数（即阶数&#x2F;次数），称为<strong>贝塞尔曲线的升阶</strong>。</p>\n<p>假设我们有一个由 $n+1$个控制点$P_0, P_1, P_2, …, P_n$定义的$n$阶贝塞尔曲线，我们希望将这个曲线的度数提升到$n + 1$而不改变其形状。由于$n + 1$阶贝塞尔曲线需要由$n + 2$个控制点定义，因此，我们需要找到一个新的控制点集，显然，$P_0$ 和 $P_n$ 必须在新控制点集中，因为贝塞尔曲线会通过首尾控制点，曲线升阶不改变曲线的形状。因此，我们需要$n$个新的控制点，假设新的控制点集为 $Q_0, Q_1, Q_2, …, Q_{n+1}$，根据上述要求有，$Q_0 &#x3D; P_0$ 和 $Q_{n+1} &#x3D; P_n$。其他控制点的计算方式如下：</p>\n<p>$$\\mathbf{Q}<em>i&#x3D;\\frac{i}{n+1}\\mathbf{P}</em>{i-1}+\\left(1-\\frac{i}{n+1}\\right)\\mathbf{P}_i\\quad1\\le i\\le n$$</p>\n<p>以下是从$Q_1$到$Q_n$每个控制点的公式：</p>\n<p>$$\\begin{aligned}<br>\\mathbf{Q}_1&amp;&#x3D;\\frac{1}{n+1}\\mathbf{P}_0+\\left(1-\\frac{1}{n+1}\\right)\\mathbf{P}_1\\<br>\\mathbf{Q}_2&amp;&#x3D;\\frac{2}{n+1}\\mathbf{P}_1+\\left(1-\\frac{2}{n+1}\\right)\\mathbf{P}_2\\<br>\\mathbf{Q}<em>3&amp;&#x3D;\\frac{3}{n+1}\\mathbf{P}<em>2+\\left(1-\\frac{3}{n+1}\\right)\\mathbf{P}<em>3\\<br>&amp;\\vdots\\<br>\\mathbf{Q}</em>{n-1}&amp;&#x3D;\\frac{n-1}{n+1}\\mathbf{P}</em>{n-2}+\\left(1-\\frac{n-1}{n+1}\\right)\\mathbf{P}</em>{n-1}\\<br>\\mathbf{Q}<em>n&amp;&#x3D;\\frac{n}{n+1}\\mathbf{P}</em>{n-1}+\\left(1-\\frac{n}{n+1}\\right)\\mathbf{P}_n<br>\\end{aligned}$$</p>\n<p>原始多段线的每一段上正好会有一个新的控制点。即：线段$P_{i-1}P_i$ 包含新控制点$Q_i$。</p>\n<p>在de Casteljau算法中，线段$AB$上一点$C$，将$AB$按比例 $u:1-u$ 分割，可以写作 $C &#x3D; (1 - u)A + uB$。在上式中，$Q_i$将线段$P_{i-1}P_i$  按比例 $1-\\frac{i}{n+1}:\\frac{i}{n+1}$ 分割。这个比例不是一个常数，而是随着 i 的值变化的，但与de Casteljau算法很相似</p>\n<p>获得了新的控制点集后，原控制点集就可以弃用。由于原始控制多段线的每一段都包含一个新控制点，用新控制点集合替换旧控制点集合的过程可以看作是在原始控制点处切掉角。</p>\n<p>见下图，图中显示了一个4度贝塞尔曲线，控制点以红色矩形显示，控制多段线以虚线显示。将其度数增加到5后，新的控制多段线以实线段显示。显然，所有角都被切掉了。下表给出了原始控制多段线上每一段的比例。</p>\n<table>\n<thead>\n<tr>\n<th>i</th>\n<th>1 - i&#x2F;(n+1)</th>\n<th>i&#x2F;(n+1)</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>1</td>\n<td>0.8</td>\n<td>0.2</td>\n</tr>\n<tr>\n<td>2</td>\n<td>0.6</td>\n<td>0.4</td>\n</tr>\n<tr>\n<td>3</td>\n<td>0.4</td>\n<td>0.6</td>\n</tr>\n<tr>\n<td>4</td>\n<td>0.2</td>\n<td>0.8</td>\n</tr>\n</tbody></table>\n<p><img src=\"bezier-cut-corner.jpg\" alt=\"img\"></p>\n<p>随着曲线度数的增加，控制点的数量也会增加。并且，新的控制多边形会逐渐向曲线靠拢。在下面的图形中，我们从一个度数为6、控制点为7个的贝塞尔曲线开始，然后，其度数增加到7、8、10、15和29。从图中可以看出，随着度数的增加，曲线的形状没有改变，控制多边形越来越接近曲线。最终，随着度数不断增加到无限，控制多边形将趋向于曲线，曲线则相当于控制多边形的一个极限位置。</p>\n<p><img src=\"b-elev-06.jpg\" alt=\"img\"><img src=\"b-elev-07.jpg\" alt=\"img\"><img src=\"b-elev-08.jpg\" alt=\"img\"><img src=\"b-elev-10.jpg\" alt=\"img\"><img src=\"b-elev-15.jpg\" alt=\"img\"><img src=\"b-elev-29.jpg\" alt=\"img\"></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>总的来说，要定义一个$n$阶的贝塞尔曲线，我们需要在空间中选择$n+1$个控制点，这些点大致描述了所需曲线的形状。</p>\n<p>然后，如果它不符合我们的期望，我们可以移动控制点。随着一个或多个控制点的移动，贝塞尔曲线的形状相应地发生变化。但是，曲线始终位于由控制点定义的凸包内（<strong>凸包性质</strong>），并且生成的曲线形状比控制多边形简单（<strong>变差减少性质</strong>）。</p>\n<p>除此之外，贝塞尔曲线还具有<strong>非负性</strong>、<strong>单位分割</strong>、<strong>仿射不变性</strong>、<strong>递归性</strong>等性质。贝塞尔曲线不具备<strong>局部修改性</strong>，移动控制点将会全面改变贝塞尔曲线的形状，这也是其逐渐被<strong>样条曲线</strong>和<strong>Nurbs曲线</strong>取代的原因。</p>\n<p>详细介绍了<strong>De Casteljau算法</strong>，用于计算任意参数位置时，对应的贝塞尔曲线上一点，这是一种<strong>自底向上</strong>的<strong>三角形计算方案</strong>，能够避免<strong>自顶向下</strong>计算方案递归调用时带来的不必要的性能开销。</p>\n<p>还介绍了<strong>贝塞尔曲线导数</strong>的性质，如何将两个<strong>贝塞尔曲线连接</strong><em>在一起并保证连接点处$C^1$连续，如何构造<strong>闭合的贝塞尔曲线</strong>以及计算*<em>高阶贝塞尔导数</em></em>。</p>\n<p>最后还介绍了贝塞尔曲线的<strong>拆分</strong>和<strong>升阶</strong>方法，这个早期在工程中也是具有很大的应用。</p>\n<h2 id=\"文献引用\"><a href=\"#文献引用\" class=\"headerlink\" title=\"文献引用\"></a>文献引用</h2><ul>\n<li>Gerald Farin, <em>Curves and Surfaces for CAGD: A Practical Guide</em>, fourth edition, Academic Press, 1997.</li>\n<li>Josef Hoschek and Dieter Lasser, <em>Fundamentals of Computer Aided Geometric Design</em>, translated from the German 1989 edition by Larry L. Schumaker, A K Peters, 1993.</li>\n<li>Les Piegl and Wayne Tiller, <em>The NURBS Book</em>, second edition, Springer-Verlag, 1997.</li>\n<li>David F. Rogers and J. Alan Adams, <em>Mathematical Elements for Computer Graphics</em>, second edition, McGraw-Hill, 1990.</li>\n</ul>\n<hr>\n<p>后续，将会继续介绍<strong>B样条曲线</strong>和<strong>Nurbs曲线</strong>，这两种类型的曲线会逐渐取代贝塞尔成为工程中的主流曲线定义方式。<strong>To be continued….</strong></p>\n","excerpt":"","more":"<h1 id=\"Bezier曲线\"><a href=\"#Bezier曲线\" class=\"headerlink\" title=\"Bezier曲线\"></a>Bezier曲线</h1><p>贝塞尔曲线于 1962 年，由法国工程师皮埃尔·贝济埃（Pierre Bézier）所广泛发表，他运用贝塞尔曲线来为汽车的主体进行设计,贝塞尔曲线最初由保尔·德·卡斯特里奥于1959年运用德卡斯特里奥算法开发，以稳定数值的方法求出贝塞尔曲线.</p>\n<p><strong>先从几个简单的例子开始：</strong></p>\n<h2 id=\"一阶贝塞尔曲线\"><a href=\"#一阶贝塞尔曲线\" class=\"headerlink\" title=\"一阶贝塞尔曲线\"></a>一阶贝塞尔曲线</h2><img src=\"v2-770487eacf3b9d5973e2783b6d8698e5_r.jpg\" alt=\"img\" style=\"zoom: 33%;\" />\n\n<p>对于一阶贝塞尔曲线为我们可以看到是一条直线，通过几何知识，很容易根据t的值得出线段上那个点的坐标。</p>\n<p>给定点 $P_0$、$P_1$，线性贝塞尔曲线只是一条两点之间的直线。这条线由下式给出：</p>\n<p>$$\\mathbf{B}(t)&#x3D;\\mathbf{P}_0+(\\mathbf{P}_1-\\mathbf{P}_0)t&#x3D;(1-t)\\mathbf{P}_0+t\\mathbf{P}_1,t\\in[0,1]$$</p>\n<p>一阶曲线就是很好理解, 就是根据t来的线性插值。$P_0$表示的是一个向量 $[x ,y]$, 其中$x$和$y$是分别按照这个公式来计算的。</p>\n<h2 id=\"二阶贝塞尔曲线\"><a href=\"#二阶贝塞尔曲线\" class=\"headerlink\" title=\"二阶贝塞尔曲线\"></a>二阶贝塞尔曲线</h2><img src=\"image-20230715134335693.png\" alt=\"image-20230715134335693\" style=\"zoom: 50%;\" />\n\n<img src=\"image-20230715134422584.png\" alt=\"image-20230715134422584\" style=\"zoom: 50%;\" />\n\n<p>在平面内任选 3 个不共线的点，依次用线段连接。在第一条线段上任选一个点 $D$。计算该点到线段起点的距离$AD$，与该线段总长$AB$的比例。</p>\n<img src=\"image-20230715134508818.png\" alt=\"image-20230715134508818\" style=\"zoom: 50%;\" />\n\n<p>根据上一步得到的比例，从第二条线段上找出对应的点 $E$，使得 $AD:AB &#x3D; BE:BC$</p>\n<img src=\"image-20230715134543049.png\" alt=\"image-20230715134543049\" style=\"zoom:50%;\" />\n\n<img src=\"image-20230715134555599.png\" alt=\"image-20230715134555599\" style=\"zoom:50%;\" />\n\n<p>这时候$DE$又是一条直线了, 就可以按照一阶的贝塞尔方程来进行线性插值了：</p>\n<p>$$t&#x3D; AD:AE$$</p>\n<p>这时候就可以推出公式了：</p>\n<p><img src=\"B%C3%A9zier_2_big.gif\" alt=\"img\"></p>\n<p>$$P_0&#x3D;(1-t)P_0+tP_1$$</p>\n<p>$$P_1&#x3D;(1-t)P_1+tP_2$$</p>\n<p>整理一下公式, 得到二阶贝塞尔公式：</p>\n<p>$$\\mathbf{B}(t) &#x3D;(1-t)^{2}\\mathbf{P}<em>{0}+2t(1-t)\\mathbf{P}</em>{1}+t^{2}\\mathbf{P}_{2},t\\in[0,1]$$</p>\n<h2 id=\"三阶贝塞尔曲线\"><a href=\"#三阶贝塞尔曲线\" class=\"headerlink\" title=\"三阶贝塞尔曲线\"></a>三阶贝塞尔曲线</h2><img src=\"image-20230715135427376.png\" alt=\"image-20230715135427376\" style=\"zoom:50%;\" />\n\n<p>四个点对应是三次的贝塞尔曲线. 分别在 $AB$、$BC$、$CD$ 之间采$EFG$点, $EFG$三个点对应着二阶贝塞尔, 在$EF$、$FG$之间采集$H$、$I$点来降阶为一阶贝塞尔曲线.</p>\n<p>公式：</p>\n<p>$$\\mathbf{B}(t)&#x3D;\\mathbf{P}_0(1-t)^3+3\\mathbf{P}_1t(1-t)^2+3\\mathbf{P}_2t^2(1-t)+\\mathbf{P}_3t^3,t\\in[0,1]_0$$</p>\n<p>动画效果</p>\n<p><img src=\"B%C3%A9zier_3_big-168860760518218.gif\" alt=\"img\"></p>\n<h2 id=\"贝塞尔曲线公式\"><a href=\"#贝塞尔曲线公式\" class=\"headerlink\" title=\"贝塞尔曲线公式\"></a>贝塞尔曲线公式</h2><p>贝塞尔曲线是通过空间中的$n+1$个点$P_0, P_1, P_2, \\ldots, P_n$来定义的，这些点称为控制点。控制点决定了曲线的形状，贝塞尔曲线定义如下：</p>\n<p>$$\\mathbf{C}(u)&#x3D;\\sum_{i&#x3D;0}^nB_{n,i}(u)\\mathbf{P}_i$$</p>\n<p>其中系数定义如下：</p>\n<p>$$B_{n,i}(u)&#x3D;\\frac{n!}{i!(n-i)!}u^{i}(1-u)^{n-i}$$</p>\n<p>贝塞尔曲线上对应于参数位置为$u$的点，是所有控制点的”加权”平均值，其中权重是系数$B_{n,i}(u)$，其中$u$的定义域为$[0,1]$。函数$B_{n,i}(u), 0 \\leq i \\leq n$被称为<strong>贝塞尔基函数</strong>或<strong>伯恩斯坦多项式</strong>。</p>\n<p>将控制点点$P_0P_1, P_2, \\ldots, P_n$按此顺序连接，我们得到了一个<strong>控制多边形</strong>，它帮助我们描述了曲线的大致形状。</p>\n<p>下图展示了由11个控制点定义的贝塞尔曲线，其中蓝色点是对应于$u&#x3D;0.4$的曲线上的点。如图所示，曲线或多或少地跟随着多边形线。</p>\n<p><img src=\"b-curve-1-17103242022572.jpg\" alt=\"img\"></p>\n<hr>\n<p><strong>问题：当$u$的定义域非[0,1]时如何处理？</strong></p>\n<p>贝塞尔曲线不总是定义在$[0,1]$这一标准区间上，有时其定义域可能为$[a,b]$。在这种情况下，就需要进行变量的转换。我们需要做的是，将$u$从区间$[a,b]$映射到$[0,1]$，然后在基函数中使用转换后的$u$值。具体的转换方法如下：</p>\n<p>$$u’&#x3D;\\frac{u-a}{b-a}$$</p>\n<p>将转换后的$u’$代入到基函数$B_{n,i}(u)$中，可以得到新的公式：</p>\n<p>$$B_{n,i}(u’)&#x3D;\\frac{n!}{i!(n-i)!}\\left(\\frac{u-a}{b-a}\\right)^i\\left(1-\\frac{u-a}{b-a}\\right)^{n-i}$$</p>\n<p>这一变换后的基函数定义了在区间$[a,b]$上的贝塞尔曲线</p>\n<h2 id=\"贝塞尔曲线的特点和性质\"><a href=\"#贝塞尔曲线的特点和性质\" class=\"headerlink\" title=\"贝塞尔曲线的特点和性质\"></a>贝塞尔曲线的特点和性质</h2><ul>\n<li><p><strong>贝塞尔曲线由$n+1$个控制点定义，曲线的度数是$n$</strong>：<br>在每个基函数中，$u$的指数是$i + (n - i) &#x3D; n$。因此，曲线的度数是$n$</p>\n</li>\n<li><p>曲线$C(u)$通过第一个控制点$P_0$和最后一个控制点$P_n$</p>\n</li>\n<li><p><strong>非负性</strong>：所有基函数都是非负的。</p>\n</li>\n<li><p><strong>单位分割</strong>：在任一特定的$u$值下，这些基函数值的总和为1。这保证了曲线上的任一点都是控制点加权平均的结果，且权重总和为1</p>\n<p><img src=\"b-curve-2-17091716014474-17103791115213.jpg\" alt=\"img\"><img src=\"b-pou-1-17091716014476.jpg\" alt=\"img\"></p>\n<p>在上面的左侧图片中，展示了一个基于五个控制点构成的贝塞尔曲线。而右侧的图则展示了作为$u$值函数的五个基函数。</p>\n<p>这些图表揭示了当$u&#x3D;0.5$时，这五个基函数的分布情况。图中最右侧的竖条图清晰地展现了如何将数值1等分为五部分，这就是所谓的<strong>单位分割</strong>。</p>\n<p>所有基函数的取值范围从0到1，它们的总和恰好为1，因此，这些基函数在计算加权平均时充当了权重的角色。更简单地说，计算<strong>C</strong>($u$)时，实际上是将控制点$P_i$按照$B_{n,i}(u)$的权重进行加权汇总。</p>\n</li>\n<li><p><strong>凸包性质</strong></p>\n<p>贝塞尔曲线的一个显著特点是，它完全被其$n + 1$个控制点所形成的凸包所包围。所谓凸包，指的是能够包含一组点集所有点的最小凸形状。</p>\n<p>在下面的示例中，11个控制点形成的凸包以灰色表示。值得注意的是，并不是所有控制点都位于凸包的边缘。比如，控制点3、4、5、6、8和9位于凸包内部。除了起点和终点，曲线始终位于这个凸包之内。</p>\n<p><img src=\"b-curve-1-17103234093711.jpg\" alt=\"img\"></p>\n</li>\n<li><p><strong>变差减少性</strong></p>\n<p>在平面上，这个性质意味着没有任何直线能与贝塞尔曲线相交的次数超过它与曲线的控制多边形相交的次数。</p>\n<p><img src=\"b-variation-17103792438184.jpg\" alt=\"img\"></p>\n<p>如上图所示，黄色直线与曲线相交3次，但与控制多边形相交了7次；<br>红色直线与曲线相交5次，与控制多边形也相交7次；<br>而青色直线与曲线及其控制多边形都只相交两次。<br>你可以尝试绘制其他直线以验证这一性质。</p>\n<p>若曲线是空间中的曲线，则只需将“直线”改为“平面”。</p>\n<p>这一性质的意义何在？它告诉我们，与控制多边形相比，贝塞尔曲线的复杂性（即转弯和扭曲的程度）会更低。换言之，控制多边形相较于它所定义的贝塞尔曲线，会有更频繁的转弯和扭曲，因为任意直线与控制多边形相交的次数总是多于与曲线相交的次数。</p>\n</li>\n<li><p><strong>仿射不变性</strong></p>\n<p>对贝塞尔曲线进行仿射变换时，其变换结果能够通过控制点经过相同变换后的新位置来确定。这一特性极为有利。当我们需要对贝塞尔曲线执行几何或仿射变换操作时，直接对控制点施加变换即可。完成控制点的变换后，由这些调整后的控制点所定义的新贝塞尔曲线即为所求。因此，无需直接对曲线本身进行变换处理。</p>\n</li>\n<li><p><strong>递归性</strong></p>\n<p>递归性指其系数满足下式：<br>$$B_{i,n}(t)&#x3D;(1-t)B_{i,n-1}(t)+tB_{i-1,n-1}(t)【i&#x3D;0,1,\\cdots,n】$$</p>\n</li>\n<li><p><strong>一阶导数性质</strong></p>\n<img src=\"image-20230715142535462.png\" alt=\"image-20230715142535462\" style=\"zoom:50%;\" />\n\n<p>假设上图中贝塞尔的 $t$ 是由左到右从 $0$ 到 $1$ 增加的，那么贝塞尔曲线在 $t&#x3D;0$ 时的导数是和 $P_0P_1$的斜率（导数）是相同，$t&#x3D;1$ 时的导数是和$P_3P_4$ 的斜率（导数）是相同的</p>\n<img src=\"image-20230715142627416.png\" alt=\"image-20230715142627416\" style=\"zoom:50%;\" />\n\n<p>这一点的性质可以用在贝塞尔曲线的拼接，只要保证三点一线中的中间点是两段贝塞尔曲线的连接点，就可以保证两端贝塞尔曲线的导数连续</p>\n</li>\n</ul>\n<h2 id=\"控制点的移动对曲线的影响\"><a href=\"#控制点的移动对曲线的影响\" class=\"headerlink\" title=\"控制点的移动对曲线的影响\"></a>控制点的移动对曲线的影响</h2><p>当我们调整一个贝塞尔曲线的控制点位置时，曲线形状将发生变化。这引出一个问题：<br>\t\t\t\t\t<strong>控制点移动到新的位置时，贝塞尔曲线将如何变形？</strong></p>\n<p>假设控制点 $P_k$ 移动到 $P_k+\\mathbf{v}$ 的新位置，向量 $\\mathbf{v}$ 表示移动的方向和距离。如图所示：</p>\n<p><img src=\"bezier-P+v.jpg\" alt=\"img\"></p>\n<p>原始贝塞尔曲线表示为： $$\\mathbf{C}(u)&#x3D;\\sum_{i&#x3D;0}^nB_{n,i}(u)\\mathbf{P}_i$$</p>\n<p>由于新的贝塞尔曲线是由 $P_0, P_1, …, P_k+\\mathbf{v}, …, P_n$定义的，新的贝塞尔曲线方程 $D(u)$ 可以写成：</p>\n<p>$$\\begin{aligned}<br>\\mathbf{D}(u)&amp;&#x3D;\\sum_{i&#x3D;0}^{k-1}B_{n,i}(u)\\mathbf{P}<em>{i}+B</em>{n,k}(u)(\\mathbf{P}<em>{k}+\\mathbf{v})+\\sum</em>{i&#x3D;k+1}^{n}B_{n,i}(u)\\mathbf{P}<em>{i}  \\<br>&amp;&#x3D;\\sum</em>{i&#x3D;0}^{n}B_{n,i}(u)\\mathbf{P}<em>{i}+B</em>{n,k}(u)\\mathbf{v} \\<br>&amp;&#x3D;\\mathbf{C}(u)+B_{n,k}(u)\\mathbf{v}<br>\\end{aligned}$$</p>\n<p>在上式中，因为只有第 $k$ 项控制点使用了 $P_k+\\mathbf{v}$，所以我们得出新曲线是原始曲线与额外的项 $B_{n,k}(u)\\mathbf{v}$ 的组合。</p>\n<p>因此，新曲线上任一给定 $u$ 对应的点，可以通过将原始曲线上相同位置的点沿向量  $\\mathbf{v}$ 的方向平移 $|B_{n,k}(u)\\mathbf{v}|$ 的距离来获得。</p>\n<p>更具体地来说，对于任意给定的 <em>u</em> 值，原曲线上对应的点为 $C(u)$，新曲线上对应的点为 $D(u)$，且 $D(u) &#x3D; C(u) + B_{n,k}(u)\\mathbf{v}$。</p>\n<p>以下图说明这一变化：<br>                                           <img src=\"bezier-move-ct-pt-1.jpg\" alt=\"img\"></p>\n<p>图中，黑色与红色曲线分别代表由9个控制点定义的同一8次贝塞尔曲线的原始和变形状态。黑色曲线为原始状态。若其中一个控制点沿蓝色向量移动到新位置，黑色曲线便转变为红色曲线。</p>\n<p>图中同时标出了$u&#x3D;0.5$时两条曲线上的对应点。可以明显看出，$C(0.5)$ 沿相同方向移动至 $D(0.5)$。从 $C(0.5)$ 到 $D(0.5)$ 的距离等同于向量 </p>\n<p>​\t\t\t\t\t\t$$B_{8,3}(0.5)\\mathbf{v} &#x3D; \\frac{8!}{(3!(8-3)!)}×0.5^3(1-0.5)^{8-3}\\mathbf{v} &#x3D; 0.22\\mathbf{v}$$</p>\n<p>因此，<strong>该距离约为原始控制点3和下图所示的新控制点3之间距离的22%</strong></p>\n<p>从这一分析中，我们可以得出另一个重要的结论：<br>因为 $B_{n,k}(u)$ 在开区间 $(0,1)$ 内非零，因此 $B_{n,k}(u)\\mathbf{v}$ 在此区间内不是零向量。这意味着除了端点 $C(0)$ 和 $C(1)$ 外，所有原始曲线上的点都会被移动到新的位置上。由此可见：</p>\n<p>​\t\t\t\t\t<strong>移动控制点将会全面改变贝塞尔曲线的形状。</strong></p>\n<h2 id=\"计算贝塞尔曲线上一点：De-Casteljau-算法\"><a href=\"#计算贝塞尔曲线上一点：De-Casteljau-算法\" class=\"headerlink\" title=\"计算贝塞尔曲线上一点：De Casteljau 算法\"></a>计算贝塞尔曲线上一点：De Casteljau 算法</h2><p><strong>在构造 Bézier 曲线后，如何找到曲线上参数为 $u$ 处的点 $C(u)$？</strong></p>\n<p>一种简单的方法是将 $u$ 代入贝塞尔曲线的公式：</p>\n<p>$$\\mathbf{C}(u)&#x3D;\\sum_{i&#x3D;0}^nB_{n,i}(u)\\mathbf{P}_i$$</p>\n<p>其中系数定义如下：</p>\n<p>$$B_{n,i}(u)&#x3D;\\frac{n!}{i!(n-i)!}u^{i}(1-u)^{n-i}$$</p>\n<p>计算每个基函数的值，并计算每个基函数及其对应控制点的乘积，最后将它们相加。虽然这样可以，但不是<strong>数值稳定</strong>的（即在计算伯恩斯坦多项式的过程中可能引入数值误差）。</p>\n<p>还记得本文开始几个小节关于一阶、二阶、三阶贝塞尔曲线的推导过程吗，这就是<strong>De Casteljau 算法</strong>：</p>\n<p>首先，我们以编号的形式记录下控制点，如 $P_0$ 记作 $00$，$P_1$ 记作 $01$，依此类推，直至 $P_n$ 的编号为 $0n$。第一个数字 $0$ 表示第0阶或第一次迭代。在接下来的迭代中，这些数字会变成$1、2、3$ 等。</p>\n<p><strong>De Casteljau 算法的核心在于找到线段 AB 上某个点 $C$，该点按 $u:1-u$ 的比例将线段 $AB$ 划分。从而确立点 $C$ 的具体位置。</strong></p>\n<p><img src=\"point-c.jpg\" alt=\"img\"></p>\n<p>线段$AB$ 的向量可以表示为 $B - A$。由于 $u$ 是介于 $0$ 和$1$ 之间的比例，所以点 $C$ 的位置可以用 $u(B - A)$ 来描述。再加上 $A$ 点的坐标，我们可以得到 $C$ 的准确位置为 </p>\n<p>$$A + u(B - A) &#x3D; (1 - u)A + uB$$</p>\n<p>因此，对于任何给定的 $u$ 值， 我们都能准确地定位在 $A$ 与 $B$ 之间的一点 $C$。</p>\n<p><strong>如何找到贝塞尔曲线上任意一处参数 $u$ 的点 $C(u)$：</strong></p>\n<p>首先将控制点依次连接，得到一个折线：即 $00-01-02-03…-0n$ 多段线，然后根据上述公式在每对相邻控制点之间找到新点 $1i$，这个新点将原线段 $0i-0(i+1)$ 按 $u:1-u$ 的比例分割。通过这种方式，我们可以得到 $n$ 个新点：$10, 11, 12, …, 1(n-1)$，它们共同构成了一条新的折线。</p>\n<p><img src=\"de-casteljau.jpg\" alt=\"img\"></p>\n<p>如上图所示，例如，当 $u &#x3D; 0.4$ 时，通过插值可以得到点$10$位于起始控制点$00$和$01$之间， 其中$\\frac{00-10}{10-01}&#x3D;\\frac{u}{1-u}$ 。($00$即点$0$，$00$中的第一个$0$表示$0$阶，第二个$0$表示第$0$个点。$01$即点$1$，$01$中的第一个$0$表示$0$阶，第二个$1$表示第$1$个点） </p>\n<p>第二次迭代：点$11$位于点$01$和$02$之间，$\\frac{01-11}{11-02}&#x3D;\\frac{u}{1-u}$以此类推，可以计算出点$12、13、14$。这些新产生的点都以蓝色标记。</p>\n<p>每一次迭代，我们获得的”新控制点”的数量都比之前迭代的结果少1，直到最减少到唯一的点$n0$。这一点就是在给定 $u$ 值下，贝塞尔曲线上的对应点 $C(u)$。</p>\n<p>举例：在上图中，<br>点$20$可以通过以 $u:1-u$ 的比例划分线段$10-11$得到，。<br>点$21$通过边$11-12$划分得到<br>点$22$通过边$12-13$划分得到<br>点$23$通过边$13-14$划分得到。<br>从而得到了由点$20,21,22,23$定义的三阶折线。<br>在折线段$20-21-22-23$的两两点之间进行插值，将得到个新的折线段$30-31-32$。继续迭代，将得到点$40$和$41$， 组成新的折线段$40-41$。<br>继续迭代，将得到点$50$，这就是曲线上的点 $C(0.4)$。</p>\n<p><strong>用一张图表示De Casteljau 算法的迭代过程：</strong></p>\n<p><img src=\"de-cast-compute.jpg\" alt=\"img\"></p>\n<p>从初始列，即第 $0$ 列，我们通过两两点之间的插值可以计算出第$1$列的”新点”，从第$1$列我们得到第$2$列，依此类推。最终，在应用了 $n$ 次之后，我们将得到唯一的点 $n0$，这就是贝塞尔曲线上的点$C(u)$。</p>\n<h3 id=\"递归关系：自顶向下的计算方法\"><a href=\"#递归关系：自顶向下的计算方法\" class=\"headerlink\" title=\"递归关系：自顶向下的计算方法\"></a><strong>递归关系：自顶向下的计算方法</strong></h3><p>上述计算可以递归地表达。初始时，令 $P_{0,j}$ 为 $P_j$，其中 $j &#x3D; 0, 1, …, n$。$P_{0,j}$ 表示第 0 列的第 $j$ 项。那么第 $i$ 列的第 $j$ 项的计算如下：</p>\n<p>$$\\left.\\mathbf{P}<em>{i,j}&#x3D;(1-u)\\mathbf{P}</em>{i-1,j}+u\\mathbf{P}_{i-1,j+1}\\quad\\left{\\begin{array}{l}i&#x3D;1,2,\\ldots,n\\j&#x3D;0,1,\\ldots,n-i\\end{array}\\right.\\right.$$</p>\n<p>基于这个公式，可能会立即想到以下递归算法：</p>\n<p>$$function$$ $$deCasteljau(i,j)$$<br>$$if i &#x3D; 0 then$$<br>\t$$return$$ $$P_{0,j}$$<br>$$else$$<br>\t$$return$$ $$(1-u)$$ * $$deCasteljau(i-1,j)$$+  $$u$$ * $$deCasteljau(i-1,j+1)$$</p>\n<p>这个算法看起来简单，但是它极其低效。原因如下。我们从调用 $deCasteljau(n,0)$ 开始，计算 $P_{n,0}$。$else$ 分支将这个调用会递归产生两个新的调用，即$deCasteljau(n-1,0)$ 用于计算 $P_{n-1,0}$ 和 $deCasteljau(n-1,1)$ 用于计算 $P_{n-1,1}$。</p>\n<p><img src=\"de-cast-rec-comp.jpg\" alt=\"img\"></p>\n<p>对 $deCasteljau(n-1,0)$ 的调用。又会产生两个新的调用，$deCasteljau(n-2,0)$ 用于计算 $P_{n-2,0}$ 和 $deCasteljau(n-2,1)$ 用于计算 $P_{n-2,1}$。对 $deCasteljau(n-1,1)$ 的调用也会产生两个新的调用，$deCasteljau(n-2,1)$ 用于计算 $P_{n-2,1}$ 和 $deCasteljau(n-2,2)$ 用于计算 $P_{n-2,2}$。</p>\n<p>因此，$deCasteljau(n-2,1)$ 被调用了两次。依次类推，会发现计算 $P_{i,j}$ 的函数被重复调用了，这是对性能非常浪费的。</p>\n<h3 id=\"三角形计算方案：自底向上的计算方法\"><a href=\"#三角形计算方案：自底向上的计算方法\" class=\"headerlink\" title=\"三角形计算方案：自底向上的计算方法\"></a><strong>三角形计算方案：自底向上的计算方法</strong></h3><p>以下面在由 8 个控制点 $00, 01, …, 07$定义的 7 次贝塞尔曲线为例。给定一个在 $[0,1]$ 中的 $u$，我们如何计算这个贝塞尔曲线上对应的点呢？曲线上的点是由选定点形成的等边三角形的底边对面的顶点！</p>\n<p><img src=\"de-cast-observation-crop.jpg\" alt=\"img\"></p>\n<p>例如，如果选定的控制点点是 02, 03, 04 和 05，那么对应于 $u$ 的这四个控制点定义的曲线上的点是 32。即蓝色的三角形的顶点。如果选定的控制点是 11, 12 和 13，则曲线上的点是 31。即黄色的三角形的顶点。如果选定的点是 30, 31, 32, 33 和 34，曲线上的点是 70。</p>\n<p>反之同理，70 是由控制点 60 和 61 定义的贝塞尔曲线上的点。它也可以是由 50, 51 和 52 控制点定义的曲线上的点，也可以是由 40, 41, 42 和 43 控制点定义的曲线上的点。</p>\n<p>如此我们就可以自底向上的计算每一项$P_{i,j}$，以蓝色三角形为例，先计算最左列的$P_{0,2},P_{0,3},P_{0,4},P_{0,5}$，再计算第二列的$P_{1,2},P_{1,3},P_{1,4},P_{0,5}$，再计算第三列的$P_{2,2},P_{2,3}$，再计算最终点$P_{3,2}$，这样可以避免自定向下计算带来的重复项计算的问题。</p>\n<h2 id=\"贝塞尔曲线的导数\"><a href=\"#贝塞尔曲线的导数\" class=\"headerlink\" title=\"贝塞尔曲线的导数\"></a>贝塞尔曲线的导数</h2><h3 id=\"贝塞尔曲线的导数仍然是贝塞尔曲线\"><a href=\"#贝塞尔曲线的导数仍然是贝塞尔曲线\" class=\"headerlink\" title=\"贝塞尔曲线的导数仍然是贝塞尔曲线\"></a><strong>贝塞尔曲线的导数仍然是贝塞尔曲线</strong></h3><p>要在贝塞尔曲线上的某点计算切向量和法向量，首先要计算在该点的一阶和二阶导数。</p>\n<p>由 $n + 1$ 个控制点 $P_0, P_1, …, P_n$ 定义的贝塞尔曲线如下：</p>\n<p>$$\\mathbf{C}(u)&#x3D;\\sum_{i&#x3D;0}^nB_{n,i}(u)\\mathbf{P}_i$$</p>\n<p>其中 $B_{n,i}(u)$ 定义如下：</p>\n<p>$$B_{n,i}(u)&#x3D;\\frac{n!}{i!(n-i)!}u^{i}(1-u)^{n-i}$$</p>\n<p>其中控制点$P_{i}$是常数且与变量 $u$ 相互独立，因此，计算贝塞尔曲线的导数 $C’(u)$可以简化为计算 $B_{n,i}(u)$ 的导数。</p>\n<p>通过一些代数操作，我们可以得到：</p>\n<p>$$\\frac{\\mathrm{d}}{\\mathrm{d}u}B_{n,i}(u)&#x3D;B_{n,i}^{\\prime}(u)&#x3D;n(B_{n-1,i-1}(u)-B_{n-1,i}(u))$$</p>\n<p>因此曲线的导数 $C’(u)$为：</p>\n<p>$$\\frac{\\mathrm{d}}{\\mathrm{d}u}\\mathbf{C}(u)&#x3D;\\mathbf{C}’(u)&#x3D;\\sum_{i&#x3D;0}^{n-1}B_{n-1,i}(u){n(\\mathbf{P}_{i+1}-\\mathbf{P}_i)}$$</p>\n<p>设 :</p>\n<p>$$Q_0 &#x3D; n(P_1 - P_0)$$<br>$$Q_1 &#x3D; n(P_2 - P_1)$$<br>$$Q_2 &#x3D; n(P_3-P_2)$$<br>$$Q_{n-1} &#x3D; n(P_n - P_{n-1})$$</p>\n<p>上述方程简化为以下形式：</p>\n<p>$$\\mathbf{C}^{\\prime}(u)&#x3D;\\sum_{i&#x3D;0}^{n-1}B_{n-1,i}(u)\\mathbf{Q}_{i}$$</p>\n<p><strong>结论：可以看出贝塞尔曲线 的导数$C’(u)$是由 $n$ 个控制点 $n(P_1 - P_0)$, $n(P_2 - P_1)$, $n(P_3 - P_2)$, …, $n(P_n - P_{n-1})$ 定义的 $n - 1$ 次贝塞尔曲线。</strong></p>\n<p>这个导数曲线通常被称为原贝塞尔曲线的<strong>轨迹图</strong>。</p>\n<p>注意，$P_{i+1} - P_i$ 是从 $P_i$ 到 $P_{i+1}$ 的方向向量，而 $n (P_{i+1} - P_i)$ 是该方向向量的 $n$ 倍长。下面左图显示了一个7次贝塞尔曲线，右图显示了其导数，是一个6次贝塞尔曲线。</p>\n<p><img src=\"b-curve-3.jpg\" alt=\"img\">  <img src=\"b-hodo-3.jpg\" alt=\"img\"></p>\n<h3 id=\"贝塞尔曲线与其第一条和最后一条边相切\"><a href=\"#贝塞尔曲线与其第一条和最后一条边相切\" class=\"headerlink\" title=\"贝塞尔曲线与其第一条和最后一条边相切\"></a><strong>贝塞尔曲线与其第一条和最后一条边相切</strong></h3><p>令$u &#x3D; 0$和$u &#x3D; 1$，可以得到：</p>\n<p>​                    $$C’(0) &#x3D; n(P_1 - P_0)$$         $$C’(1) &#x3D; n(P_n - P_{n-1})$$</p>\n<p>第一个公式意味着在$u &#x3D; 0$时的切向量方向是$P_1 - P_0$乘以$n$。因此，指示方向的第一条边与贝塞尔曲线相切。<br>第二个公式意味着在$u &#x3D; 1$时的切向量方向是$P_n - P_{n-1}$乘以$n$。因此，指示方向的最后一条边与贝塞尔曲线相切。下图很好地展示了这个属性。</p>\n<p><img src=\"b-curve-1-17098603594523.jpg\" alt=\"img\">  <img src=\"b-curve-4.jpg\" alt=\"img\"></p>\n<h3 id=\"用-C-1-连续性连接两个贝塞尔曲线\"><a href=\"#用-C-1-连续性连接两个贝塞尔曲线\" class=\"headerlink\" title=\"用$C^1$连续性连接两个贝塞尔曲线\"></a><strong>用$C^1$连续性连接两个贝塞尔曲线</strong></h3><p>利用贝塞尔曲线与其第一条和最后一条边相切的这个特性，可以将两条或更多的贝塞尔曲线连接起来，组合成我们想要的形状。</p>\n<p>设第一条曲线$C(u)$由$m + 1$个控制点$P_0, P_1, P_2, …, P_m$定义，<br>设第二条曲线$D(u)$由$n + 1$个控制点$Q_0, Q_1, Q_2, …, Q_n$定义，<br>如果我们想要将这两条贝塞尔曲线连接起来，那么$P_m$必须等于$Q_0$，这保证了$C^0$级连续</p>\n<p>第一条曲线与其最后一条边相切，第二条曲线与其第一条边相切。因此，为了实现平滑过渡，$P_{m-1}$，$P_m &#x3D; Q_0$和$Q_1$四个点必须在同一直线上，使得从$P_{m-1}$到$P_m$的方向与从$Q_0$到$Q_1$的方向相同，如下图所示：</p>\n<p><img src=\"join-rel.jpg\" alt=\"img\"></p>\n<p>以这种方式连接两个贝塞尔曲线看起来很平滑，但它仍然是$C^0$连续，而不是$C^1$连续。但是，它满足$G^1$连续（具有相同的切向量方向，但切向量大小不相等）。<br>为了保证$C^1$连续性，我们必须确保第一条曲线在$u &#x3D; 1$处的切向量$C’(1)$，与第二条曲线在$u &#x3D; 0$处的切向量$D’(0)$，是等的。也就是说，必须满足以下关系：</p>\n<p>$$\\mathbf{C}^{\\prime}(1)&#x3D;m(\\mathbf{P}<em>m-\\mathbf{P}</em>{m-1})&#x3D;\\mathbf{D}^{\\prime}(0)&#x3D;n(\\mathbf{Q}_1-\\mathbf{Q}_0)$$</p>\n<p>这个关系说明要在连接点保证$C^1$连续性，第一条曲线的最后一条边的长度（即$|p_m - p_{m-1}|$）与第二条曲线的第一条边的长度（即$|q_1 - q_0|$）的比例必须是$n&#x2F;m$。由于度数$m$和$n$是固定的，我们可以调整$p_{m-1}$或$q_1$在同一直线上的位置，使得上述关系得到满足。</p>\n<p><img src=\"b-join-1.jpg\" alt=\"img\"> <img src=\"b-join-2.jpg\" alt=\"img\"></p>\n<p>上面左图中为两条贝塞尔曲线连接而成，其中<strong>浅色的折线</strong>定义了一条4次贝塞尔曲线，而<strong>深色的折线</strong>定义了一条5次贝塞尔曲线。<br>由于第一条曲线的最后一段和第二条曲线的第一段不在同一直线上，所以这两条曲线并未平滑相接。<br>上面右图展示了在连接点处与一条直线相切的两条贝塞尔曲线。然而，它们并不是$C^1$连续的。左边的曲线是4次的，而右边的曲线是7次的。<br>但是，左曲线的最后一段与第二条曲线的第一段的比例看起来接近1，它们是$G^1$连续的而不是$C^1$连续的。为了实现$C^1$连续性，我们应该增加左曲线的最后段的长度（或者减少右曲线的第一段的长度），使其比例接近$7&#x2F;4&#x3D;1.75$，从而满足$C^1$连续</p>\n<h3 id=\"构造闭合的贝塞尔曲线\"><a href=\"#构造闭合的贝塞尔曲线\" class=\"headerlink\" title=\"构造闭合的贝塞尔曲线\"></a>构造闭合的贝塞尔曲线</h3><p>利用上面的这种切线性质，如果让第一个和最后一个控制点相同（即$P_0 &#x3D; P_n$）并且$P_1, P_0$和$P_{n-1}$共线，那么生成的贝塞尔曲线将是一个封闭曲线，并且在连接点处是$G^1$连续的。</p>\n<p>如果要在$P_0$处达到$C^1$连续性，必须使 $P_1-P_0&#x3D;P_n-P_{n-1}$（即曲线的第一段和最后一段有相同的长度并且$P_1, P_0 &#x3D; P_n, P_{n-1}$共线）</p>\n<p><img src=\"b-close-1.jpg\" alt=\"img\"></p>\n<h3 id=\"导数与de-Casteljau算法之间的关系\"><a href=\"#导数与de-Casteljau算法之间的关系\" class=\"headerlink\" title=\"导数与de Casteljau算法之间的关系\"></a><strong>导数与de Casteljau算法之间的关系</strong></h3><p>重新改写一下贝塞尔曲线的导数形式：</p>\n<p>$$\\begin{aligned}<br>\\mathrm{C}^{\\prime}(u)&amp;&#x3D;\\sum_{i&#x3D;0}^{n-1}B_{n-1,i}(u){n(\\mathbf{P}<em>{i+1}-\\mathbf{P}<em>i)}  \\<br>&amp;&#x3D;n\\left[\\left(\\sum</em>{i&#x3D;0}^{n-1}B</em>{n,i}(u)\\mathbf{P}<em>{i+1}\\right)-\\left(\\sum</em>{i&#x3D;0}^{n-1}B_{n,i}(u)\\mathbf{P}_{i}\\right)\\right]<br>\\end{aligned}$$</p>\n<p>贝塞尔曲线的导数可以看作是两条$n-1$次贝塞尔曲线的差<br>现在让这两条曲线分别为$C_1(u)$和$C_2(u)$：</p>\n<p>$$\\quad{C}<em>1(u)&#x3D;\\sum\\limits</em>{i&#x3D;0}^{n-1}B_{n,i}(u)\\mathbf{P}<em>{i+1}\\newline{C}<em>2(u)&#x3D;\\sum\\limits</em>{i&#x3D;0}^{n-1}B</em>{n,i}(u)\\mathbf{P}_i$$</p>\n<p>根据上面定义，可以知道第一条曲线$C_1(u)$由控制点$P_1, P_2, …, P_n$定义，第二条曲线$C_2(u)$由控制点$P_0, P_1, …, P_{n-1}$定义，因此，原曲线的导数定义为：</p>\n<p>$$\\mathbf{C}^{\\prime}(u)&#x3D;n(\\mathbf{C}_1(u)-\\mathbf{C}_2(u))$$</p>\n<p>为了计算贝塞尔曲线的导数$C’(u)$，可以先使用de Casteljau算法计算$C_1(u)$和$C_2(u)$的值，然后，再计算它们的差，乘以n就得到了$C’(u)$。</p>\n<p><strong>计算$C_1(u)$和$C_2(u)$：</strong></p>\n<p>如下图，最左侧的列有所有给定的控制点，点$n0$代表原始贝塞尔曲线上的点$C(u)$，点$(n-1)0$和$(n-1)1$连成的线段是用来插值获取点$n0$的控制折线，即点$n0$位于$(n-1)0$和$(n-1)1$的线段上，并以$u:1-u$的比例将其分割。</p>\n<p><img src=\"b-tangent.jpg\" alt=\"img\"></p>\n<p>由于曲线$C_1(u)$由控制点$01, 02, …, 0n$定义，因此点$(n-1)1$是曲线$C_1(u)$上的点。同样地，由于$C_2(u)$由控制点$00, 01, …, 0(n-1)$定义，因此点$(n-1)0$是曲线$C_2(u)$上的点，向量$C_1(u) - C_2(u)$表示从点 $(n-1)0$ 到点 $(n-1)1$ 的向量，而原贝塞尔曲线的导数$C’(u)$的是$n$倍的$C_1(u) - C_2(u)$。</p>\n<p>这说明，从 $(n-1)0$ 到 $(n-1)1$ 的线段与$C(u)$处的切线向量方向相同，它在$C(u)$处与曲线相切！</p>\n<p><strong>结论：de Casteljau算法迭代中的最后一条折线，实际上是一条线段，在$C(u)$处与贝塞尔曲线相切。</strong></p>\n<p>下图是一个例子，所示的点为$u &#x3D; 0.5$处。显然，de Casteljau迭代过程中的最后一条折线段在$C(0.5)$处与曲线相切。</p>\n<p><img src=\"b-tangent-curve.jpg\" alt=\"img\"></p>\n<h3 id=\"计算贝塞尔的高阶导数\"><a href=\"#计算贝塞尔的高阶导数\" class=\"headerlink\" title=\"计算贝塞尔的高阶导数\"></a><strong>计算贝塞尔的高阶导数</strong></h3><p>$C(u)$的一阶导数如下：</p>\n<p>$$\\mathbf{C}^{\\prime}(u)&#x3D;\\sum_{i&#x3D;0}^{n-1}B_{n-1,i}(u)\\mathbf{Q}_i$$</p>\n<p>将导数公式应用于上述贝塞尔曲线，得到以下结果，给出了原始贝塞尔曲线的二阶导数：</p>\n<p>$$\\begin{aligned}<br>\\mathbf{C}^{\\prime\\prime}&amp;&#x3D;\\sum_{i&#x3D;0}^{n-2}B_{n-2,i}(u){(n-1)(\\mathbf{Q}<em>{i+1}-\\mathbf{Q}<em>i)}\\<br>&amp;&#x3D;\\sum</em>{i&#x3D;0}^{n-2}B</em>{n-2,i}(u){n(n-1)(\\mathbf{P}<em>{i+2}-2\\mathbf{P}</em>{i+1}+\\mathbf{P}_i)}<br>\\end{aligned}$$</p>\n<p>为了简洁地表达高阶导数，可以使用有限差分的方式。定义$D_{i}^0$为控制点$P_i$本身，其中$0 \\leq i \\leq n$。定义第一层差分$D_{i}^1$为前一层的差分，如下：</p>\n<p>$$\\begin{aligned}<br>\\mathbf{D}_{0}^{1}&amp;&#x3D;\\text{ D}_1^0-\\mathbf{D}<em>0^0&#x3D;\\mathbf{P}<em>1-\\mathbf{P}<em>0  \\<br>\\mathrm{D}</em>{1}^{1}&amp;&#x3D;\\text{ D}<em>2^0-\\mathbf{D}<em>1^0&#x3D;\\mathbf{P}<em>2-\\mathbf{P}<em>1  \\<br>&amp;\\vdots \\<br>\\mathbf{D}</em>{n-2}^{1}&amp;&#x3D;\\text{ D}</em>{n-1}^0-\\mathbf{D}</em>{n-2}^0&#x3D;\\mathbf{P}</em>{n-1}-\\mathbf{P}</em>{n-2}  \\<br>\\mathbf{D}</em>{n-1}^{1}&amp;&#x3D;\\text{ D}<em>n^0-\\mathbf{D}</em>{n-1}^0&#x3D;\\mathbf{P}<em>n-\\mathbf{P}</em>{n-1}<br>\\end{aligned}$$</p>\n<p>第一层差分只有$n$个点，比给定的控制点少一个，简写一下，第一层的差分如下所示：</p>\n<p>$$\\mathbf{D}<em>i^1&#x3D;\\mathbf{D}</em>{i+1}^0-\\mathbf{D}_i^0\\quad0\\leq i\\leq n-1$$</p>\n<p>第二层差分被定义为第一层点的差分：</p>\n<p>$$\\mathbf{D}<em>i^2&#x3D;\\mathbf{D}</em>{i+1}^1-\\mathbf{D}_i^1\\quad0\\le i\\le n-2$$</p>\n<p>这个第二层差分有$n-1$个点。重复这个过程，我们可以定义第$k$层差分如下。第$k$层差分有$n-k+1$个点。</p>\n<p>$$\\mathrm D_i^k&#x3D;\\mathrm D_{i+1}^{k-1}-\\mathrm D_i^{k-1}\\quad0\\leq i\\leq n-k$$</p>\n<p>有了这些定义，可以简洁地表达更高阶的导数。首先，让我们使用$D_{i}^1$重新写下$C’(u)$：</p>\n<p>$$\\begin{aligned}<br>\\mathbf{C}^{\\prime}(u)&amp;&#x3D;n\\sum_{i&#x3D;0}^{n-1}B_{n-1,i}(u)(\\mathbf{P}<em>{i+1}-\\mathbf{P}</em>{i})  \\<br>&amp;&#x3D;n\\sum_{i&#x3D;0}^{n-1}B_{n-1,i}(u)(\\mathbf{D}<em>{i+1}^0-\\mathbf{D}<em>i^0) \\<br>&amp;&#x3D;n\\sum</em>{i&#x3D;0}^{n-1}B</em>{n-1,i}(u)\\mathbf{D}_i^1<br>\\end{aligned}$$</p>\n<p>将导数应用于$C’(u)$来计算$C’’(u)$，得到了一个使用$D_{i}^2$表示$C’’(u)$的公式：</p>\n<p>$$\\begin{aligned}<br>\\mathbf{C}’’(u)&amp;&#x3D;n(n-1)\\sum_{i&#x3D;0}^{n-2}B_{n-2,i}(u)(\\mathbf{D}<em>{i+1}^1-\\mathbf{D}<em>i^1)\\<br>&amp;&#x3D;n(n-1)\\sum</em>{i&#x3D;0}^{n-2}B</em>{n-2,i}(u)\\mathbf{D}_i^2<br>\\end{aligned}$$</p>\n<p>对$C’’(u)$做同样的处理，我们得到了一个使用$D_{i}^3$表示$C’’’(u)$的公式：</p>\n<p>$$\\begin{aligned}<br>\\mathbf{C}^{\\prime\\prime\\prime}(u)&amp;&#x3D;n(n-1)(n-2)\\sum_{i&#x3D;0}^{n-3}B_{n-3,i}(u)(\\mathbf{D}<em>{i+1}^2-\\mathbf{D}<em>i^2)\\<br>&amp;&#x3D;n(n-1)(n-2)\\sum</em>{i&#x3D;0}^{n-3}B</em>{n-3,i}(u)\\mathbf{D}_i^3<br>\\end{aligned}$$</p>\n<p>继续这个过程，我们可以计算出第$k$阶导数$C^{(k)}(u)$使用$D_{i}^k$的表示形式：</p>\n<p>$$\\begin{aligned}<br>\\mathbf{C}^{[k]}(u)&amp;&#x3D;n(n-1)(n-2)\\cdots(n-k+1)\\sum_{i&#x3D;0}^{n-k}B_{n-k,i}(u)(\\mathbf{D}<em>{i+1}^{k-1}-\\mathbf{D}</em>{i}^{k-1})\\<br>&amp;&#x3D;n(n-1)(n-2)\\cdots(n-k+1)\\sum_{i&#x3D;0}^{n-k}B_{n-k,i}(u)\\mathbf{D}_{i}^{k}<br>\\end{aligned}$$</p>\n<p>因此，要在特定的$u$处计算$C(u)$的第$k$阶导数，我们首先计算$D_{i}^k$的值，然后应用de Casteljau算法计算由$D_{i}^k$定义的贝塞尔曲线上对应于$u$的点。</p>\n<p>如下图所示，我们已有第0列所有$D_{i}^0$的值（即控制点本身），然后使用两两差分来计算第1列的$D_{i}^1$的值。重复这个过程直到我们达到如下所示的第$k$列：</p>\n<p><img src=\"b-high-der-diagram.jpg\" alt=\"img\"></p>\n<p>最后，使用de Casteljau算法计算出第$k$列点的$B_{n-k,i}(u)$的值，与$D_{i}^k$相乘后累加，再将结果乘以$n(n-1)(n-2)…(n-k+1)$，就得到了$C^{(k)}(u)$的值！</p>\n<h2 id=\"贝塞尔曲线的拆分\"><a href=\"#贝塞尔曲线的拆分\" class=\"headerlink\" title=\"贝塞尔曲线的拆分\"></a>贝塞尔曲线的拆分</h2><p><strong>曲线拆分</strong>的过程是将一个贝塞尔曲线在特定点$C(u)$处一分为二，每一部分仍然是贝塞尔曲线。分割后的每段曲线都需要一套新的控制点来描述其形状，原有的控制点将不再适用。此外，由于原始贝塞尔曲线的阶次是$n$，被切割成两部分后，每个部分都是原贝塞尔曲线的子集，因此得到的新贝塞尔曲线的阶次也必须是$n$。</p>\n<p>假设我们$n + 1$个控制点$P_0, P_1, P_2, …, P_n$，参数 $0\\leq u\\leq1$，目标是找到两组新的$n+1$个控制点$Q_0, Q_1, Q_2, …, Q_n$和$R_0, R_1, R_2, …, R_n$。</p>\n<p>这两组控制点各自定义的贝塞尔曲线分别对应原始曲线在$[0,u]$和$[u,1]$区间的部分。</p>\n<p>虽然正确性证明有点繁琐，但实际上算法非常简单。事实上，de Casteljau 的算法用于计算曲线上点 $C(u)$ 时已经提供了所有必要的信息。在下面的左图中，展示了用 de Casteljau 算法计算 $C(u)$ 的所有中间步骤，右图显示了在点 $C(u)$ 处曲线拆分后的形状及相应的控制折线。</p>\n<p><img src=\"b-sub-master.jpg\" alt=\"img\"> <img src=\"b-sub-result.jpg\" alt=\"img\"></p>\n<p>仔细比较这两幅图，左图中，<strong>左半段</strong>贝塞尔曲线的控制点由$P_{00}&#x3D;P_0, P_{10},P_{20},P_{30},P_{40},P_{50}$和$P_{60} &#x3D; C(u)$组成<br><strong>右半段</strong>贝塞尔曲线的控制点由点$P_{60}&#x3D;C(u),P_{51},P_{42},P_{33},P_{24},P_{15}$和$P_{06} &#x3D; P_6$组成。<br>下图展示了这些点：</p>\n<p><img src=\"b-sub-left.jpg\" alt=\"img\"><img src=\"b-sub-right.jpg\" alt=\"img\"></p>\n<p>回想一下de Casteljau算法的三角形计算方案：对于给定的$u$，计算$C(u)$需要$n$次迭代，在计算过程中，可以收集每列的第一个点和最后一个点，并且最终，第一个点（或最后一个点）的集合对应于原始曲线在$[0,u]$（或$[u,1]$）上定义的片段。</p>\n<p>因此，在下面的三角形方案中，箭头指向的顶边(红色：$00,10,20,30,40,50,60$)和箭头相反方向的底边(蓝色：$60,51,42,33,24,15,06$)分别对应位第一段曲线和第二段曲线段的控制点。有了控制点，也就可以得出拆分后的两段贝塞尔曲线（可以重新计算获得）</p>\n<p><img src=\"b-sub-chart.jpg\" alt=\"img\"></p>\n<p>注意：点$50$和$51$定义的线段在点$60$处与曲线相切（见上图），即左曲线的最后一段（即线段$50-60$）与左曲线相切，右曲线的第一段（即线段$60-51$）与右曲线相切。</p>\n<p><strong>曲线拆分为何至关重要？</strong><br>曲线拆分的应用范围广泛。例如，它可以被用来找出两个贝塞尔曲线的交汇点、对贝塞尔曲线进行渲染，以及简化曲线设计过程。设想我们设计了一条曲线，却发现它并不完全符合我们的预期。在这种情形下，我们可能会考虑在某些特定的点上将曲线分割为两个部分：一个部分达到了我们的满意度，而另一部分则没有。接下来，我们可以忽略掉那部分我们已经满意的，将注意力集中在仍需改进的部分上。</p>\n<h2 id=\"贝塞尔曲线的升阶\"><a href=\"#贝塞尔曲线的升阶\" class=\"headerlink\" title=\"贝塞尔曲线的升阶\"></a>贝塞尔曲线的升阶</h2><p>不改变贝塞尔曲线的形状，同时增加贝塞尔曲线的度数（即阶数&#x2F;次数），称为<strong>贝塞尔曲线的升阶</strong>。</p>\n<p>假设我们有一个由 $n+1$个控制点$P_0, P_1, P_2, …, P_n$定义的$n$阶贝塞尔曲线，我们希望将这个曲线的度数提升到$n + 1$而不改变其形状。由于$n + 1$阶贝塞尔曲线需要由$n + 2$个控制点定义，因此，我们需要找到一个新的控制点集，显然，$P_0$ 和 $P_n$ 必须在新控制点集中，因为贝塞尔曲线会通过首尾控制点，曲线升阶不改变曲线的形状。因此，我们需要$n$个新的控制点，假设新的控制点集为 $Q_0, Q_1, Q_2, …, Q_{n+1}$，根据上述要求有，$Q_0 &#x3D; P_0$ 和 $Q_{n+1} &#x3D; P_n$。其他控制点的计算方式如下：</p>\n<p>$$\\mathbf{Q}<em>i&#x3D;\\frac{i}{n+1}\\mathbf{P}</em>{i-1}+\\left(1-\\frac{i}{n+1}\\right)\\mathbf{P}_i\\quad1\\le i\\le n$$</p>\n<p>以下是从$Q_1$到$Q_n$每个控制点的公式：</p>\n<p>$$\\begin{aligned}<br>\\mathbf{Q}_1&amp;&#x3D;\\frac{1}{n+1}\\mathbf{P}_0+\\left(1-\\frac{1}{n+1}\\right)\\mathbf{P}_1\\<br>\\mathbf{Q}_2&amp;&#x3D;\\frac{2}{n+1}\\mathbf{P}_1+\\left(1-\\frac{2}{n+1}\\right)\\mathbf{P}_2\\<br>\\mathbf{Q}<em>3&amp;&#x3D;\\frac{3}{n+1}\\mathbf{P}<em>2+\\left(1-\\frac{3}{n+1}\\right)\\mathbf{P}<em>3\\<br>&amp;\\vdots\\<br>\\mathbf{Q}</em>{n-1}&amp;&#x3D;\\frac{n-1}{n+1}\\mathbf{P}</em>{n-2}+\\left(1-\\frac{n-1}{n+1}\\right)\\mathbf{P}</em>{n-1}\\<br>\\mathbf{Q}<em>n&amp;&#x3D;\\frac{n}{n+1}\\mathbf{P}</em>{n-1}+\\left(1-\\frac{n}{n+1}\\right)\\mathbf{P}_n<br>\\end{aligned}$$</p>\n<p>原始多段线的每一段上正好会有一个新的控制点。即：线段$P_{i-1}P_i$ 包含新控制点$Q_i$。</p>\n<p>在de Casteljau算法中，线段$AB$上一点$C$，将$AB$按比例 $u:1-u$ 分割，可以写作 $C &#x3D; (1 - u)A + uB$。在上式中，$Q_i$将线段$P_{i-1}P_i$  按比例 $1-\\frac{i}{n+1}:\\frac{i}{n+1}$ 分割。这个比例不是一个常数，而是随着 i 的值变化的，但与de Casteljau算法很相似</p>\n<p>获得了新的控制点集后，原控制点集就可以弃用。由于原始控制多段线的每一段都包含一个新控制点，用新控制点集合替换旧控制点集合的过程可以看作是在原始控制点处切掉角。</p>\n<p>见下图，图中显示了一个4度贝塞尔曲线，控制点以红色矩形显示，控制多段线以虚线显示。将其度数增加到5后，新的控制多段线以实线段显示。显然，所有角都被切掉了。下表给出了原始控制多段线上每一段的比例。</p>\n<table>\n<thead>\n<tr>\n<th>i</th>\n<th>1 - i&#x2F;(n+1)</th>\n<th>i&#x2F;(n+1)</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>1</td>\n<td>0.8</td>\n<td>0.2</td>\n</tr>\n<tr>\n<td>2</td>\n<td>0.6</td>\n<td>0.4</td>\n</tr>\n<tr>\n<td>3</td>\n<td>0.4</td>\n<td>0.6</td>\n</tr>\n<tr>\n<td>4</td>\n<td>0.2</td>\n<td>0.8</td>\n</tr>\n</tbody></table>\n<p><img src=\"bezier-cut-corner.jpg\" alt=\"img\"></p>\n<p>随着曲线度数的增加，控制点的数量也会增加。并且，新的控制多边形会逐渐向曲线靠拢。在下面的图形中，我们从一个度数为6、控制点为7个的贝塞尔曲线开始，然后，其度数增加到7、8、10、15和29。从图中可以看出，随着度数的增加，曲线的形状没有改变，控制多边形越来越接近曲线。最终，随着度数不断增加到无限，控制多边形将趋向于曲线，曲线则相当于控制多边形的一个极限位置。</p>\n<p><img src=\"b-elev-06.jpg\" alt=\"img\"><img src=\"b-elev-07.jpg\" alt=\"img\"><img src=\"b-elev-08.jpg\" alt=\"img\"><img src=\"b-elev-10.jpg\" alt=\"img\"><img src=\"b-elev-15.jpg\" alt=\"img\"><img src=\"b-elev-29.jpg\" alt=\"img\"></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>总的来说，要定义一个$n$阶的贝塞尔曲线，我们需要在空间中选择$n+1$个控制点，这些点大致描述了所需曲线的形状。</p>\n<p>然后，如果它不符合我们的期望，我们可以移动控制点。随着一个或多个控制点的移动，贝塞尔曲线的形状相应地发生变化。但是，曲线始终位于由控制点定义的凸包内（<strong>凸包性质</strong>），并且生成的曲线形状比控制多边形简单（<strong>变差减少性质</strong>）。</p>\n<p>除此之外，贝塞尔曲线还具有<strong>非负性</strong>、<strong>单位分割</strong>、<strong>仿射不变性</strong>、<strong>递归性</strong>等性质。贝塞尔曲线不具备<strong>局部修改性</strong>，移动控制点将会全面改变贝塞尔曲线的形状，这也是其逐渐被<strong>样条曲线</strong>和<strong>Nurbs曲线</strong>取代的原因。</p>\n<p>详细介绍了<strong>De Casteljau算法</strong>，用于计算任意参数位置时，对应的贝塞尔曲线上一点，这是一种<strong>自底向上</strong>的<strong>三角形计算方案</strong>，能够避免<strong>自顶向下</strong>计算方案递归调用时带来的不必要的性能开销。</p>\n<p>还介绍了<strong>贝塞尔曲线导数</strong>的性质，如何将两个<strong>贝塞尔曲线连接</strong><em>在一起并保证连接点处$C^1$连续，如何构造<strong>闭合的贝塞尔曲线</strong>以及计算*<em>高阶贝塞尔导数</em></em>。</p>\n<p>最后还介绍了贝塞尔曲线的<strong>拆分</strong>和<strong>升阶</strong>方法，这个早期在工程中也是具有很大的应用。</p>\n<h2 id=\"文献引用\"><a href=\"#文献引用\" class=\"headerlink\" title=\"文献引用\"></a>文献引用</h2><ul>\n<li>Gerald Farin, <em>Curves and Surfaces for CAGD: A Practical Guide</em>, fourth edition, Academic Press, 1997.</li>\n<li>Josef Hoschek and Dieter Lasser, <em>Fundamentals of Computer Aided Geometric Design</em>, translated from the German 1989 edition by Larry L. Schumaker, A K Peters, 1993.</li>\n<li>Les Piegl and Wayne Tiller, <em>The NURBS Book</em>, second edition, Springer-Verlag, 1997.</li>\n<li>David F. Rogers and J. Alan Adams, <em>Mathematical Elements for Computer Graphics</em>, second edition, McGraw-Hill, 1990.</li>\n</ul>\n<hr>\n<p>后续，将会继续介绍<strong>B样条曲线</strong>和<strong>Nurbs曲线</strong>，这两种类型的曲线会逐渐取代贝塞尔成为工程中的主流曲线定义方式。<strong>To be continued….</strong></p>\n"}],"PostAsset":[{"_id":"source/_posts/贝塞尔曲线/b-close-1.jpg","slug":"b-close-1.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-curve-1-17098603594523.jpg","slug":"b-curve-1-17098603594523.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-curve-1-17103234093711.jpg","slug":"b-curve-1-17103234093711.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-curve-1-17103242022572.jpg","slug":"b-curve-1-17103242022572.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-curve-2-17091716014474-17103791115213.jpg","slug":"b-curve-2-17091716014474-17103791115213.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-curve-3.jpg","slug":"b-curve-3.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-curve-4.jpg","slug":"b-curve-4.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-elev-06.jpg","slug":"b-elev-06.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-elev-07.jpg","slug":"b-elev-07.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-elev-08.jpg","slug":"b-elev-08.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-elev-10.jpg","slug":"b-elev-10.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-elev-15.jpg","slug":"b-elev-15.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-elev-29.jpg","slug":"b-elev-29.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-high-der-diagram.jpg","slug":"b-high-der-diagram.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-hodo-3.jpg","slug":"b-hodo-3.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-join-1.jpg","slug":"b-join-1.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-join-2.jpg","slug":"b-join-2.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-pou-1-17091716014476.jpg","slug":"b-pou-1-17091716014476.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-sub-chart.jpg","slug":"b-sub-chart.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-sub-left.jpg","slug":"b-sub-left.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-sub-master.jpg","slug":"b-sub-master.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-sub-result.jpg","slug":"b-sub-result.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-sub-right.jpg","slug":"b-sub-right.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-tangent-curve.jpg","slug":"b-tangent-curve.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-tangent.jpg","slug":"b-tangent.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/b-variation-17103792438184.jpg","slug":"b-variation-17103792438184.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/bezier-cut-corner.jpg","slug":"bezier-cut-corner.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/bezier-move-ct-pt-1.jpg","slug":"bezier-move-ct-pt-1.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/bezier-P+v.jpg","slug":"bezier-P+v.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/Bézier_2_big.gif","slug":"Bézier_2_big.gif","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/Bézier_3_big-168860760518218.gif","slug":"Bézier_3_big-168860760518218.gif","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/de-cast-compute.jpg","slug":"de-cast-compute.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/de-cast-observation-crop.jpg","slug":"de-cast-observation-crop.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/de-cast-rec-comp.jpg","slug":"de-cast-rec-comp.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/de-casteljau.jpg","slug":"de-casteljau.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/image-20230715134335693.png","slug":"image-20230715134335693.png","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/image-20230715134422584.png","slug":"image-20230715134422584.png","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/image-20230715134508818.png","slug":"image-20230715134508818.png","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/image-20230715134543049.png","slug":"image-20230715134543049.png","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/image-20230715134555599.png","slug":"image-20230715134555599.png","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/image-20230715135427376.png","slug":"image-20230715135427376.png","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/image-20230715142535462.png","slug":"image-20230715142535462.png","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/image-20230715142627416.png","slug":"image-20230715142627416.png","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/join-rel.jpg","slug":"join-rel.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/point-c.jpg","slug":"point-c.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0},{"_id":"source/_posts/贝塞尔曲线/v2-770487eacf3b9d5973e2783b6d8698e5_r.jpg","slug":"v2-770487eacf3b9d5973e2783b6d8698e5_r.jpg","post":"cmhud1bef0001b0mndclw5b68","modified":0,"renderable":0}],"PostCategory":[],"PostTag":[],"Tag":[]}}